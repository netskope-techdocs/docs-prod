<!DOCTYPE html>

<head>
    <title>Predefined Rules</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css" integrity="sha512-w+rY1+DOo63621/y/1p3520iQnQ2p9on1sJ9/aSKh1M79aa7/Fibd34MnJjLpuEgDxKg/vQLAP887SDXUhcVxg==" crossorigin="anonymous">
    <link rel="stylesheet" href="predefined_rules.css">
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js" integrity="sha512-RgOCmhg9TZLNsMn33HnOg2++rNE1KVKJNmRvm36/PgHQumnQ/TCEGn5IHDnZU7DhFE1X9vhOzsH4XDpN3hDhLg==" crossorigin="anonymous"></script>
    <script src="https://semantic-ui.com/javascript/library/tablesort.js" integrity="sha512-lVeO88bta+CM1eV2gVGyeaGlDlMkuyC4x2HIxsRfJ1AWhtC5jmO3tydE1+NrYM0CgeW4tSgrV53/dGDxIhDqIA==" crossorigin="anonymous"></script>
</head>

<body>
<div class="ui divided grid ngl_doc">
    
    <div class="six wide mobile six wide tablet five wide computer column four wide large screen three wide widescreen leftInfo">
        
        <div class="ntsp_logo">
            <img src="logo.svg" alt="Netskope" />
            
            <div class="ui fluid selection dropdown">
                <i class="dropdown icon"></i>
                <div class="default text">Select Friend</div>
                <div class="menu">
                    <div class="item" data-value="aws">
                        <img class="ui mini avatar image" src="azuread.png">
                        Azure AD
                    </div>
                </div>
            </div>
            
        </div>
        
        <div class="ui divider"></div>
        
        <div class="rules">
            
            <div class="left heading">Predefined Rules</div>
            
            <div class="ui accordion">
                <div class="title">
                    <i class="dropdown icon"></i>
                    <a tableName="azuread">Azure AD Predefined Rules</a>
                </div>
                <div class="content">

                        
                        
                        <div class="links">

                            <a tableName="AICPA-SOC-TSC-2017">AICPA-SOC-TSC-2017</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="CIS-MICROSOFT365-1-2-0">CIS-MICROSOFT365-1.2.0</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="CSA-CCM-4-0">CSA-CCM-4.0</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="GDPR-2016-679">GDPR-2016-679</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="HIPAA-1996">HIPAA-1996</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="ISO-27002-2013">ISO-27002-2013</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="NIST-800-53-4">NIST-800-53-4</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="NIST-CSF-1-1">NIST-CSF-1.1</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="Netskope-Cross-Application-Security-Checks">Netskope-Cross-Application-Security-Checks</a>
                        </div>
                        
                        <div class="links">

                            <a tableName="PCI-DSS-3-0">PCI-DSS-3.0</a>
                        </div>
                        
                        

                </div>
            </div>
        </div>
    </div>
    
    <div class="ten wide mobile ten wide tablet eleven wide computer column twelve wide large screen thirteen wide widescreen rightInfo">
        <h1 class="ut_margin_left_40 ut_margin_top_32 ut_margin_bottom_0 main title"></h1>
        <div class="ui divider"></div>
        <div class="ui search ut_margin_left_40 ut_margin_top_18">
            <div class="ui left icon input">
                <input class="prompt" type="text" placeholder="Search">
                <i class="search icon"></i>
            </div>
        </div>
        <table class="ui table sortable ntsp_table azuread">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure all disabled users in AzureAD are also inactive in Salesforce</td>
                <td>Ensure all user account disabled in AzureAD are also inactive in Salesforce.</td>
                <td>(Azure AD)user, (Salesforce)user</td>
                <td class="rule"><span>Not applicable</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile device management policies are required for email profiles</td>
                <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.managedemailprofilerequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that between two and four global admins are designated</td>
                <td>Ensure that between two and four global admins are designated.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have globaladminusercount &gt;= 2 and globaladminusercount &lt;=4 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        
        <table class="ui table sortable ntsp_table AICPA-SOC-TSC-2017">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile device management policies are required for email profiles</td>
                <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.managedemailprofilerequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table CIS-MICROSOFT365-1-2-0">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile device management policies are required for email profiles</td>
                <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.managedemailprofilerequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that between two and four global admins are designated</td>
                <td>Ensure that between two and four global admins are designated.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have globaladminusercount &gt;= 2 and globaladminusercount &lt;=4 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table CSA-CCM-4-0">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile device management policies are required for email profiles</td>
                <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.managedemailprofilerequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table GDPR-2016-679">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table HIPAA-1996">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table ISO-27002-2013">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table NIST-800-53-4">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table NIST-CSF-1-1">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device passwords never expire</td>
                <td>Ensure that user passwords on mobile devices never expire.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d4.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d5.passwordexpirationdays = -1
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordexpirationdays = -1
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table Netskope-Cross-Application-Security-Checks">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure all disabled users in AzureAD are also inactive in Salesforce</td>
                <td>Ensure all user account disabled in AzureAD are also inactive in Salesforce.</td>
                <td>(Azure AD)user, (Salesforce)user</td>
                <td class="rule"><span>Not applicable</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        <table class="ui table sortable ntsp_table PCI-DSS-3-0">
            <thead>
            <tr class="fixed header">
                <th>NAME</th>
                <th>DESCRIPTION</th>
                <th>RESOURCE TYPE</th>
                <th>RULE</th>
            </tr>
            </thead>
            <tbody>
            
            
            <tr class="top aligned">
                <td>Ensure the Azure AD &#39;Risky sign-ins&#39; report is reviewed at least weekly</td>
                <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
                <td>account</td>
                <td class="rule"><span>azuread account should-have unreviewedriskeventsexist = false 
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Enable Conditional Access policies to block legacy authentication</td>
                <td>Enable Conditional Access policies to block legacy authentication.</td>
                <td>conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccesspolicy should-have 
  conditions with-attribute {
    users with-attribute { 
        includeusers with-any-element [&#34;All&#34;] 
        and len(excludeusers) &gt;= 1 
    } 
    and clientapptypes with-any-element [&#34;exchangeActiveSync&#34;] 
    and clientapptypes with-any-element [&#34;other&#34;]
  }
  and grantcontrols with-attribute {
      len(builtincontrols) = 1
      and builtincontrols with-any-element [&#34;block&#34;]
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
  any conditionalaccesspolicy as c with-attribute {
      c.conditions with-attribute {
            c.users with-attribute {
                c.includeroles with-any-element [&#34;b0f54661-2d74-4c50-afa3-1ec803f12efe&#34;] and
                c.includeroles with-any-element [&#34;b1be1c3e-b65d-4f19-8427-f6fa0d97feb9&#34;] and
                c.includeroles with-any-element [&#34;29232cdf-9323-42fd-ade2-1d097af3e4de&#34;] and
                c.includeroles with-any-element [&#34;62e90394-69f5-4237-9190-012177145e10&#34;] and
                c.includeroles with-any-element [&#34;729827e3-9c14-49f7-bb1b-9608f156bbb8&#34;] and
                c.includeroles with-any-element [&#34;194ae4cb-b126-40b2-bd5b-6091b380977d&#34;] and
                c.includeroles with-any-element [&#34;f28a1f50-f6e7-4571-818b-6a12f2af6b6c&#34;] and
                c.includeroles with-any-element [&#34;fe930be7-5e62-47db-91af-98c3a49a38b1&#34;]
            } and
            c.clientapptypes with-any-element [&#34;all&#34;]
        } and
        c.grantcontrols with-attribute {
          c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and c.state = &#34;enabled&#34;
}
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
                <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
                <td>conditionalaccess, conditionalaccesspolicy</td>
                <td class="rule"><span>azuread conditionalaccess should-have
 any conditionalaccesspolicy as c with-attribute {
    c.conditions with-attribute {
      c.users with-attribute {
        c.includeusers with-any-element [&#34;All&#34;]
      } and
      c.clientapptypes with-any-element [&#34;all&#34;]
    } and
    c.grantcontrols with-attribute {
      c.builtincontrols with-any-element [&#34;mfa&#34;]
    } and
    c.state = &#34;enabled&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Mobile devices passwords should be at least 6 characters</td>
                <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d2.passwordminimumlength = 6
  } and
  any deviceconfiguration as d3 with-attribute {
      d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
      d3.passwordminimumlength = 6
  } and
  any deviceconfiguration as d4 with-attribute {
        d4.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
        d4.passwordminimumlength = 6
  } and
  any deviceconfiguration as d5 with-attribute {
          d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
          d5.passwordminimumlength = 6 and
          d5.passcodeblocksimple = true
  } and
  any deviceconfiguration as d6 with-attribute {
          d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
          d6.passwordminimumlength = 6 and
          d6.passcodeblocksimple = true
  } and
  any deviceconfiguration as d7 with-attribute {
          d7.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
          d7.passwordminimumlength = 6 and
          d7.passcodeblocksimple = true
  } and
  any deviceconfiguration as d8 with-attribute {
          d8.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
          d8.passwordminimumlength = 6
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
                <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d1.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d3.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d6.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d7.passwordrequiredtype = &#34;alphanumeric&#34;
  } and
  any deviceconfiguration as d8 with-attribute {
    d8.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d8.passwordrequiredtype = &#34;alphanumeric&#34;
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device encryption is enabled</td>
                <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.storagerequiredeviceencryption = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d2.storagerequiredeviceencryption = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
                <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
                <td>devicemanagement, devicecompliancepolicy</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any devicecompliancepolicy as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosCompliancePolicy&#34; and
    d1.securityblockjailbrokendevices = true
  } and
  any devicecompliancepolicy as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidCompliancePolicy&#34; and
    d2.securityblockjailbrokendevices = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Lock mobile devices after a period of inactivity</td>
                <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordminutesofinactivitybeforescreentimeout = 5 and
    d3.passwordrequirewhenresumefromidlestate = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordminutesofinactivitybeforescreentimeout = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d5.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d5.passcodeminutesofinactivitybeforelock = 0
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d6.passcodeminutesofinactivitybeforescreentimeout = 5 and
    d6.passcodeminutesofinactivitybeforelock = 0
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure device management polices are set to require advanced security configurations</td>
                <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have deviceconfiguration exists
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
                <td>Require your users to use a complex password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodeblocksimple = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d2.passcodeblocksimple = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices require the use of a password</td>
                <td>Require your users to use a password to unlock their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordrequired = true
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d2.passcoderequired = true
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordrequired = true
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordrequired = true
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that mobile device password reuse is prohibited</td>
                <td>Do not allow your users to reuse the same password on their mobile devices.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
 any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d1.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d3.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d4.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.macOSGeneralDeviceConfiguration&#34; and
    d5.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d6.passwordpreviouspasswordblockcount = 5
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d7.passwordpreviouspasswordblockcount = 5
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
                <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
                <td>devicemanagement, deviceconfiguration</td>
                <td class="rule"><span>azuread devicemanagement should-have
  any deviceconfiguration as d1 with-attribute {
    d1.odatatype = &#34;#microsoft.graph.iosGeneralDeviceConfiguration&#34; and
    d1.passcodesigninfailurecountbeforewipe &lt;= 10
  } and
  any deviceconfiguration as d2 with-attribute {
    d2.odatatype = &#34;#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration&#34; and
    d2.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d3 with-attribute {
    d3.odatatype = &#34;#microsoft.graph.windows10GeneralConfiguration&#34; and
    d3.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d4 with-attribute {
    d4.odatatype = &#34;#microsoft.graph.windows81GeneralConfiguration&#34; and
    d4.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d5 with-attribute {
    d5.odatatype = &#34;#microsoft.graph.androidGeneralDeviceConfiguration&#34; and
    d5.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d6 with-attribute {
    d6.odatatype = &#34;#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration&#34; and
    d6.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  } and
  any deviceconfiguration as d7 with-attribute {
    d7.odatatype = &#34;#microsoft.graph.aospDeviceOwnerDeviceConfiguration&#34; and
    d7.passwordsigninfailurecountbeforefactoryreset &lt;= 10
  }
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
                <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
                <td>oauth2permissiongrant</td>
                <td class="rule"><span>azuread oauth2permissiongrant should-not-have textmatch(scope, &#34;AppRoleAssignment.ReadWrite.All&#34;) = true
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            <tr class="top aligned">
                <td>Ensure that users do not have the default strong password policy disabled.</td>
                <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users&#39; password policies should require a strong password.</td>
                <td>user</td>
                <td class="rule"><span>azuread user should-not-have passwordpolicies = &#34;DisableStrongPassword&#34;
</span>
                    <div class="tooltip" data-tooltip="Click to copy" data-inverted="">
                        <i class="bordered large copy icon inverted"></i>
                    </div>
                </td>
            </tr>
            
            
            </tbody>
        </table>
        
        
    </div>
</div>


<script>
    function copyToClipboard(element) {
        var $temp = $("<input>");
        $("body").append($temp);
        $temp.val($(element).text()).select();
        document.execCommand("copy");
        $temp.remove();
    };
    function removeRow(searchText) {
        $("table.active tr").not(".fixed.header").each(
            function () {
                var tableRowText = $(this)[0].innerText.toLowerCase();
                console.log(tableRowText)
                console.log(searchText);
                if(tableRowText.indexOf(searchText) != -1){
                    $(this).css({"display": "table-row"});
                }
                else{
                    $(this).css({"display": "none"});
                }
            });
    };

    $(document).ready(function () {
        $(".sortable.table").tablesort();

        $("td.rule").hover(
            function () {
                $(this).find("div.tooltip").attr("data-tooltip", "Click to copy");
                $(this).find("div.tooltip").css({ "display": "inline-block" });
                $(this).addClass("current");
            },
            function () {
                $(this).find("div.tooltip").css({ "display": "none" });
                $(this).removeClass("current");
            });

        $("td.rule div.tooltip").click(
            function () {
                $(this).attr("data-tooltip", "Copied");
                copyToClipboard("td.rule.current span");
            }
        );

        $(".ntsp_logo .ui.dropdown")
            .dropdown("set selected", "aws");

        $(".ntsp_logo .ui.buttons .button")
            .click(
                function () {
                    $(".ntsp_logo .ui.buttons .button").removeClass("active");
                    $(this).addClass("active");
                }
            );

        $('.ui.accordion').accordion({
            exclusive: false,
            active: 1
        });

        $("a").click(
            function () {
                $("a").each(function () {
                    $(this).removeClass("active");
                });
                $(this).addClass("active");
                $(".ntsp_table.table").css("display", "none");
                $(".ntsp_table.table").removeClass("active");

                $("." + $(this).attr("tableName")).css("display", "table");
                $("." + $(this).attr("tableName")).addClass("active");
                $(".main.title").text("Predefined Rules - " + $(this)[0].innerText);
                removeRow($(".input > .prompt")[0].value.toLowerCase());
            }
        );
        
        $(".accordion .title").first().trigger("click");
        
        $('.ngl_doc .ui.accordion .dropdown.icon~a').click(function (e) {
            e.preventDefault();
            e.stopPropagation();
        });
        $(".accordion .title>a").first().trigger("click");

        
        $(".input > .prompt").keyup(function () {
            removeRow($(this)[0].value.toLowerCase());
        });
    });
</script>
</body>

</html>