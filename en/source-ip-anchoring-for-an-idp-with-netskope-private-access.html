<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Source IP Anchoring for an IdP with Netskope Private Access</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/jquery.paligocode.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="steer-traffic-for-private-apps.html#UUID-022b8dc6-595d-bc37-00d7-bf95cc918d23" title="Change Steering Configurations to Include Private Apps"></link><link rel="next" href="source-ip-anchoring-for-an-idp-with-netskope-private-access.html#UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_section-idm232282895867904" title="Phased Approach for Allowlisting Netskope IP Ranges"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script type="text/javascript">var containerid = 'GTM-W56WJ8S';

						(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
						})(window,document,'script','dataLayer',containerid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title"><span class="phrase">Netskope Private Access</span> User Guide</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html"><span class="phrase">Netskope Private Access</span> User Guide</a></li><li class="breadcrumb-node">Source IP Anchoring for an IdP with <span class="phrase">Netskope Private Access</span></li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="steer-traffic-for-private-apps.html#UUID-022b8dc6-595d-bc37-00d7-bf95cc918d23">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="source-ip-anchoring-for-an-idp-with-netskope-private-access.html#UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_section-idm232282895867904">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-62a518cd-f864-7695-3dc3-c85a7781952e" data-permalink="source-ip-anchoring-for-an-idp-with-netskope-private-access.html" data-topic-level="1" data-relative-prefix="" data-time-modified="October 12, 2021" data-publication-date="" id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1"><div class="titlepage"><div><div class="title"><h2 class="title" style="clear: both">Source IP Anchoring for an IdP with <span class="phrase">Netskope Private Access</span></h2></div></div></div><p>This topic describes how to obtaining a dedicated IP address from Netskope for your environment.</p><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282755764842" class="bridgehead">Background</h3><p>Many organizations have been utilizing IP address <span class="phrase">allowlisting</span> on their corporate cloud apps in order to ensure additional security should a user's credentials be compromised by a malicious actor. This <span class="phrase">allowlisting</span> is inclusive of all egress IP addresses for your data centers and remote offices. Typically for remote users, a VPN connection is required to access private applications and also their corporate cloud applications.</p><p>With Netskope, the traffic flow changes when utilizing the Netskope Client. Because the Netskope Client encrypts its connections to the Netskope proxy, cloud applications and IdP providers no longer see the corporate egress IP addresses and instead see an IP addresses for Netskope’s POPs.</p><p>The preferred solution is to add Netskope’s POP IP addresses to your IP address <span class="phrase">allowlisting</span> for conditional access and employ multi-factor authentication (MFA) with your IdP provider. If you do not want to use MFA or open up access to your cloud applications to Netskope’s POP IP address ranges, the following is an alternative solution to preserving your dedicated IP addresses when accessing SaaS apps or web sites.</p><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282775414853" class="bridgehead">Solution</h3><p>Let’s assume you are using an IdP provider like Okta, and that you have only one datacenter for all of their traffic.</p><p>By default, all Okta traffic is steered to Netskope proxy. This method changes this default behavior. Instead of sending Okta traffic through the Netskope proxy, this method defines your Okta URL as a <span class="emphasis"><em>private application</em></span> inside of <span class="phrase">Netskope Private Access</span>.</p><p><span class="strong strong"><strong>Netskope Publisher</strong></span>: There are a couple of options. You could deploy a Publisher inside your existing corporate data center. All Publisher traffic would be seen as your existing egress IP address (1.1.1.1).</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:450px;
                            "><tr><td style="padding:0;"><img src="image/uuid-0b85afd1-6cfe-fa0f-4286-b7d3288a4937.png" style="max-width: 450px; " alt="image1.png"></img></td></tr></table></div><p>Another option is to determine where your Okta instance is located, and deploy a Publisher in AWS, GCP, or Azure within a region that is closer to Okta instance.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:450px;
                            "><tr><td style="padding:0;"><img src="image/uuid-b7b7192f-3588-96f8-006c-91701b54d95b.png" style="max-width: 450px; " alt="image2.png"></img></td></tr></table></div><p>Open up a Terminal/Command Shell and try pinging your tenant URL:</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:450px;
                            "><tr><td style="padding:0;"><img src="image/uuid-6d05e99c-f372-2f36-f58f-24ffc25bf490.png" style="max-width: 450px; " alt="image3.png"></img></td></tr></table></div><p>You can see in the response, this Okta tenant is located in US-West-2 Region inside of AWS. Since you're East Coast based, it would be better to deploy a Publisher in the US-West-2 Region of AWS so the Netskope Security Cloud can provide the most optimized path to Okta from wherever the remote user is located without having to route back to the east coast data center just to go to the west coast data center for Okta.</p><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282846926807" class="bridgehead">In AWS</h3><p>Go to the AWS console.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:450px;
                            "><tr><td style="padding:0;"><img src="image/uuid-354d8ce0-eea3-1e5a-804f-1d4cbda44e92.png" style="max-width: 450px; " alt="image4.png"></img></td></tr></table></div><p>Deploy the Publisher AMI image into the West region of AWS and make note of the Public IP Address. Best practice for a production deployment of a Publisher is to use an elastic IP address so that if the Publisher is rebooted, it will keep the IP address across reboots.</p><div class="literallayout"><p><span style="white-space: pre;"><span class="strong strong"><strong>Okta:</strong></span><a class="link" href="http://netskopepartners.okta.com" target="_blank" rel="noopener">netskopepartners.okta.com</a>
<span class="strong strong"><strong>Okta Location:</strong></span> AWS US-West-2 Region
<span class="strong strong"><strong>Customer Corporate Egress IP:</strong></span> 1.1.1.1
<span class="strong strong"><strong>Customer Location:</strong></span> East Coast
<span class="strong strong"><strong>Netskope Publisher Egress IP:</strong></span> 54.193.39.103 (US-West-2 Region)</span></p></div><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282849852268" class="bridgehead">In Netskope</h3><p>In your Netskope tenant, go to <span class="bold bold"><strong>Settings &gt; <span class="phrase">Security Cloud Platform</span> &gt; App Definition</strong></span> and click on the <span class="bold bold"><strong>Private Apps</strong></span> tab.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:360px;
                            "><tr><td style="padding:0;"><img src="image/uuid-88c984c9-4c58-4ef2-24b5-606ae370bd2d.png" style="max-width: 360px; " alt="image5.png"></img></td></tr></table></div><p>Define the Okta URL as a Private Application and make it accessible in <span class="phrase">Real-time Protection</span> policy for Private Access.</p><p>This is going to force ONLY the Okta traffic to be sent via NPA publisher. The publisher ip address is an ip address that the customer is ‘renting’ from AWS and is <span class="strong strong"><strong>not shared</strong></span> by other customers.</p><p>Upon a successful login to the cloud application all of the cloud app traffic will be sent from the Netskope Client directly to Netskope proxy.</p><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282880342045" class="bridgehead">In Okta</h3><p>In Okta Administration, make sure you are IP <span class="phrase">allowlisting</span> ONLY your corporate data center’s egress IP address (1.1.1.1) and the NPA Publisher IP address (54.193.39.10). These are the only source IP addresses that the your Okta tenant will allow a successful login from (even if a malicious actors is on Netskope’s network has compromised credentials).</p><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282883561284" class="bridgehead">In Cloud Applications</h3><p>You should still allow Netskope’s POP IP addresses along with your corporate egress IPs.</p><p>A phased approach to <span class="phrase">allowlist</span> apps with Netskope IP ranges is outlined below.</p><h3 id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_bridgehead-idm232282891657603" class="bridgehead">Summary</h3><p>With the above configuration, if a malicious actor somehow obtains compromised credentials and am also a user of the Netskope Security Cloud, when attempting to access one of your corporate cloud applications, authentication will be redirected to Okta, but because the auth request is NOT coming from your Publisher or corporate egress IP address, a log in attempt will fail, even with valid credentials.</p><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_section-idm232282895867904"><div class="titlepage"><div><div class="title"><h3 class="title">Phased Approach for <span class="phrase">Allowlisting</span> Netskope IP Ranges</h3></div></div></div><p>This phased approach has been deployed by users that have IP <span class="phrase">allowlisted</span> around120 SaaS applications.</p><p><span class="bold bold"><strong>Phase 1</strong></span>: Bypass all of your 120 sanctioned apps in Netskope. Don't steer the apps until you <span class="phrase">allowlisted</span> the Netskope IP ranges in each SaaS app.  You will receive immediate visibility to ~2300 unsanctioned cloud applications, as well as all web site traffic, if you use <span class="phrase">Netskope Secure Web Gateway</span> in place of your existing SWG.</p><p><span class="bold bold"><strong>Phase 2</strong></span>: Add Netskope IP ranges to your sanctioned apps.  This doesn't have to be all at once - you could add our ranges in batches.</p><p><span class="bold bold"><strong>Phase 3</strong></span>: As you <span class="phrase">allowlist</span> the Netskope IP ranges to your SaaS apps, add sanctioned SaaS apps back to Netskope steering config so they pass through the NewEdge network for visibility, control, DLP, threat detection, etc.  Note - we purchased a /17 network so we have plenty of room for our future POPs that we'll be adding around the globe.  Once you add our ranges you should not have to adjust them again due to the public IP space we have.Continue until all of your 120 SaaS apps have the Netskope IP ranges added to their Allowed List.</p></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1">Source IP Anchoring for an IdP with Netskope Private Access</a></li><li><a href="#UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_section-idm232282895867904">Phased Approach for Allowlisting Netskope IP Ranges</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Source%20IP%20Anchoring%20for%20an%20IdP%20with%20Netskope%20Private%20Access%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Source%20IP%20Anchoring%20for%20an%20IdP%20with%20Netskope%20Private%20Access%22%20in%20the%20publication%20%22Netskope%20Private%20Access%20User%20Guide%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="steer-traffic-for-private-apps.html#UUID-022b8dc6-595d-bc37-00d7-bf95cc918d23">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="source-ip-anchoring-for-an-idp-with-netskope-private-access.html#UUID-24a3757c-9e2f-8b75-0844-33dd50a988c1_section-idm232282895867904">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">October 12, 2021</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W56WJ8S" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--></body></html>
