<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Configure Microsoft Office 365 Teams for API-enabled Protection</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="supported-microsoft-office-365-licenses-for-api-enabled-protection-232870.html" title="Supported Microsoft Office 365 Licenses for API-enabled Protection"></link><link rel="next" href="configure-microsoft-office-365-teams-for-api-enabled-protection-178419.html#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de885cfad4d3-idm44771228682000" title="Prerequisites"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script async="" src="https://www.googletagmanager.com/gtag/js?id=256425220"></script><script type="text/javascript">var propertyid = '256425220';

						window.dataLayer = window.dataLayer || [];
						function gtag(){dataLayer.push(arguments)};
						gtag('js', new Date());
						
						gtag('config', propertyid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="api-enabled-protection.html"><span class="phrase">API-enabled Protection</span></a></li><li class="breadcrumb-link"><a href="api-enabled-protection-for-microsoft-office-365-teams.html"><span class="phrase">API-enabled Protection</span> for Microsoft Office 365 Teams</a></li><li class="breadcrumb-link"><a href="configure-microsoft-office-365-teams-for-api-enabled-protection.html">Configure Microsoft Office 365 Teams for <span class="phrase">API-enabled Protection</span></a></li><li class="breadcrumb-node">Configure Microsoft Office 365 Teams for <span class="phrase">API-enabled Protection</span></li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="supported-microsoft-office-365-licenses-for-api-enabled-protection-232870.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-microsoft-office-365-teams-for-api-enabled-protection-178419.html#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de885cfad4d3-idm44771228682000">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-651777f9-ec35-f27d-2ab4-9c28577b1c15" data-permalink="configure-microsoft-office-365-teams-for-api-enabled-protection-178419.html" data-topic-level="1" data-relative-prefix="" data-time-modified="February 12, 2021" data-publication-date="" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63"><div class="titlepage"><div><div class="title"><h6 class="title">Configure Microsoft Office 365 Teams for <span class="phrase">API-enabled Protection</span></h6></div></div></div><p>Microsoft Teams is a messaging tool that enables collaboration between users or groups of users, both internal and external to the organization. Teams bring everything together in a shared workspace, letting you work from anywhere and making it easy for your team to chat, collaborate on files, and work with favorite apps. Teams extensively uses Office 365 groups, distribution lists and identities stored in Azure Active Directory (Azure AD). It is integrated with other Microsoft apps like Outlook, Skype, OneDrive, and SharePoint making it easier for users to interact.</p><p>Teams is available to Office 365 commercial customers with one of the plans described in Microsoft Office licensing <a class="link" href="https://docs.microsoft.com/en-us/microsoftteams/office-365-licensing" target="_blank" rel="noopener">page</a>.</p><p id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_para-idm43151039183308">To configure Microsoft Office 365 Teams for <span class="phrase">API-enabled Protection</span>, you need to create a Microsoft Office 365 Teams app instance in the Netskope UI.</p><div dir="ltr" class="important" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_important-idm43151039310146"><h3 class="title">Important</h3><p>Throughout this article, you will be prompted to enter your Office 365 credentials. Netskope does not store your Office 365 credentials. The credentials are used for creating OAuth tokens. Netskope only stores these tokens and not the actual credentials.</p></div><div dir="ltr" class="note"><h3 class="title">Note</h3><p id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_para-idm43184406709992">Netskope can scan files in Microsoft Office 365 Teams when they are shared and stored in the default cloud storage apps. The default cloud storage apps are:</p><div class="itemizedlist" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_itemizedlist-idm43184406736064"><ul style="list-style-type: disc; " class="itemizedlist"><li class="listitem"><p>Microsoft Office 365 OneDrive for files shared in direct messages and group chats.</p></li><li class="listitem"><p>Microsoft Office 365 SharePoint for files shared in channels.</p></li></ul></div><p id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_para-idm43184406757374">Netskope does not scan files if they are shared and stored in third-party cloud storage accounts.</p></div><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de885cfad4d3-idm44771228682000"><div class="titlepage"><div><div class="title"><h6 class="title">Prerequisites</h6></div></div></div><p id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_para-idm43151039452822">To grant Office 365 access for audit logs, following prerequisites must be met:</p><div class="itemizedlist" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_itemizedlist-idm43151039580376"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A global administrator account is required to grant access to Netskope. Post-grant, this account is not required for policy processing.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The way permissions work in Azure/Office 365 is that Netskope requires an administrator to grant enough privileges for Netskope to perform specific actions. Note that the Netskope app does not receive global admin permissions. It only receives permissions for the scope Netskope requests for.</p><p>In particular, the global admin is the only user that can delegate access for application-level permission (as opposed to user level permissions). You can find additional Microsoft documentation on how all these work <a class="link" href="https://developer.microsoft.com/en-us/graph/docs/concepts/permissions_reference" target="_blank" rel="noopener">here</a>. Furthermore, global admin credential is required for Graph and Office 365 Management APIs. Post-grant, Netskope is independent of the granting account for policy processing.</p></div></li><li class="listitem"><p>You must turn on audit logging in Microsoft 365 admin center. To enable audit logging, log in to admin.microsoft.com and navigate to <span class="bold bold"><strong>Admin &gt; Admin centers &gt; Security &gt; Search &gt; Audit log search</strong></span>. On the <span class="bold bold"><strong>Audit log search</strong></span> page, click <span class="bold bold"><strong>Start recording user and admin activity</strong></span>.</p><div dir="ltr" class="note" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_note-idm43188386343170"><h3 class="title">Note</h3><p>If you do not see this link, auditing has already been turned on for your organization. After you turn it on, a message is displayed that says the audit log is being prepared and that you can run a search in a couple of hours after the preparation is complete. You only have to do this once. For additional information, read this <a class="link" href="https://docs.microsoft.com/en-in/office365/securitycompliance/search-the-audit-log-in-security-and-compliance" target="_blank" rel="noopener">support article</a> on the Microsoft site.</p></div></li></ul></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de886e5cf98b-idm45502166897776"><div class="titlepage"><div><div class="title"><h6 class="title">Configure Netskope to Access your Office 365 Teams App</h6></div></div></div><p>To authorize Netskope to access your Microsoft Office 365 Teams account:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Log in to the Netskope tenant UI: <code class="literal">https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com</code> and go to <span class="bold bold"><strong>Settings &gt; <span class="phrase">API-enabled Protection</span> &gt; SaaS</strong></span>.</p></li><li class="listitem"><p>Select the <span class="bold bold"><strong>Microsoft Office 365 Team</strong></span>s icon. Enter the following details:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_listitem-idm43151045121998"><p>Under <span class="bold bold"><strong>INSTANCE NAME</strong></span>, enter a name of the Microsoft Office 365 Teams account. You can enter any name.</p></li><li class="listitem"><p>For <span class="bold bold"><strong>INSTANCE TYPE</strong></span>, select from the following options <span class="bold bold"><strong><span class="phrase">API-enabled Protection</span></strong></span>.</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><span class="phrase">API-enabled Protection</span></p></li><li class="listitem"><p>Malware - You can select this option to scan any file attachment for malware in private, public channels, direct messages, and group chats. Once detected, you can quarantine<sup>*</sup> the malware file. To do so, navigate to <span class="bold bold"><strong>Settings &gt; Threat Protection &gt; <span class="phrase">API-enabled Protection</span></strong></span>. Ensure that malware scanning is enabled for the Microsoft Teams app instance and under <span class="bold bold"><strong>Settings</strong></span>, select a quarantine profile. To view files affected by malware, navigate to <span class="bold bold"><strong>Incidents &gt; Malware</strong></span>.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><div class="itemizedlist"><ul style="list-style-type: circle; " class="itemizedlist"></ul></div><p id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_para-idm43206347514838"><sup>*</sup>Microsoft Teams is not a storage app. Due to this, you cannot create an exclusive quarantine profile. However, if you have set up any <span class="phrase">API-enabled Protection</span>-supported storage apps, you can leverage the quarantine profile of these apps. To set up a quarantine profile for any of the supported storage apps, refer to the documentation located <a class="link linktextconsumer" href="/document/preview/172066#UUID-9c154d25-ea5f-9a8c-f210-f44e2cafc442" target="_blank">here</a>.<span style="display:none !important;" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_N602de0e20714d" class="linktextprovider linktextprovider">Quarantine Profile</span></p></div></li></ul></div></li><li class="listitem" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_N1575525335721"><p>Enter your Microsoft Office 365 global administrator email address.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Netskope recommends creating a temporary global administrator account for this purpose. To do so, log in to your Microsoft Office 365 admin center and create a user with global administrator role. Later, you can either delete or downgrade this account to a non-global administrator account.</p></div></li><li class="listitem" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_listitem-idm43151045047634"><p>Enter a list of internal domains. Important points to note:</p><div dir="ltr" class="note" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_note-idm43190785094492"><h3 class="title">Note</h3><div class="itemizedlist"><ul style="list-style-type: disc; " class="itemizedlist"><li class="listitem" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_listitem-idm43201675593404"><p>Verified domains (in Office 365 tenant, their statuses are displayed as “healthy” and “possible service issues”) provisioned in the Office 365 tenant need not be added to the internal domain list. These domains will be automatically treated as internal by <span class="phrase">API-enabled Protection</span>. However, following domains can be added during the grant time if they need to be treated as internal by <span class="phrase">API-enabled Protection</span>:</p><div class="itemizedlist"><ul style="list-style-type: circle; " class="itemizedlist"><li class="listitem"><p>domains that are unverified (status displayed as “incomplete setup”) in the Office 365 tenant.</p></li><li class="listitem"><p>domains that are not provisioned in the Office 365 tenant.</p></li></ul></div><p>A sample example of Office 365 domains is as follows:</p><p>Log in to your Microsoft Office 365 Admin Center, then navigate to <span class="bold bold"><strong>Settings &gt; Domains</strong></span>.</p><div class="mediaobject"><img src="image/uuid-9106f656-0480-b47f-88e0-405459b560a2-en.png" alt="O365_Internal_Domains.png"></img></div></li><li class="listitem"><p>Ensure that you add the internal domains at grant time. Adding internal domains post-grant will require a re-grant, and will not mark the existing external users as internal even if the users are part of the internal domain.</p></li><li class="listitem"><p>For internal domains, wildcard DNS entries are not allowed.</p></li></ul></div></div></li></ol></div></li><li class="listitem"><p>Click <span class="bold bold"><strong>SAVE</strong></span>, then click <span class="bold bold"><strong>Grant Access</strong></span> for the app instance you just created.</p><p>After clicking <span class="bold bold"><strong>Grant Access</strong></span>, you will be prompted to log in with your global administrator username and password. <span class="bold bold"><strong>Accept</strong></span> the permissions and click <span class="bold bold"><strong>Close</strong></span>.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-9e7006a4-e1df-b384-84ab-ed7a73acda5a-en.png" style="max-width: 300px; " alt="Teams_Permission.png"></img></td></tr></table></div><p>The Netskope for Teams enterprise app is installed in Azure AD with the appropriate permissions once you grant the Microsoft Office 365 Teams app. For details on the permissions, refer <a class="xref" href="azure-web-app-permissions-for-microsoft-office-365-teams.html" title="Azure Web App Permissions for Microsoft Office 365 Teams"><span class="xreftitle">Azure Web App Permissions for Microsoft Office 365 Teams</span></a>.</p></li><li class="listitem"><p>Refresh your browser, and you should see a green check icon next to the instance name.</p><div dir="ltr" class="important" id="UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_important-idm43151050597748"><h3 class="title">Important</h3><p>After granting access, make sure you log in to <a class="link" href="https://login.microsoftonline.com/" target="_blank" rel="noopener">https://login.microsoftonline.com/</a> from a browser at least once with the email address you added in <a class="link" href="configure-microsoft-office-365-teams-for-api-enabled-protection-178419.html#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_N1575525335721">step 2c</a>. This step is mandatory so that Netskope can make successful API calls with the Microsoft Office 365 account.</p></div></li></ol></div><p>This completes the Microsoft Office 365 Teams integration with Netskope.</p></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63">Configure Microsoft Office 365 Teams for API-enabled Protection</a></li><li><a href="#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de885cfad4d3-idm44771228682000">Prerequisites</a></li><li><a href="#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de886e5cf98b-idm45502166897776">Configure Netskope to Access your Office 365 Teams App</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Configure%20Microsoft%20Office%20365%20Teams%20for%20API-enabled%20Protection%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Configure%20Microsoft%20Office%20365%20Teams%20for%20API-enabled%20Protection%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="supported-microsoft-office-365-licenses-for-api-enabled-protection-232870.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-microsoft-office-365-teams-for-api-enabled-protection-178419.html#UUID-8685cb4f-d01b-337c-aa7c-d18a11f38c63_section-5de885cfad4d3-idm44771228682000">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">February 12, 2021</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
