<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Netskope Private Access for SMB and DFS Services</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/jquery.paligocode.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="netskope-private-access-for-microsoft-active-directory-domain-services.html#UUID-cb7ba306-ed55-b0de-5f86-4f52338ce85d_section-idm4598684868313632697519476238" title="Configure Private Apps for Active Directory Domain Controllers"></link><link rel="next" href="netskope-private-access-for-microsoft-active-directory-domain-join-and-new-user-logon.html" title="Netskope Private Access for Microsoft Active Directory Domain Join and New User Logon"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script type="text/javascript">var containerid = 'GTM-W56WJ8S';

						(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
						})(window,document,'script','dataLayer',containerid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"><a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="data-security.html">Data Security</a></li><li class="breadcrumb-link"><a href="netskope-private-access.html"><span class="phrase">Netskope Private Access</span></a></li><li class="breadcrumb-node"><span class="phrase">Netskope Private Access</span> for SMB and DFS Services</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="netskope-private-access-for-microsoft-active-directory-domain-services.html#UUID-cb7ba306-ed55-b0de-5f86-4f52338ce85d_section-idm4598684868313632697519476238">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="netskope-private-access-for-microsoft-active-directory-domain-join-and-new-user-logon.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-de74826a-705c-eee6-ac74-36c0ad991e39" data-permalink="netskope-private-access-for-smb-and-dfs-services.html" data-topic-level="1" data-relative-prefix="" data-time-modified="January 26, 2022" data-publication-date="" id="UUID-a9a5ec0a-8da8-daca-ce69-0567705f0e3d"><div class="titlepage"><div><div class="title"><h4 class="title"><span class="phrase">Netskope Private Access</span> for SMB and DFS Services</h4></div></div></div><p>This article explains how to configure <span class="phrase">Netskope Private Access</span> (NPA) applications for file sharing protocols such as Server Message Block (SMB) and Distributed File System (DFS).</p><p>SMB is a communication protocol for providing shared access to files, network browsing, printing and inter-process communication over a network. There are a few well-known SMB protocol implementations like CIFS and Samba. SMB protocol relies on lower-level transport protocols like TCP and UDP. SMB works through a client-server approach, where the client makes specific requests and the server responds accordingly. Traditional file sharing resources can be accessed by SMB protocol in the form of <code class="literal">\\FileServer1\Tools\</code> or <code class="literal">\\FileServer2\Tools\</code> as an example.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:288px;
                            "><tr><td style="padding:0;"><img src="image/uuid-ebca5881-e2fc-5a8b-c48a-43cc4dafbfa4.png" style="max-width: 288px; " alt="image1.png" title="image1.png"></img></td></tr></table></div><p>DFS provides the ability to logically group distributed SMB file sharing resources and transparently link them into a hierarchical namespace. For example, instead of browsing through individual file sharing resources, the client accesses <code class="literal">\\YourWindowsDomain\Public\Software</code> and gets transparently redirected into either <code class="literal">\\FileServer1\Software</code> or <code class="literal">\\FileServer2\Software</code>, depending on its proximity and availability.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:360px;
                            "><tr><td style="padding:0;"><img src="image/uuid-3ec50d63-8df2-f761-b41a-eda037c4cdd5.png" style="max-width: 360px; " alt="image2.png" title="image2.png"></img></td></tr></table></div><p>Below is the description of different elements that make up a DFS namespace:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Namespace server: A namespace server hosts a namespace. The namespace server can be a member server or a domain controller.</p></li><li class="listitem"><p>Namespace root: The namespace root is the starting point of the namespace. In the above example, the name of the root is Public, and the namespace path is <code class="literal">\\YourWindowsDomain\Public</code>. This type of namespace is a domain-based namespace because it begins with a domain name and its metadata is stored in Active Directory Domain Services (AD DS).</p></li><li class="listitem"><p>Folder: Folders without folder targets add structure and hierarchy to the namespace, and folders with folder targets provide users with actual content. When users browse a folder that has folder targets in the namespace, the client computer receives a referral that transparently redirects the client computer to one of the folder targets.</p></li><li class="listitem"><p>Folder targets: The folder target is where data and content is stored. In the previous example, the folder named Tools has two folder targets - <code class="literal">\\FileServer1\Software</code> and <code class="literal">\\FileServer2\Software</code>.</p></li></ul></div><p>The vast majority of SMB implementations are tightly integrated with Windows Active Directory authentication services like Kerberos or NTLM. Kerbersos protocol is the primary authentication and authorization method for accessing file sharing resources. In order to access certain resources, the client retrieves a Kerbeos ticket from the Active Directory Domain Controller, which is acting as Key Distribution Center (KDC). This ticket is carried by the SMB protocol and presented to the destination file sharing service, which in turn validates it with KDC too. The NTLM protocol might be used as a fallback in case Kerberos is not supported by legacy or not domain-joined clients.</p><p>In case of distributed deployment when SMB file sharing resources and/or DFS namespace servers are configured on separate servers hosted in separate sites, you need to create separate configurations associated with different Publishers in order to achieve even traffic distribution.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:360px;
                            "><tr><td style="padding:0;"><img src="image/uuid-3846e0ce-a63b-888a-cb65-89cfc1b937f1.png" style="max-width: 360px; " alt="image3.png" title="image3.png"></img></td></tr></table></div><p>Proper deployment for Active Directory Domain Services (which includes Kerberos) is documented in this <a class="link" href="https://docs.netskope.com/en/netskope-private-access-for-microsoft-active-directory-domain-services.html" target="_blank" rel="noopener">article</a> and it <span class="strong strong"><strong>must</strong></span> be followed as a prerequisite if the domain-joined endpoints need to access DFS/SMB shares. Certain use cases with non-domain joined devices and/or legacy clients may rely on NTLM authentication. In this situation, connectivity to Active Directory domain controllers is not required, but the primary application to resolve internal domain resources with the Publisher DNS option from that article should still be created and assigned to the users in addition to the configuration below.</p><p>To create a Private Application, log in to the Netskope UI, go to <span class="bold bold"><strong>Settings &gt; Security Cloud Platform &gt; App Definition &gt; Private Apps</strong></span>, and then create a new private application named File Sharing Site 1 with these parameters:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Host (as per example in above diagram):</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>10.0.1.30</p></li><li class="listitem"><p>10.0.1.40</p></li></ul></div></li><li class="listitem"><p>Allow Browser Access toggle is disabled</p></li><li class="listitem"><p>Protocol and Port:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>TCP: 139, 445</p></li><li class="listitem"><p>UDP: 137, 138</p></li></ul></div></li><li class="listitem"><p>Publisher: In this case, you will select pub1. because it is dedicated for file sharing services and best positioned to serve traffic to those resources. If you have more than one publisher deployed at that physical location, you can also add them to the list of publishers serving this application for redundancy purposes.</p></li><li class="listitem"><p>Use Publisher DNS toggle is disabled</p></li></ul></div><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:360px;
                            "><tr><td style="padding:0;"><img src="image/uuid-b2512801-3bd7-99f8-02ff-9717024cf310.png" style="max-width: 360px; " alt="image4.png" title="image4.png"></img></td></tr></table></div><p>Repeat the same steps to create another new private application named File Sharing Site 2, but use <code class="literal">10.0.2.30</code> as the IP addresses in the application definition, as shown below:</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:360px;
                            "><tr><td style="padding:0;"><img src="image/uuid-615fdf16-73f0-9804-a492-2907527fc7b0.png" style="max-width: 360px; " alt="image5.png" title="image5.png"></img></td></tr></table></div><p>Ports used in the above configuration:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><colgroup><col align="left"></col><col align="left"></col></colgroup><tbody><tr><td class="td leftcol"><p><span class="strong strong"><strong>Port</strong></span></p></td><td class="td leftcol"><p><span class="strong strong"><strong>Description</strong></span></p></td></tr><tr><td class="td leftcol"><p>TCP:139</p></td><td class="td leftcol"><p>NetBIOS session service</p></td></tr><tr><td class="td leftcol"><p>TCP:445</p></td><td class="td leftcol"><p>SMB over TCP without NetBIOS</p></td></tr><tr><td class="td leftcol"><p>UDP:137</p></td><td class="td leftcol"><p>SMB over UDP (name services)</p></td></tr><tr><td class="td leftcol"><p>UDP:138</p></td><td class="td leftcol"><p>SMB over UDP (Datagram)</p></td></tr></tbody></table></div><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The above configuration is intended to provide backward compatibility to older versions of SMB protocol and clients (i.e. pre-Windows 2000). Modern SMB implementations require only TCP:445 to be configured in addition to Active Directory Domain Services connectivity mentioned above. We recommend that you evaluate connectivity requirements as it pertains to legacy SMB protocols and consider removing TCP:139, UDP: 137, UDP: 138 ports from your configuration to prevent network over-exposure:</p></div><p>After defining the above File Sharing applications, you can assign them to a desired users and/or groups in a Real-time Protection policy to provide ZTNA-based access to your SMB/DFS resources</p></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Netskope%20Private%20Access%20for%20SMB%20and%20DFS%20Services%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Netskope%20Private%20Access%20for%20SMB%20and%20DFS%20Services%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="netskope-private-access-for-microsoft-active-directory-domain-services.html#UUID-cb7ba306-ed55-b0de-5f86-4f52338ce85d_section-idm4598684868313632697519476238">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="netskope-private-access-for-microsoft-active-directory-domain-join-and-new-user-logon.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> Â© 2022 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">January 26, 2022</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W56WJ8S" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--></body></html>
