<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>REST API Reports</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/jquery.paligocode.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="common-reports.html" title="Common Reports"></link><link rel="next" href="appliances.html" title="Appliances"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script type="text/javascript">var containerid = 'GTM-W56WJ8S';

						(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
						new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
						j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
						'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
						})(window,document,'script','dataLayer',containerid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc collapsible-sidebar-nav current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="admin-console.html">Admin Console</a></li><li class="breadcrumb-link"><a href="reports.html">Reports</a></li><li class="breadcrumb-link"><a href="other-types-of-reports.html">Other Types of Reports</a></li><li class="breadcrumb-node">REST API Reports</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="common-reports.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="appliances.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-6ee9bf43-4b57-cedf-557c-25b8fc836800" data-permalink="rest-api-reports.html" data-topic-level="1" data-relative-prefix="" data-time-modified="August 18, 2021" data-publication-date="" id="UUID-80ddb2aa-37ff-a7a9-84d3-b07298cbc578"><div class="titlepage"><div><div class="title"><h5 class="title">REST API Reports</h5></div></div></div><p>You can also use REST APIs to analyze the data captured by Netskope for the following scenarios:</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>REST API responses can return up to 10000 results in a single response. You can use pagination to retrieve more results.</p></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Identify sensitive customer or employee information:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Alert administrator through email when Enterprise worker downloads PHI or PCI data onto an unmanaged device from Sanctioned cloud storage apps.</p></li><li class="listitem"><p>Alert administrator when Enterprise worker uploads PHI, PCI or PII data into cloud storage apps.</p></li><li class="listitem"><p>Alert administrator through email when user shares PHI content with non-@company.com user on cloud storage application.</p></li><li class="listitem"><p>Alert Administrator and employee's manager when user downloads large amount ( &gt;75k) PHI records from any device from Cloud storage. Notify centralize governing body through email.</p><p>The table below shows the REST API queries that are used</p><div class="informaltable table-responsive"><table style="width:100%;" class="informaltable frame-box rules-all"><colgroup><col style="width:25%;"></col><col style="width:75%;"></col></colgroup><thead><tr><th class="th" data-priority="1"><p>Purpose</p></th><th class="th" data-priority="1"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p>Pull all the DLP alerts for <span class="phrase">API Data Protection</span></p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal"> https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com/ api/v1/alerts?token=<span class="emphasis"><em>&lt;REST API token&gt;</em></span>&amp;type=dlp&amp;query=access_ method%20eq%20%27API%20 Connector%27&amp;timeperiod=604800 </code></p><p>This will pull the DLP alerts for <span class="phrase">API Data Protection</span> (<code class="literal">access_method = API Connector</code>) for a time period of 7 days.</p><p>You can set the time period for last 1 hour, last 7 days, last 30 days, etc.</p></td></tr><tr><td class="td"><p>Pull all the DLP alerts for a specific policy</p><p>(This is to cover use-case where admin is looking for specific PHI or PCI violation). Admin would query based on the policy name configured for the DLP inspection</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal"> https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com/ api/v1/alerts?token=<span class="emphasis"><em>&lt;token-no&gt;</em></span> &amp;type=dlp&amp;query=alert_name%20eq%20% 27Custom-PHI%27&amp;timeperiod=604800 </code></p><p>In this example, the policy name queried was <code class="literal">Custom-PHI</code>.</p></td></tr><tr><td class="td"><p>Pull events when a user downloads a PHI file</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal"> https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com/ api/v1/alerts?token=<span class="emphasis"><em>&lt;token&gt;</em></span>&amp;type= dlp&amp;query=activity%20eq%20Download %20and%20 alert_name%20eq%20% 27Custom-PHI%27&amp;timeperiod= 2592000 </code></p><p>In this example, query for <code class="literal">activity eq download and alert_name eq 'Custom-PHI'</code></p><p>This can be further filtered with device type to identify the downloads from a mobile device.</p></td></tr></tbody></table></div></li></ul></div></li><li class="listitem"><p>Identify and Protect Intellectual Property</p><p>Alerts the administrator when an employee uploads intellectual property data to the cloud. This involves using DLP Fingerprinting feature to fingerprint all the key design documents, looking for keywords such as confidential, sensitive, and so on, or using DLP Precise data matching.</p><p>You can query for DLP alerts based on specific DLP policy name, fingerprint classification or based on actions. To query for DLP alerts matching a specific DLP Fingerprint profile:</p><pre class="programlisting">https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com/api/v1/alerts?token=
<span class="emphasis"><em>&lt;token-no&gt;</em></span>&amp;type=dlp&amp;query=dlp_fingerprint_classification
%20eq%20intellectual&amp;timeperiod=2592000</pre><p>In the above example you are fetching all the DLP alerts that matched the fingerprint classification of intellectual</p></li><li class="listitem"><p>Audit all activities of the users</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Create a report to see all the top activities performed by the users</p></li><li class="listitem"><p>Create a report to understand the top applications usage</p></li><li class="listitem"><p>Query for risky apps</p></li><li class="listitem"><p>Query for risky users</p></li><li class="listitem"><p>Create a second level summary report to identify DLP violation per app,</p></li><li class="listitem"><p>Administrator can check for files that are shared outside of the organization</p></li></ul></div></li><li class="listitem"><p>Policy Governance</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Identify allowed apps vs blocked apps</p></li><li class="listitem"><p>Identify list of files that are quarantined</p></li><li class="listitem"><p>Identify list of files that are encrypted by policy</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><colgroup><col></col><col></col></colgroup><thead><tr><th class="th" data-priority="1"><p>Purpose</p></th><th class="th" data-priority="1"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p>Query events with action of encrypt</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com/api/v1/events?token=<span class="emphasis"><em>&lt;rest api token&gt;</em></span>&amp;type=application&amp;query=action%20eq%20encrypt&amp;timeperiod=604800</code></p></td></tr><tr><td class="td"><p>Block vs Allow Apps</p></td><td class="td"><p>Create a report with the following:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Event type: Alert</p></li><li class="listitem"><p>Query: Action (block)</p></li><li class="listitem"><p>Summarize by apps</p></li><li class="listitem"><p>Second level summary by users</p></li></ul></div><p>This report would show list of apps and list of users blocked per app.</p></td></tr><tr><td class="td"><p>Query events with action of quarantine</p></td><td class="td"><p><code class="literal">https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span></code> <code class="literal">.goskope.com/api/v1/events?token=<span class="emphasis"><em>&lt;rest api token&gt;</em></span>&amp;type=application&amp;query=action%20eq%20quarantine&amp;timeperiod =604800</code></p></td></tr><tr><td class="td"><p>Find the Top 10 applications for the last 24 hours</p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com/api/v1/report?token=<span class="emphasis"><em>&lt;rest api token&gt;</em></span>&amp;type=page&amp;groupby=application&amp;timeperiod=86400&amp;limit=10 </code></p></td></tr></tbody></table></div></li></ul></div></li></ol></div></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22REST%20API%20Reports%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22REST%20API%20Reports%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="common-reports.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="appliances.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">August 18, 2021</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div><!--Google Tag Manager (noscript)--><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W56WJ8S" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><!--End Google Tag Manager (noscript)--></body></html>
