<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Configure Microsoft Office 365 Outlook for API-enabled Protection</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="api-enabled-protection-overview-120301.html" title="API-enabled Protection Overview"></link><link rel="next" href="create-an-api-enabled-protection-policy-118932.html" title="Create an API-enabled Protection Policy"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script async="" src="https://www.googletagmanager.com/gtag/js?id=256425220"></script><script type="text/javascript">var propertyid = '256425220';

						window.dataLayer = window.dataLayer || [];
						function gtag(){dataLayer.push(arguments)};
						gtag('js', new Date());
						
						gtag('config', propertyid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="api-enabled-protection.html"><span class="phrase">API-enabled Protection</span></a></li><li class="breadcrumb-link"><a href="api-enabled-protection-for-microsoft-office-365-outlook.html"><span class="phrase">API-enabled Protection</span> for Microsoft Office 365 Outlook</a></li><li class="breadcrumb-node">Configure Microsoft Office 365 Outlook for <span class="phrase"></span><span class="phrase">API-enabled Protection</span></li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="api-enabled-protection-overview-120301.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="create-an-api-enabled-protection-policy-118932.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section reused-publication reused-publication" data-origin-id="UUID-02b8ff28-763f-d9c1-5dbe-b52e3e7c56b4" data-permalink="configure-microsoft-office-365-outlook-for-api-enabled-protection.html" data-topic-level="1" data-relative-prefix="" data-time-modified="January 29, 2020" data-publication-date="" id="UUID-02b8ff28-763f-d9c1-5dbe-b52e3e7c56b4"><div class="titlepage"><div><div class="title"><h5 class="title">Configure Microsoft Office 365 Outlook for <span class="phrase"></span><span class="phrase">API-enabled Protection</span></h5></div></div></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="" data-time-modified="February 13, 2020" data-publication-date="" id="UUID-02b8ff28-763f-d9c1-5dbe-b52e3e7c56b4_UUID-d25e2856-8fd8-6519-b4e0-0e8d6a549880"><div class="titlepage"><div><div class="title"><h6 class="title"><span class="phrase">API-enabled Protection</span> API Connectors</h6></div></div></div><p>Netskope <span class="phrase">API-enabled Protection</span> works by directly connecting to the cloud app using the APIs published by the app, and uses OAuth to gain delegated access to the app.</p><p>Netskope's <span class="phrase">API-enabled Protection</span> provides a complementary deployment model to provide cloud visibility, policy, and data security services by directly connecting to the cloud service using the APIs published by the cloud services. The API Connector works in conjunction with the Netskope cloud proxy to provide defense-in-depth security services. The API Connector is only available for data security related services such as DLP, Active Encryption, and Active Permissions Management.</p><div class="informalfigure"><div class="mediaobject image-left" style="text-align:left;"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:450px;
                            "><tr style="height: 270px"><td style="padding:0;text-align:left;
                                        "><img src="image/uuid-ae7c1a52-4421-75da-bd22-c4680067233d-en.png" style="max-width: 450px; max-height: 270px; " alt="HowIntrospectionWorks.png"></img></td></tr></table></div></div></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-9b81cf37-db94-3587-c48c-8cf4657bd9d9" data-time-modified="October 17, 2020" data-publication-date="" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9"><div class="titlepage"><div><div class="title"><h6 class="title">Configure Microsoft Office 365 Outlook for <span class="phrase">API-enabled Protection</span></h6></div></div></div><p>To use <span class="phrase">API-enabled Protection</span> with Microsoft Office 365 Outlook, first you need to connect Netskope to your Microsoft Office 365 Outlook app with APIs. Netskope can scan your Outlook.com account for emails with attachment and body. In addition, Netskope can run DLP on emails. The following sections explain how the API connectors work and how to configure the connection.</p><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_section-5ccbc70c46a88-idm45390849691072"><div class="titlepage"><div><div class="title"><h6 class="title">Configure Netskope to Access your Office 365 Outlook App</h6></div></div></div><p>To authorize Netskope to access your Office 365 Outlook account, follow the steps below:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Log in to the Netskope tenant UI: <code class="literal">https://<span class="emphasis"><em>&lt;tenant hostname&gt;</em></span>.goskope.com</code> and go to <span class="bold bold"><strong>Settings &gt; <span class="phrase">API-enabled Protection</span> &gt; SaaS</strong></span>.</p></li><li class="listitem"><p>Select the <span class="bold bold"><strong>Microsoft Office 365 Outlook.com</strong></span> icon, and then click <span class="bold bold"><strong>Setup Instance</strong></span>.</p></li><li class="listitem"><p>The <span class="bold bold"><strong>Setup Instances</strong></span> window opens. Enter the following details:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>For instance name, enter the domain name of the Microsoft Office 365 account.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>To find the domain name of your Microsoft Office 365 account, log in to your Microsoft 365 admin center and then navigate to <span class="bold bold"><strong>Microsoft 365 admin center &gt; Home &gt; Settings &gt; Domains</strong></span>. If your fully qualified domain name (FQDN) is <span class="emphasis"><em>my-domain.onmicrosoft.com</em></span>, then specify <span class="emphasis"><em>my-domain</em></span> as the domain name in the instance name field.</p></div></li><li class="listitem"><p>For instance type, enable the <span class="bold bold"><strong><span class="phrase">API-enabled Protection</span></strong></span> check box.</p></li><li class="listitem" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_N1556862572420"><p>Enter your Office 365 global administrator email address.</p><div dir="ltr" class="note" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_note-idm43113722905958"><h3 class="title">Note</h3><div class="itemizedlist"><ul style="list-style-type: disc; " class="itemizedlist"><li class="listitem"><p>If the service account is expiring or there is a change in the admin role email address, you can edit this email address after setting up the app instance.</p></li></ul></div></div></li><li class="listitem"><p>Enter a list of internal domains. Important points to note:</p><div dir="ltr" class="note" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_note-idm43190784657042"><h3 class="title">Note</h3><div class="itemizedlist"><ul style="list-style-type: disc; " class="itemizedlist"><li class="listitem" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_listitem-idm43201675267128"><p>Verified domains (in Office 365 tenant, their statuses are displayed as “healthy” and “possible service issues”) provisioned in the Office 365 tenant need not be added to the internal domain list. These domains will be automatically treated as internal by <span class="phrase">API-enabled Protection</span>. However, following domains can be added during the grant time if they need to be treated as internal by <span class="phrase">API-enabled Protection</span>:</p><div class="itemizedlist"><ul style="list-style-type: circle; " class="itemizedlist"><li class="listitem"><p>domains that are unverified (status displayed as “incomplete setup”) in the Office 365 tenant.</p></li><li class="listitem"><p>domains that are not provisioned in the Office 365 tenant.</p></li></ul></div><p>A sample example of Office 365 domains is as follows:</p><p>Log in to your Microsoft Office 365 Admin Center, then navigate to <span class="bold bold"><strong>Settings &gt; Domains</strong></span>.</p><div class="mediaobject"><img src="image/uuid-9106f656-0480-b47f-88e0-405459b560a2-en.png" alt="O365_Internal_Domains.png"></img></div></li><li class="listitem"><p>Ensure that you add the internal domains at grant time. Adding internal domains post-grant will require a re-grant, and will not mark the existing external users as internal even if the users are part of the internal domain.</p></li><li class="listitem"><p>For internal domains, wildcard DNS entries are not allowed.</p></li></ul></div></div></li></ol></div></li><li class="listitem"><p>Click <span class="bold bold"><strong>Save</strong></span>, then click <span class="bold bold"><strong>Grant Access</strong></span> for the app instance you just created.</p><p>After clicking <span class="bold bold"><strong>Grant Access</strong></span>, you will be prompted to log in with your global administrator username and password, and then <span class="bold bold"><strong>Accept</strong></span> the permissions and click <span class="bold bold"><strong>Close</strong></span>.</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-dd4326c2-2076-076a-729b-8db64063f0aa-en.png" style="max-width: 300px; " alt="O365_New_Permissions_OL.png"></img></td></tr></table></div><p>The Netskope <span class="phrase">API-enabled Protection</span> for Microsoft Outlook enterprise app is installed in Azure AD with additional permissions once you grant the Microsoft Office 365 Outlook app. Going forward, the Microsoft Office 365 Outlook app instance will utilize the new Graph API from Microsoft.</p></li><li class="listitem"><p>Refresh your browser, and you should see a green check icon next to the instance name.</p><div dir="ltr" class="important" id="UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_important-idm43113725103362"><h3 class="title">Important</h3><p>After granting access, make sure you log in to <a class="link" href="https://login.microsoftonline.com/" target="_blank" rel="noopener">https://login.microsoftonline.com/</a> from a browser at least once with the email address you added in <a class="link" href="configure-microsoft-office-365-outlook-for-api-enabled-protection.html#UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_N1556862572420">step 3c</a>. This step is mandatory so that Netskope can make successful API calls with the Microsoft Office 365 account.</p></div></li></ol></div><div dir="ltr" class="important"><h3 class="title">Important</h3><p>Netskope lists and processes policies for the following 'licensed' Outlook users only:</p><div class="itemizedlist"><ul style="list-style-type: disc; " class="itemizedlist"><li class="listitem"><p>'null' user - A user synchronized from an Active Directory.</p></li><li class="listitem"><p>'member' user - A user created in Office 365 admin console or Azure portal.</p></li></ul></div><p>Netskope excludes unlicensed users from user listing and policy processing. Guest users are listed as external users. However, they are excluded from policy processing.</p></div></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-41adc266-71ad-be65-5c8e-be4d3a497770" data-time-modified="March 9, 2020" data-publication-date="" id="UUID-444ad453-efa3-dd11-25c1-40b126176a60"><div class="titlepage"><div><div class="title"><h6 class="title">Azure Web App Permissions for Microsoft Office 365 Outlook</h6></div></div></div><p>Netskope seeks consent for the following Azure web app permissions for Microsoft Office 365 Outlook:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><thead><tr><th class="th" data-priority="1"><p>API</p></th><th class="th" data-priority="1"><p>Permission</p></th><th class="th" data-priority="1"><p>Description</p></th><th class="th" data-priority="1"><p>Netskope Use Case</p></th></tr></thead><tbody><tr><td class="td"><p>Azure Active Directory Graph API</p></td><td class="td"><p>User.Read</p></td><td class="td"><p>Sign in and read user profile.</p></td><td class="td"><p>User meta information.</p></td></tr><tr><td rowspan="6" class="td"><p>Exchange API</p></td><td class="td"><p>Calendars.Read</p></td><td class="td"><p>Read calendars in all mailboxes.</p></td><td class="td"><p>Mail notification processing.</p></td></tr><tr><td class="td"><p>Calendars.Read.All</p></td><td class="td"><p>Read calendars in all mailboxes.</p></td><td class="td"><p>Mail notification processing.</p></td></tr><tr><td class="td"><p>Contacts.Read</p></td><td class="td"><p>Read contacts in all mailboxes.</p></td><td class="td"><p>Policy Processing.</p></td></tr><tr><td class="td"><p>full_access_as_app</p></td><td class="td"><p>Use exchange web services with full access to all mailboxes.</p></td><td class="td"><p>Access mailbox, mail folders.</p></td></tr><tr><td class="td"><p>Mail.Read</p></td><td class="td"><p>Read mail in all mailboxes.</p></td><td class="td"><p>Mail notification processing.</p></td></tr><tr><td class="td"><p>MailboxSettings.Read</p></td><td class="td"><p>Read all user mailbox settings.</p></td><td class="td"><p>Policy processing.</p></td></tr><tr><td rowspan="7" class="td"><p>Microsoft Graph API</p></td><td class="td"><p>Contacts.Read</p></td><td class="td"><p>Read contacts in all mailboxes.</p></td><td class="td"><p>User listing, policy processing.</p></td></tr><tr><td class="td"><p>Device.ReadWrite.All</p></td><td class="td"><p>Read and write devices.</p></td><td class="td"><p>User listing.</p></td></tr><tr><td class="td"><p>Directory.Read.All</p></td><td class="td"><p>Read directory data.</p></td><td class="td"><p>User listing.</p></td></tr><tr><td class="td"><p>Group.Read.All</p></td><td class="td"><p>Read all groups.</p></td><td class="td"><p>User group information.</p></td></tr><tr><td class="td"><p>Mail.Read</p></td><td class="td"><p>Read mail in all mailboxes.</p></td><td class="td"><p>Mail notification processing.</p></td></tr><tr><td class="td"><p>MailboxSettings.Read</p></td><td class="td"><p>Read all user mailbox settings.</p></td><td class="td"><p>Policy processing.</p></td></tr><tr><td class="td"><p>User.Read.All</p></td><td class="td"><p>Read all users' full profiles.</p></td><td class="td"><p>User meta information.</p></td></tr></tbody></table></div></section></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-86a77a1e-418a-9a8b-752c-d30dfa178572" data-time-modified="June 27, 2019" data-publication-date="" id="UUID-bd85c975-ca3e-a79d-8520-16cf37353350"><div class="titlepage"><div><div class="title"><h6 class="title">Additional Reading</h6></div></div></div><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-321156bc-a31f-cf56-3bc5-103172e7ab48" data-time-modified="June 21, 2019" data-publication-date="" id="UUID-7f91888d-540b-d5fa-9b3d-5ed8bb579700"><div class="titlepage"><div><div class="title"><h6 class="title">Internal Domain Limitations</h6></div></div></div><div class="itemizedlist" id="UUID-7f91888d-540b-d5fa-9b3d-5ed8bb579700_itemizedlist-idm43113730764804"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Post-processed files will not be processed again and there will be no change to the file exposure for such files.</p></li><li class="listitem"><p>Netskope will not support files that belong to the domains other than the admin domain.</p></li><li class="listitem"><p>Netskope tracks three categories of users:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Users in the Office 365 admin domain</p></li><li class="listitem"><p>Users not in the admin domain but in a domain that is listed as <span class="emphasis"><em>internal</em></span> during the provisioning time of the Office 365 app</p></li><li class="listitem"><p>External users (as for Office 365)</p></li></ul></div><p>Netskope will only list users that belong to the Office 365 admin domain, under the <span class="bold bold"><strong>Internal Users</strong></span> tab of the <span class="phrase"></span><span class="phrase">API-enabled Protection</span> dashboard. Office 365 does not list users belonging to domains listed as internal in Netskope. Users that belong to the internal domain, although are not listed under the <span class="bold bold"><strong>Internal Users</strong></span> tab of the <span class="phrase"></span><span class="phrase">API-enabled Protection</span> dashboard, will continue to be treated as internal users for policy scans. These internal users will be listed in case of sharing-related activities in the <span class="bold bold"><strong>File Details</strong></span> page of the <span class="phrase"></span><span class="phrase">API-enabled Protection</span> dashboard.</p></li><li class="listitem"><p>Only those users who have access to root team site will be processed by Netskope.</p></li></ul></div></section><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-a8dc5020-8e2a-c197-6d2d-3051091c072f" data-time-modified="February 26, 2020" data-publication-date="" id="UUID-67db302e-da6c-21fb-bb2c-84eeb83040d2"><div class="titlepage"><div><div class="title"><h6 class="title">Microsoft Office 365 and Netskope <span class="phrase">API-enabled Protection</span> Frequently Asked Questions</h6></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Which family of APIs Netskope leverages for Microsoft Office 365 <span class="phrase">OneDrive</span><span class="phrase">SharePoint</span><span class="phrase">Outlook</span>?</p><p>A: Microsoft Office 365 <span class="phrase">OneDrive</span><span class="phrase">SharePoint</span><span class="phrase">Outlook</span> uses the following APIs:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>SharePoint API (legacy)</p></li><li class="listitem"><p>Microsoft Graph API (new)</p></li><li class="listitem"><p>Office 365 Management API</p></li><li class="listitem"><p>Outlook REST API</p></li></ul></div></li><li class="listitem"><p>Why does Netskope use a SharePoint plugin and an Azure web app (service principal)?</p><p>A: The plug-in is used to register/receive notifications and for policy enforcement when using the (old) SharePoint APIs, while the Azure web app is the equivalent for the (new) Graph APIs. SharePoint APIs are still a fallback mechanism in case Graph API doesn't provide all that Netskope requires. As of today, you still have both APIs, however in the near future, when Netskope decommissions the SharePoint APIs, you do not have to install the SharePoint plug-in, and Netskope will leverage the service principal app that is automatically installed in Azure at the time of grant.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>Microsoft Outlook utilizes the Graph API only, and that is why it uses the Azure web app (service principal) for Microsoft Exchange online, and not the SharePoint plug-in.</p></div></li><li class="listitem"><p>What are the app entitlements for SharePoint plugin and Azure web app?</p><p>A:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>For SharePoint plugin:</p><div class="mediaobject"><img src="image/uuid-14a7c371-4137-fe92-6535-eb945d575e84-en.png" style="" alt="O365_TrustIt.png"></img></div></li><li class="listitem"><p>For Azure web app:</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-64c0e437-b378-8867-97c9-41a22fba65d2-en.png" style="max-width: 300px; " alt="O365_New_Permissions.png"></img></td></tr></table></div><div class="mediaobject" id="UUID-67db302e-da6c-21fb-bb2c-84eeb83040d2_mediaobject-idm43116178983702"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-eba8fa60-88d7-0c88-8036-a0cb67963a00-en.png" style="max-width: 300px; " alt="O365_New_Permissions_SP.png"></img></td></tr></table></div></li></ul></div></li><li class="listitem"><p>Why does Netskope require global admin credentials?</p><p>A: The way permissions work in Azure/Office 365 is that Netskope requires an administrator to grant enough privileges for Netskope to perform specific actions. Note that the Netskope app does not receive global admin permissions. It only receives permissions for the scope Netskope requests for (listed below at the time of grant):</p><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-64c0e437-b378-8867-97c9-41a22fba65d2-en.png" style="max-width: 300px; " alt="O365_New_Permissions.png"></img></td></tr></table></div><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-eba8fa60-88d7-0c88-8036-a0cb67963a00-en.png" style="max-width: 300px; " alt="O365_New_Permissions_SP.png"></img></td></tr></table></div><div class="mediaobject"><table class="image-viewport" style="border-collapse:collapse;border:0;
                                width:300px;
                            "><tr><td style="padding:0;"><img src="image/uuid-dd4326c2-2076-076a-729b-8db64063f0aa-en.png" style="max-width: 300px; " alt="O365_New_Permissions_OL.png"></img></td></tr></table></div><p>In particular, the global admin is the only user that can delegate access for application-level permission (as opposed to user level permissions). You can find additional Microsoft documentation on how all these work <a class="link" href="https://developer.microsoft.com/en-us/graph/docs/concepts/permissions_reference" target="_blank" rel="noopener">here</a>. Furthermore, global admin credential is required for Graph and Office 365 Management APIs. Post-grant, Netskope is independent of the granting account for policy processing.</p></li></ol></div></section></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-02b8ff28-763f-d9c1-5dbe-b52e3e7c56b4">Configure Microsoft Office 365 Outlook for API-enabled Protection</a></li><li><a href="#UUID-02b8ff28-763f-d9c1-5dbe-b52e3e7c56b4_UUID-d25e2856-8fd8-6519-b4e0-0e8d6a549880">API-enabled Protection API Connectors</a></li><li><a href="#UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9">Configure Microsoft Office 365 Outlook for API-enabled Protection</a><ul class="nav"><li><a href="#UUID-3ae7a477-5be4-7b85-5d84-13ecf898e0c9_section-5ccbc70c46a88-idm45390849691072">Configure Netskope to Access your Office 365 Outlook App</a></li><li><a href="#UUID-444ad453-efa3-dd11-25c1-40b126176a60">Azure Web App Permissions for Microsoft Office 365 Outlook</a></li></ul></li><li><a href="#UUID-bd85c975-ca3e-a79d-8520-16cf37353350">Additional Reading</a><ul class="nav"><li><a href="#UUID-7f91888d-540b-d5fa-9b3d-5ed8bb579700">Internal Domain Limitations</a></li><li><a href="#UUID-67db302e-da6c-21fb-bb2c-84eeb83040d2">Microsoft Office 365 and Netskope API-enabled Protection Frequently Asked Questions</a></li></ul></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Configure%20Microsoft%20Office%20365%20Outlook%20for%20API-enabled%20Protection%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Configure%20Microsoft%20Office%20365%20Outlook%20for%20API-enabled%20Protection%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="api-enabled-protection-overview-120301.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="create-an-api-enabled-protection-policy-118932.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">January 29, 2020</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
