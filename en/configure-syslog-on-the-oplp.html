<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Configure Syslog on the OPLP</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="upload-logs-from-an-amazon-s3-bucket.html" title="Upload logs from an Amazon S3 bucket"></link><link rel="next" href="configure-ssh-keys-for-log-uploads-144858.html" title="Configure SSH Keys for Log Uploads"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script async="" src="https://www.googletagmanager.com/gtag/js?id=256425220"></script><script type="text/javascript">var propertyid = '256425220';

						window.dataLayer = window.dataLayer || [];
						function gtag(){dataLayer.push(arguments)};
						gtag('js', new Date());
						
						gtag('config', propertyid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="appliances.html">Appliances</a></li><li class="breadcrumb-link"><a href="virtual-appliance.html"> Virtual Appliance</a></li><li class="breadcrumb-link"><a href="configure-the-log-parser.html">Configure the Log Parser</a></li><li class="breadcrumb-node">Configure Syslog on the OPLP</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="upload-logs-from-an-amazon-s3-bucket.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-ssh-keys-for-log-uploads-144858.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-f27fbb5e-8fb2-41d9-71ed-615f28be5782" data-permalink="configure-syslog-on-the-oplp.html" data-topic-level="1" data-relative-prefix="" data-time-modified="October 9, 2019" data-publication-date="" id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92"><div class="titlepage"><div><div class="title"><h5 class="title">Configure Syslog on the OPLP</h5></div></div></div><p>You can configure syslog on the OPLP to stream syslog messages directly from the enterprise firewall or proxy servers.</p><p id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_LogsStreamed">After the logs are streamed via syslog to the OPLP, the syslog messages are written to a file in the <code class="literal">/nslogs/user/upload/<span class="emphasis"><em>&lt;parser-name&gt;</em></span></code> folder. The file is captured at the beginning of every hour with the file name format: <code class="literal">parser-name_month_day_hour_host.log</code>. Due to processing time, the latest completed file is for the previous hour.</p><p id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_LogsProcessed">After the logs are processed, the extracted cloud app events will get uploaded to your tenant instance in the Netskope cloud. To check the status of the logs in the Netskope tenant UI, go to <span class="bold bold"><strong>Settings &gt; <span class="phrase">Risk Insights</span> &gt; Log &gt; Upload</strong></span> page. You can also check the status of the logs on the OPLP using the command line interface (CLI).</p><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="idp226337"><div class="titlepage"><div><div class="title"><h6 class="title">Basic Setup</h6></div></div></div><p><code class="literal">protocol</code> specifies to use TCP or UDP. The default protocol is UDP and the default syslog port is 514.</p><p>Before setting the protocol, you must stop all processes that are running or in-flight.</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Run the following command in operation mode.</p><pre class="programlisting">log-upload stop</pre></li><li class="listitem"><p>Run the following commands in configuration mode to enable syslog on the OPLP.</p><pre class="programlisting">set log-upload syslogng protocol <span class="emphasis"><em>&lt;TCP|UDP&gt;</em></span>
set log-upload syslogng noparse enable true</pre><p><code class="literal">noparse enable true</code> ensures the syslog message received from the firewall and/or proxy is written as-is and not truncated by the syslogng. If you are enabling syslog, we recommend that you enable this configuration.</p></li></ol></div></section><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_section-5cc77c4027c02-idm46399448260032"><div class="titlepage"><div><div class="title"><h6 class="title">Enable TLS for Log Upload via Syslog</h6></div></div></div><p>You can configure syslog to upload logs to the OPLP using a TLS connection. TLS can only be enabled if the <code class="literal">protocol</code> is set to TCP. To enable TLS on syslogng you will require a server certificate and key.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The appliance does not generate the server certificate and key.</p></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Run the following commands in configuration mode to enable TLS for syslog.</p><pre class="programlisting">set log-upload syslogng tls enable true
set log-upload syslogng tls server-cert
set log-upload syslogng tls server-key</pre></li></ul></div></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_LogSource"><div class="titlepage"><div><div class="title"><h6 class="title">Define the Log Source</h6></div></div></div><p>Specifies what parser type to use for processing logs. For example, if you are uploading bluecoat proxy logs, choose <code class="literal">logsource proxysg-http-main</code>. Here are the valid options:</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>These parser type names are case-sensitive must be entered exactly as they appear in this table.</p></div><div class="informaltable table-responsive"><table class="informaltable table-bordered"><colgroup><col></col><col></col><col></col><col></col></colgroup><tbody><tr><td class="td"><p>asa</p></td><td class="td"><p>fortigate</p></td><td class="td"><p>proxysg</p></td><td class="td"><p>squid</p></td></tr><tr><td class="td"><p>asa-syslog</p></td><td class="td"><p>greenplum-bluecoat</p></td><td class="td"><p>proxysg-http-main</p></td><td class="td"><p>symantec-web-security</p></td></tr><tr><td class="td"><p>bro-ids</p></td><td class="td"><p>isa-splunk</p></td><td class="td"><p>proxysg-websense</p></td><td class="td"><p>trustwave</p></td></tr><tr><td class="td"><p>chkp</p></td><td class="td"><p>juniper-srx-structured-syslog</p></td><td class="td"><p>scansafe</p></td><td class="td"><p>websense</p></td></tr><tr><td class="td"><p>cisco-fwsm-syslog</p></td><td class="td"><p>mcafee</p></td><td class="td"><p>sensage</p></td><td class="td"><p>zscaler</p></td></tr><tr><td class="td"><p>cisco-wsa</p></td><td class="td"><p>netscreen-traffic</p></td><td class="td"><p>sfwder</p></td><td class="td"><p></p></td></tr><tr><td class="td"><p>cisco-wsa-syslog</p></td><td class="td"><p>panw</p></td><td class="td"><p>sonicwall-syslog</p></td><td class="td"><p></p></td></tr><tr><td class="td"><p>custom-csv</p></td><td class="td"><p>panw-syslog</p></td><td class="td"><p>sophos</p></td><td class="td"><p></p></td></tr></tbody></table></div><pre class="programlisting">add log-upload syslogng parserconfig
{server response should be} added index 0
set log-upload syslogng parserconfig 0 logsource <span class="emphasis"><em>&lt;log-source&gt;</em></span></pre></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_Filters"><div class="titlepage"><div><div class="title"><h6 class="title">Define Filters</h6></div></div></div><p>Separate logs into different directories based on the data in the logs.</p><pre class="programlisting">set log-upload syslogng parserconfig 0 filter message <span class="emphasis"><em>&lt;message&gt;</em></span>
set log-upload syslogng parserconfig 0 filter name <span class="emphasis"><em>&lt;filter name&gt;</em></span></pre></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_Macros"><div class="titlepage"><div><div class="title"><h6 class="title">Define Macros</h6></div></div></div><p>Defines which macro templates to use.</p><pre class="programlisting">set log-upload syslogng parserconfig 0 macros <span class="emphasis"><em>&lt;macros&gt;</em></span></pre></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_Substitutions"><div class="titlepage"><div><div class="title"><h6 class="title">Define Substitutions</h6></div></div></div><p>Defines how to reformat the log files retrieved.</p><pre class="programlisting">add log-upload syslogng parserconfig 0 rewrite substitute
set log-upload syslogng parserconfig 0 rewrite name <span class="emphasis"><em>&lt;any substition name&gt;</em></span>

set log-upload syslogng parserconfig 0 rewrite substitute 0 flags <span class="emphasis"><em>&lt;flag&gt;</em></span></pre><div dir="ltr" class="note"><h3 class="title">Note</h3><p>This last command is optional. An example of a flag is <code class="literal">global</code>, <code class="literal">ignore-case</code>, etc.</p></div><pre class="programlisting">set log-upload syslogng parserconfig 0 rewrite substitute 0 fromstring <span class="emphasis"><em>&lt;fromstring&gt;</em></span>
set log-upload syslogng parserconfig 0 rewrite substitute 0 tostring <span class="emphasis"><em>&lt;tostring&gt;</em></span>
set log-upload syslogng parserconfig 0 rewrite substitute 0 value message</pre></section><section dir="ltr" class="section internal internal" data-origin-id="" data-publication-date="" id="idp226473"><div class="titlepage"><div><div class="title"><h6 class="title">Linux Firewall – iptables</h6></div></div></div><p>You must be logged in as root to add an IP table. If your RHEL6 system is running an iptables firewall, all the required ports may not be open. For instance, if you plan to stream syslog over TCP port 514, you may need to use the command:</p><pre class="programlisting">iptables -I INPUT -p tcp -m tcp --dport 514 -j ACCEPT</pre><div dir="ltr" class="note"><h3 class="title">Note</h3><p>This port is configurable and does not explicitly have to be 514.</p></div><p>If you will be using AD Connector, you will also need:</p><pre class="programlisting">iptables -I INPUT -p tcp -m tcp --dport 4400 -j ACCEPT</pre></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92">Configure Syslog on the OPLP</a></li><li><a href="#idp226337">Basic Setup</a></li><li><a href="#UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_section-5cc77c4027c02-idm46399448260032">Enable TLS for Log Upload via Syslog</a></li><li><a href="#UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_LogSource">Define the Log Source</a></li><li><a href="#UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_Filters">Define Filters</a></li><li><a href="#UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_Macros">Define Macros</a></li><li><a href="#UUID-c1efdebf-2c28-43b1-bcfb-49d802aaae92_Substitutions">Define Substitutions</a></li><li><a href="#idp226473">Linux Firewall – iptables</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Configure%20Syslog%20on%20the%20OPLP%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Configure%20Syslog%20on%20the%20OPLP%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="upload-logs-from-an-amazon-s3-bucket.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-ssh-keys-for-log-uploads-144858.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">October 9, 2019</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
