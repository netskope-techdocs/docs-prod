<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Configure Microsoft Office 365 OneDrive for API-enabled Protection</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="supported-microsoft-office-365-licenses-for-api-enabled-protection.html" title="Supported Microsoft Office 365 Licenses for API-enabled Protection"></link><link rel="next" href="configure-microsoft-office-365-onedrive-for-api-enabled-protection-159895.html#UUID-820b870c-7fcf-7885-82d7-354e343fc437_section-5ccba270a87e1-idm45444641705744" title="Prerequisites"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script type="text/javascript">var propertyid = '256425220';

						(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
						(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
						m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
						})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
						
						ga('create', propertyid, 'auto');
						ga('send', 'pageview');
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="network-security.html">Network Security</a></li><li class="breadcrumb-link"><a href="api-enabled-protection.html"><span class="phrase">API-enabled Protection</span></a></li><li class="breadcrumb-link"><a href="api-enabled-protection-for-microsoft-office-365-onedrive.html"><span class="phrase">API-enabled Protection</span> for Microsoft Office 365 OneDrive</a></li><li class="breadcrumb-link"><a href="configure-microsoft-office-365-onedrive-for-api-enabled-protection.html">Configure Microsoft Office 365 OneDrive for <span class="phrase">API-enabled Protection</span></a></li><li class="breadcrumb-node">Configure Microsoft Office 365 <span class="phrase">OneDrive</span> for <span class="phrase">API-enabled Protection</span></li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="supported-microsoft-office-365-licenses-for-api-enabled-protection.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-microsoft-office-365-onedrive-for-api-enabled-protection-159895.html#UUID-820b870c-7fcf-7885-82d7-354e343fc437_section-5ccba270a87e1-idm45444641705744">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-f38e8b84-7d00-3f67-c902-079a1efad8bf" data-permalink="configure-microsoft-office-365-onedrive-for-api-enabled-protection-159895.html" data-topic-level="1" data-relative-prefix="" data-time-modified="July 8, 2020" data-publication-date="" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437"><div class="titlepage"><div><div class="title"><h6 class="title">Configure Microsoft Office 365 <span class="phrase">OneDrive</span> for <span class="phrase">API-enabled Protection</span></h6></div></div></div><p>To configure Microsoft Office 365 <span class="phrase">OneDrive</span> for <span class="phrase">API-enabled Protection</span>, you need to install the Netskope Introspection v2 app to access your Microsoft Office 365 account, and then create a Microsoft Office 365 <span class="phrase">OneDrive</span> app instance in the Netskope UI.</p><p>There are three parts to this procedure:</p><div class="itemizedlist" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437_itemizedlist-idm43113698005536"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Remove the Netskope Introspection v1 app.</p><div dir="ltr" class="important" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437_important-idm43165578785352"><h3 class="title">Important</h3><p>This procedure is applicable to customers who have installed the Netskope Introspection v1 app. Skip this procedure if you have not installed the v1 app.</p></div></li><li class="listitem"><p>Add the Netskope Introspection v2 app in your Office 365 SharePoint admin account.</p></li><li class="listitem"><p>Configure Netskope to access your Microsoft Office 365 <span class="phrase">OneDrive</span> app.</p></li></ul></div><div dir="ltr" class="important" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437_important-idm43113698454306"><h3 class="title">Important</h3><p>Throughout this article, you will be prompted to enter your Office 365 credentials. Netskope does not store your Office 365 credentials. The credentials are used for creating OAuth tokens. Netskope only stores these tokens and not the actual credentials.</p></div><section dir="ltr" class="section" data-origin-id="" data-publication-date="" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437_section-5ccba270a87e1-idm45444641705744"><div class="titlepage"><div><div class="title"><h6 class="title">Prerequisites</h6></div></div></div><p>To grant Office 365 access for audit logs, following prerequisites must be met:</p><div class="itemizedlist" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437_itemizedlist-idm43113698570282"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A global administrator account is required to grant access to Netskope. Post-grant, this account is not required for policy processing.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>The way permissions work in Azure/Office 365 is that Netskope requires an administrator to grant enough privileges for Netskope to perform specific actions. Note that the Netskope app does not receive global admin permissions. It only receives permissions for the scope Netskope requests for.</p><p>In particular, the global admin is the only user that can delegate access for application-level permission (as opposed to user level permissions). You can find additional Microsoft documentation on how all these work <a class="link" href="https://developer.microsoft.com/en-us/graph/docs/concepts/permissions_reference" target="_blank" rel="noopener">here</a>. Furthermore, global admin credential is required for Graph and Office 365 Management APIs. Post-grant, Netskope is independent of the granting account for policy processing.</p></div></li><li class="listitem"><p>You must turn on audit logging in Microsoft 365 admin center. To enable audit logging, log in to admin.microsoft.com and navigate to <span class="bold bold"><strong>Admin &gt; Admin centers &gt; Security &gt; Search &gt; Audit log search</strong></span>. On the <span class="bold bold"><strong>Audit log search</strong></span> page, click <span class="bold bold"><strong>Start recording user and admin activity</strong></span>.</p><div dir="ltr" class="note"><h3 class="title">Note</h3><p>If you do not see this link, auditing has already been turned on for your organization. After you turn it on, a message is displayed that says the audit log is being prepared and that you can run a search in a couple of hours after the preparation is complete. You only have to do this once. For additional information, read this <a class="link" href="https://docs.microsoft.com/en-in/office365/securitycompliance/search-the-audit-log-in-security-and-compliance" target="_blank" rel="noopener">support article</a> on the Microsoft site.</p></div></li></ul></div><p>Adding the Netskope Introspection v2 app to your SharePoint admin account has these requirements:</p><div class="itemizedlist" id="UUID-820b870c-7fcf-7885-82d7-354e343fc437_itemizedlist-idm43113698682054"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Installation of the Netskope Introspection v2 app in your Office 365 SharePoint admin account requires the global administrator role in Office 365. For additional details, to assign admin roles in Office 365, refer to this <a class="link" href="https://support.office.com/en-nz/article/Assigning-admin-roles-in-Office-365-eac4d046-1afd-4f1a-85fc-8219c79e1504?ui=en-US&amp;rs=en-NZ&amp;ad=NZ" target="_blank" rel="noopener">Microsoft Office 365 document</a>.</p></li><li class="listitem"><p>The admin account used to upload the Netskope Introspection v2 app must be added to the Site Collection Administrator.</p></li><li class="listitem"><p>It is important to note that although the Netskope Introspection v2 app is installed through the SharePoint store, the Netskope Introspection v2 app instructions apply to OneDrive and SharePoint apps.</p></li><li class="listitem"><p>In a multi-geo setup, if you intend to monitor a single location, you should install the Netskope Introspection v2 app in that location.</p></li><li class="listitem"><p>The Netskope Introspection v2.0 app requires the following scopes for it to be installed in the Office 365 account:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><thead><tr><th class="th" data-priority="1"><p>Scope</p></th><th class="th" data-priority="1"><p>Description</p></th><th class="th" data-priority="1"><p>Permission</p></th></tr></thead><tbody><tr><td class="td"><p>Social</p></td><td class="td"><p>To retrieve user profiles.</p></td><td class="td"><p>Full control</p></td></tr><tr><td class="td"><p>Tenancy</p></td><td class="td"><p>The tenancy where the add-in is installed. Includes all children of this scope.</p></td><td class="td"><p>Full control</p></td></tr><tr><td class="td"><p>Site collection</p></td><td class="td"><p>The site collection where the add-in is installed. Includes all children of this scope.</p></td><td class="td"><p>Full control</p></td></tr><tr><td class="td"><p>Website</p></td><td class="td"><p>The website where the add-in is installed. Includes all children of this scope.</p></td><td class="td"><p>Manage</p></td></tr><tr><td class="td"><p>List</p></td><td class="td"><p>List on the website where the add-in is installed.</p></td><td class="td"><p>Manage</p></td></tr></tbody></table></div></li><li class="listitem"><p>The Netskope Introspection v2.0 app requires the following permission privileges:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><thead><tr><th class="th" data-priority="1"><p>Permission Request</p></th><th class="th" data-priority="1"><p>Description</p></th><th class="th" data-priority="1"><p>Permission Included</p></th></tr></thead><tbody><tr><td class="td"><p>Read-only</p></td><td class="td"><p>Enables apps to view pages, list items, and download documents.</p></td><td class="td"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>View items</p></li><li class="listitem"><p>Open items</p></li><li class="listitem"><p>View versions</p></li><li class="listitem"><p>Create alerts</p></li><li class="listitem"><p>Use self-service site creation</p></li><li class="listitem"><p>View pages</p></li></ul></div></td></tr><tr><td class="td"><p>Write</p></td><td class="td"><p>Enables apps to view, add, update, and delete items in existing lists and document libraries.</p></td><td class="td"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Read-only permissions, and:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>Add items</p></li><li class="listitem"><p>Edit items</p></li><li class="listitem"><p>Delete items</p></li><li class="listitem"><p>Delete versions</p></li><li class="listitem"><p>Browse directories</p></li><li class="listitem"><p>Edit personal user information</p></li><li class="listitem"><p>Manage personal views</p></li><li class="listitem"><p>Add/remove personal web parts</p></li><li class="listitem"><p>Update personal web parts</p></li></ul></div></li></ul></div></td></tr><tr><td class="td"><p>Manage</p></td><td class="td"><p>Enables apps to view, add, update, delete, approve, and customize items or pages within a web site.</p></td><td class="td"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><p>Write permissions, and:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: square; "><li class="listitem"><p>Manage lists</p></li><li class="listitem"><p>Apply themes and borders</p></li><li class="listitem"><p>Apply style sheets</p></li></ul></div></li></ul></div></td></tr><tr><td class="td"><p>Full control</p></td><td class="td"><p>Enables apps to have full control within the specified scope.</p></td><td class="td"><p>All permissions</p></td></tr></tbody></table></div></li></ul></div></section></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><aside class="section-nav-container"><ul class="section-nav nav"><li><a href="#UUID-820b870c-7fcf-7885-82d7-354e343fc437">Configure Microsoft Office 365 OneDrive for API-enabled Protection</a></li><li><a href="#UUID-820b870c-7fcf-7885-82d7-354e343fc437_section-5ccba270a87e1-idm45444641705744">Prerequisites</a></li></ul></aside><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Configure%20Microsoft%20Office%20365%20OneDrive%20for%20API-enabled%20Protection%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Configure%20Microsoft%20Office%20365%20OneDrive%20for%20API-enabled%20Protection%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="supported-microsoft-office-365-licenses-for-api-enabled-protection.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="configure-microsoft-office-365-onedrive-for-api-enabled-protection-159895.html#UUID-820b870c-7fcf-7885-82d7-354e343fc437_section-5ccba270a87e1-idm45444641705744">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">July 8, 2020</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
