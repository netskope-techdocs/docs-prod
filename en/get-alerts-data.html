<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en" dir="ltr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<meta http-equiv="x-ua-compatible" content="IE=edge"></meta><meta name="format-detection" content="telephone=no"></meta><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"></meta><meta name="search" content="default"></meta><meta name="use.ic" content="no"></meta><meta name="tocstandalone" content="yes"></meta><meta name="theme" content="1"></meta><meta name="search.placeholder" content="Search"></meta><meta name="search.results" content="Search results"></meta><meta name="no.search.results" content="No results found"></meta><script type="text/javascript">
var theme = '1';

			
			var versionsfile = '';


			var indexDict = new Array();
			var store = {};
			var portalLanguage = 'en';
			var enterKey = 'select';
			
			
				var fuse_threshold = 0.3;
			
					var local_csh = false;
				
					var anchoroption = true;
				
			
			var useanchorlinks = false;
			
				useanchorlinks = true;
				
				var clicktocopy = 'Click to copy link';
				var linkcopied =  'Copied!';</script><title>Get Alerts Data</title><link rel="stylesheet" type="text/css" href="../css/docbook.css"></link><link rel="stylesheet" type="text/css" href="../css/font-awesome.css"></link><link rel="stylesheet" type="text/css" href="../css/roboto.font.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1.css"></link><link rel="stylesheet" type="text/css" href="../css/theme1-colors.css"></link><link rel="stylesheet" type="text/css" href="../css/content-theme2.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-core-css.css"></link><link rel="stylesheet" type="text/css" href="../css/sm-simple.css"></link><link rel="stylesheet" type="text/css" href="../css/style-print.css"></link><link rel="stylesheet" type="text/css" href="../css/style-common.css"></link><link rel="stylesheet" type="text/css" href="../css/style-modern-tables.css"></link><link rel="stylesheet" type="text/css" href="../css/rwd-table.min.css"></link><link rel="stylesheet" type="text/css" href="../css/graphical-lists.css"></link><link rel="stylesheet" type="text/css" href="../css/layout-custom-style.css"></link><script src="../js/jquery-3/jquery-3.4.1.min.js" type="text/javascript"></script><script src="../js/jquery-migrate-3.0.1.min.js" type="text/javascript"></script><script src="../js/materialize.min.js" type="text/javascript"></script><script src="../js/bootstrap.min.js" type="text/javascript"></script><script src="../js/purl.js" type="text/javascript"></script><script src="../js/jquery.smartmenus.js" type="text/javascript"></script><script src="js/toc.js" type="text/javascript"></script><script src="../js/create-toc.js" type="text/javascript"></script><script src="../js/html5-2-mp-common.js" type="text/javascript"></script><script src="../js/html5-2.js" type="text/javascript"></script><script src="../js/checklist.js" type="text/javascript"></script><script src="../js/rwd-table.min.js" type="text/javascript"></script><script src="../js/responsive-tables.js" type="text/javascript"></script><script src="../js/clipboard.min.js" type="text/javascript"></script><script src="../js/anchorlinks.js" type="text/javascript"></script><script src="../js/lunr.js" type="text/javascript"></script><script src="../js/jquery.mark.min.js" type="text/javascript"></script><script src="js/data.js" type="text/javascript"></script><script src="../js/search.js" type="text/javascript"></script><script src="../js/csh.js" type="text/javascript"></script><script src="../js/layout-custom-script.js" type="text/javascript"></script><meta name="generator" content="Paligo"></meta><link rel="prev" href="rest-api.html" title="Netskope Platform API Endpoints"></link><link rel="next" href="get-events-data.html" title="Get Events Data"></link><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML" async="async"></script><link rel="icon" href="/favicon.ico" type="image/x-icon"></link><script async="" src="https://www.googletagmanager.com/gtag/js?id=256425220"></script><script type="text/javascript">var propertyid = '256425220';

						window.dataLayer = window.dataLayer || [];
						function gtag(){dataLayer.push(arguments)};
						gtag('js', new Date());
						
						gtag('config', propertyid);
					</script><script type="text/javascript">
				$(document).ready(function () {
				$(".mediaobject img").addClass('materialboxed');
				//Exclude images with links
				$(".mediaobject a img").removeClass('materialboxed');
				if (!document.documentMode) {
				$('.materialboxed').materialbox();
				}});
			</script></head><body class="theme1 fixed-toolbar colored-top page-toc current-toc-section-focus" data-spy="scroll" data-target=".section-nav-container" data-offset="100" data-link-prefix=""><header class="site-header"><nav class="site-header-navbar navbar navbar-fixed-top"><div class="navbar-container"><div class="navbar-header"><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><div id="logotype-container" class="pull-left"><a class="navbar-brand" href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div></div><div id="navbar" class="navbar-collapse collapse"></div></div></nav></header><div class="site-body"><div class="site-body-container"><div class="site-body-row"><aside class="site-sidebar"><div class="site-sidebar-header"><button type="button" class="navbar-toggle" aria-controls="nav-site-sidebar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="../index.html?lang=en"><img id="logotype-pageheader" src="../css/image/corporate-logo.png" alt="Corporate logotype" data-role="logotype" class="logo"></img></a></div><form class="site-sidebar-search" autocomplete="off"><input type="text" class="form-control search-field" placeholder="Search" id="aa-search-input"></input></form><div id="toc-standalone-placeholder"></div></aside><div class="site-content"><h1 class="publication-title">Netskope Help</h1><div class="toolbar"><div class="toolbar-tools"><div id="navbar" class="navbar-collapse collapse"></div><div class="tool-print print-icon"><a onclick="window.print();return false;"><i class="fa fa-print" aria-hidden="true"><span class="print-text">print</span></i></a></div><div class="tool-search"><i class="fa fa-search" aria-hidden="true"></i></div><button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".site-sidebar" aria-expanded="false" aria-controls="navbar"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button></div><div class="breadcrumb-container"><ul class="breadcrumb"><li class="breadcrumb-link"> <a href="index-en.html">Netskope Help</a></li><li class="breadcrumb-link"><a href="admin-console.html">Admin Console</a></li><li class="breadcrumb-link"><a href="skopeit.html">SkopeIT</a></li><li class="breadcrumb-link"><a href="netskope-rest-apis.html">Netskope REST APIs</a></li><li class="breadcrumb-link"><a href="rest-api.html">Netskope Platform API Endpoints</a></li><li class="breadcrumb-node">Get Alerts Data</li></ul></div></div><main><div id="top-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="rest-api.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="get-events-data.html">Next</a></li></ul></div><article class="topic content-container" id="content-wrapper"><div id="topic-content" class="topic-content"><section xml:lang="en" lang="en" dir="ltr" class="section" data-origin-id="UUID-fbce78ba-8b91-fed2-8720-39d05c221d9d" data-permalink="get-alerts-data.html" data-topic-level="1" data-relative-prefix="" data-time-modified="December 10, 2020" data-publication-date="" id="UUID-60905716-b326-f957-138b-bdf670e877bd"><div class="titlepage"><div><div class="title"><h6 class="title">Get Alerts Data</h6></div></div></div><p>This endpoint returns alerts generated by Netskope, including policy, DLP, and watch list alerts. Policy alerts are triggered when traffic matches policy. DLP alerts are generated when there is a DLP violation triggered by the policy. Watch list alerts are triggered when watchlist matches.</p><h7 id="UUID-60905716-b326-f957-138b-bdf670e877bd_bridgehead-5c93c9b6b981c-idm46719506934496" class="bridgehead">Request Endpoint</h7><pre class="programlisting">GET https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>.goskope.com/api/v1/alerts</pre><p>Valid query parameters are:</p><div class="informaltable table-responsive"><table class="informaltable frame-box rules-all"><colgroup><col style="width:25%;"></col><col style="width:25%;"></col><col style="width:50%;"></col></colgroup><thead><tr><th class="th" data-priority="1"><p>Key</p></th><th class="th" data-priority="1"><p>Value</p></th><th class="th" data-priority="1"><p>Description</p></th></tr></thead><tbody><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">query</code></p></td><td class="td"><p>Valid alert query.</p><p>Examples:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p><code class="literal">query=compliance_standards.standard%20eq%20%27CSA-CCM-3.0.1%27%29</code></p><p>See Example Requests with Responses below to see how single and multiple compliance values are used inside the query parameter.</p></li><li class="listitem"><p><code class="literal">query=alert_type%20in%20%5B%20'anomaly',%20'Compromised%20Credential'%20%5D</code></p></li><li class="listitem"><p><code class="literal">￼query=alert_name%20like%20'test'</code></p></li><li class="listitem"><p><code class="literal">query=action%20in%20%5B%20'alert'%20%5D</code></p></li></ul></div></td><td class="td"><p>This acts as a filter for all the cloud app alerts in the events database.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">type</code></p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">anomaly</code> | <code class="literal">'Compromised Credential'</code> | <code class="literal">policy</code> | <code class="literal">'Legal Hold'</code> | <code class="literal">malsite</code> | <code class="literal">Malware</code> | <code class="literal">DLP</code> | <code class="literal">'Security Assessment'</code> | <code class="literal">watchlist</code> | <code class="literal">quarantine</code> | <code class="literal">Remediation</code>  | <code class="literal">uba</code></p></td><td class="td"><p>Selects Policy, DLP, Quarantine, Watchlist, etc. alerts. If nothing is passed, then it gets alerts of all types.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">acked</code></p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">true | false</code></p></td><td class="td"><p>Selects the type of alerts. If nothing is passed, then it gets alerts of all types.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">timeperiod</code></p></td><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">3600 | 86400 | 604800 | 2592000</code></p></td><td class="td"><p>Last 60 mins | Last 24 Hrs | Last 7 Days | Last 30 Days | Last 60 days | Last 90 days</p><p>Only use one of these parameters at a time, not a combination: <code class="literal">timeperiod</code>, or <code class="literal">starttime/endtime</code>, or <code class="literal">insertionstarttime/insertionendtime</code>.</p></td></tr><tr><td class="td"><p><code class="literal">starttime</code></p></td><td class="td"><p>Unix epoch time</p></td><td class="td"><p>Restrict alerts to those that have timestamps greater than this. Needed only if <code class="literal">timeperiod</code> or <code class="literal">insertionstarttime/insertionendtime</code> is not passed.</p><p>Only use one of these parameters at a time, not a combination: <code class="literal">timeperiod</code>, or <code class="literal">starttime/endtime</code>, or <code class="literal">insertionstarttime/insertionendtime</code>.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">endtime</code></p></td><td class="td"><p>Unix epoch time</p></td><td class="td"><p>Restrict alerts to those that have timestamps less than or equal to this. Needed only if <code class="literal">timeperiod</code> or <code class="literal">insertionstarttime/insertionendtime</code>is not passed.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">insertionstarttime</code></p></td><td class="td"><p>Unix epoch time</p></td><td class="td"><p>Restrict alerts which have been inserted into the database after the specified time. Needed only if <code class="literal">timeperiod</code> or <code class="literal">starttime/endtime</code> is not passed.</p><p>Only use one of these parameters at a time, not a combination: <code class="literal">timeperiod</code>, or <code class="literal">starttime/endtime</code>, or <code class="literal">insertionstarttime/insertionendtime</code>.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">insertionendtime</code></p></td><td class="td"><p>Unix epoch time</p></td><td class="td"><p>Restrict alerts which have been inserted into the database before the specified time. Needed only if <code class="literal">timeperiod</code> or <code class="literal">starttime/endtime</code> is not passed.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">limit</code></p></td><td class="td"><p>Positive integer less than 5000</p></td><td class="td"><p>REST API responses can return up to 5000 alerts in a single response. You can use pagination to retrieve more results.</p></td></tr><tr><td class="td"><p><code xml:lang="en" lang="en" dir="ltr" class="literal">skip</code></p></td><td class="td"><p>Positive integer</p></td><td class="td"><p>Skip over some of the alerts (useful for pagination in combination with <code class="literal">limit</code>).</p></td></tr><tr><td class="td"><p><code class="literal">unsorted</code></p></td><td class="td"><p><code class="literal">true | false</code></p></td><td class="td"><p>If <code class="literal">true</code>, the returned data will not be sorted (useful for improved performance).</p></td></tr></tbody></table></div><h7 id="UUID-60905716-b326-f957-138b-bdf670e877bd_bridgehead-5c93c9ccb03be-idm46635291226528" class="bridgehead">Response</h7><p>For response information, refer to <a class="xref" href="rest-api-events-and-alerts-response-descriptions.html" title="REST API Events and Alerts Response Descriptions"><span class="xreftitle">REST API Events and Alerts Response Descriptions</span></a>.</p><h7 id="UUID-60905716-b326-f957-138b-bdf670e877bd_bridgehead-5c93ca101defd-idm46449957311744" class="bridgehead">Example Requests with Responses</h7><p><span class="bold bold"><strong>Filter by single Compliance Standard</strong></span>:</p><pre class="programlisting">curl -X GET 'https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>/api/v1/alerts?token=5f8a08f99d40d9b0130dd43798d7dey4x&amp;timeperiod=86400&amp;type=Security%20Assessment&amp;limit=1&amp;stimeperiod=2592000&amp;token=51400d9d84feb86c1ce758ac405e8a84&amp;query=%28compliance_standards.standard%20eq%20%27CSA-CCM-3.0.1%27%29

{
    "alert_type": "Security Assessment",
    "region_id": "westeurope",
    "sa_profile_name": "CIS Azure Foundations Benchmark v1.0.0",
    "app": "Microsoft Azure",
    "object_type": "Instance",
    "compliance_standards": [
        {
            "control": "02",
            "description": "Security Incident Management, E-Discovery, &amp; Cloud Forensics: Incident Management | Policies and procedures shall be established, and supporting business processes and technical measures implemented, to triage security-related events and ensure timely and thorough incident management, as per established IT service management policies and procedures.",
            "section": "SEF",
            "standard": "CSA-CCM-3.0.1",
            "reference_url": "https://cloudsecurityalliance.org/research/cloud-controls-matrix/",
            "id": -91402
        }
    ],
    "account_name": "iaas-qe",
    "region_name": "West Europe",
    "category": "IaaS/PaaS",
    "timestamp": 1603870162,
    "sa_profile_id": -2001000,
    "sa_rule_id": -2067,
    "iaas_remediated": "false",
    "access_method": "API Connector",
    "policy": "azure_81_policy",
    "sa_rule_name": "Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers",
    "type": "nspolicy",
    "account_id": "e3813397-1fff-46b0-a59f-5c2130aac115",
    "iaas_asset_tags": [],
    "sa_rule_severity": "High",
    "object": "automation1603868619",
    "alert": "yes",
    "user": "admin@netskope.com",
    "device": "other",
    "count": 1,
    "asset_object_id": "016044c5aeb1bf9c3af75357",
    "instance_id": "azure80",
    "alert_name": "Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers",
    "activity": "Introspection Scan",
    "action": "alert",
    "browser": "unknown",
    "os": "unknown",
    "resource_category": "Database",
    "policy_id": 2,
    "organization_unit": "",
    "userkey": "admin@netskope.com",
    "ur_normalized": "admin@netskope.com",
    "site": "Windows Azure",
    "traffic_type": "CloudApp",
    "ccl": "excellent",
    "acked": "false",
    "_insertion_epoch_timestamp": 1603967916,
    "_id": "d3a03deeb9ec657d18f48a43",
    "cci": 96,
    "sa_rule_remediation": "&lt;html&gt;\n\t&lt;body&gt;\n\t    &lt;b&gt;Azure Console:&lt;/b&gt;\n        &lt;ol&gt;\n            &lt;li&gt;Go to &lt;code&gt;SQL servers&lt;/code&gt;&lt;/li&gt;\n            &lt;li&gt;For each server instance&lt;/li&gt;\n            &lt;li&gt;Click on &lt;code&gt;Auditing &amp; Threat Detection&lt;/code&gt;&lt;/li&gt;\n            &lt;li&gt;Set &lt;code&gt;Send alerts to&lt;/code&gt; as appropriate&lt;/li&gt;\n        &lt;/ol&gt;\n        \n        &lt;b&gt;Azure PowerShell:&lt;/b&gt;\n        &lt;p&gt;\n            Get the list of all SQL Servers&lt;br&gt;\n            &lt;code&gt;&lt;pre&gt;\n    Get-AzureRmSqlServer\n            &lt;/pre&gt;&lt;/code&gt;\n            For each Server, set &lt;code&gt;Send alerts to&lt;/code&gt;.&lt;br&gt;\n            &lt;code&gt;&lt;pre&gt;\n    Set-AzureRmSqlServerThreatDetectionPolicy -ResourceGroupName &amp;lt;resource group name&amp;gt; -ServerName &amp;lt;server name&amp;gt; -NotificationRecipientsEmails \"&amp;lt;Recipient Email ID&amp;gt;\"\n            &lt;/pre&gt;&lt;/code&gt;\n        &lt;/p&gt;\n        \n        &lt;b&gt;Default Value:&lt;/b&gt;&lt;br&gt;\n        &lt;p&gt;\n            By default, &lt;code&gt;Send alerts to&lt;/code&gt; is not set.\n        &lt;/p&gt;\n\t&lt;/body&gt;\n&lt;/html&gt;\n",
    "appcategory": "IaaS/PaaS"
}  </pre><p><span class="bold bold"><strong>Filter by multiple Compliance Standards</strong></span>:</p><pre class="programlisting">curl -X GET 'https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>/api/v1/alerts?token=5f8a08f99d40d9b0130dd43798d7dey4x&amp;timeperiod=2592000&amp;token=51400d9d84feb86c1ce758ac405e8a84&amp;query=%28compliance_standards.standard%20in%20%5B%27CSA-CCM-3.0.1%27%2C%20%27NIST-CSF-1.1%27%2C%20%27CIS-AZRFND-1.0.0%27%5D%29

{
  "alert_type": "Security Assessment",
  "region_id": "westeurope",
  "sa_profile_name": "CIS Azure Foundations Benchmark v1.0.0",
  "app": "Microsoft Azure",
  "object_type": "Instance",
  "compliance_standards": [
      {
          "control": "02",
          "description": "Security Incident Management, E-Discovery, &amp; Cloud Forensics: Incident Management | Policies and procedures shall be established, and supporting business processes and technical measures implemented, to triage security-related events and ensure timely and thorough incident management, as per established IT service management policies and procedures.",
          "section": "SEF",
          "standard": "CSA-CCM-3.0.1",
          "reference_url": "https://cloudsecurityalliance.org/research/cloud-controls-matrix/",
          "id": -91402
      },
      {
          "control": "1",
          "description": "Personnel know their roles and order of operations when a response is needed",
          "section": "RS.CO",
          "standard": "NIST-CSF-1.1",
          "reference_url": "https://nvlpubs.nist.gov/nistpubs/CSWP/NIST.CSWP.04162018.pdf",
          "id": -7701
      },
      {
          "control": "1.4",
          "description": "Ensure that 'Send alerts to' is set",
          "appname": "azure",
          "section": "4",
          "standard": "CIS-AZRFND-1.0.0",
          "reference_url": "https://www.cisecurity.org/benchmark/azure/",
          "id": -5414
      }
  ],
  "account_name": "iaas-qe",
  "region_name": "West Europe",
  "category": "IaaS/PaaS",
  "timestamp": 1603870162,
  "sa_profile_id": -2001000,
  "sa_rule_id": -2067,
  "iaas_remediated": "false",
  "access_method": "API Connector",
  "policy": "azure_81_policy",
  "sa_rule_name": "Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers",
  "type": "nspolicy",
  "account_id": "e3813397-1fff-46b0-a59f-5c2130aac115",
  "iaas_asset_tags": [],
  "sa_rule_severity": "High",
  "object": "automation1603868619",
  "alert": "yes",
  "user": "admin@netskope.com",
  "device": "other",
  "count": 1,
  "asset_object_id": "016044c5aeb1bf9c3af75357",
  "instance_id": "azure80",
  "alert_name": "Personnel know response roles/operations: Ensure that 'Send Alerts to' is set for SQL Servers",
  "activity": "Introspection Scan",
  "action": "alert",
  "browser": "unknown",
  "os": "unknown",
  "resource_category": "Database",
  "policy_id": 2,
  "organization_unit": "",
  "userkey": "admin@netskope.com",
  "ur_normalized": "admin@netskope.com",
  "site": "Windows Azure",
  "traffic_type": "CloudApp",
  "ccl": "excellent",
  "acked": "false",
  "_insertion_epoch_timestamp": 1603967916,
  "_id": "d3a03deeb9ec657d18f48a43",
  "cci": 96,
  "sa_rule_remediation": "&lt;html&gt;\n\t&lt;body&gt;\n\t    &lt;b&gt;Azure Console:&lt;/b&gt;\n        &lt;ol&gt;\n            &lt;li&gt;Go to &lt;code&gt;SQL servers&lt;/code&gt;&lt;/li&gt;\n            &lt;li&gt;For each server instance&lt;/li&gt;\n            &lt;li&gt;Click on &lt;code&gt;Auditing &amp; Threat Detection&lt;/code&gt;&lt;/li&gt;\n            &lt;li&gt;Set &lt;code&gt;Send alerts to&lt;/code&gt; as appropriate&lt;/li&gt;\n        &lt;/ol&gt;\n        \n        &lt;b&gt;Azure PowerShell:&lt;/b&gt;\n        &lt;p&gt;\n            Get the list of all SQL Servers&lt;br&gt;\n            &lt;code&gt;&lt;pre&gt;\n    Get-AzureRmSqlServer\n            &lt;/pre&gt;&lt;/code&gt;\n            For each Server, set &lt;code&gt;Send alerts to&lt;/code&gt;.&lt;br&gt;\n            &lt;code&gt;&lt;pre&gt;\n    Set-AzureRmSqlServerThreatDetectionPolicy -ResourceGroupName &amp;lt;resource group name&amp;gt; -ServerName &amp;lt;server name&amp;gt; -NotificationRecipientsEmails \"&amp;lt;Recipient Email ID&amp;gt;\"\n            &lt;/pre&gt;&lt;/code&gt;\n        &lt;/p&gt;\n        \n        &lt;b&gt;Default Value:&lt;/b&gt;&lt;br&gt;\n        &lt;p&gt;\n            By default, &lt;code&gt;Send alerts to&lt;/code&gt; is not set.\n        &lt;/p&gt;\n\t&lt;/body&gt;\n&lt;/html&gt;\n",
  "appcategory": "IaaS/PaaS"
}</pre><h7 id="UUID-60905716-b326-f957-138b-bdf670e877bd_bridgehead-idm232147279544014" class="bridgehead">Filter by Type</h7><pre class="programlisting">curl -X GET 'https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>/api/v1/alerts?token=5f8a08f99d40d9b0130dd43798d7dey4x&amp;timeperiod=86400&amp;type=Security%20Assessment&amp;limit=1&amp;skip=0&amp;ack=false'

{
   "msg" : "",
   "data" : [
      {
         "app" : "Amazon Web Services",
         "alert_name" : "CIS AWS Foundations Benchmark v1.2.0",
         "instance_id" : "aws61",
         "device" : "other",
         "ccl" : "excellent",
         "browser" : "unknown",
         "organization_unit" : "",
         "access_method" : "API Connector",
         "_session_begin" : 1,
         "sa_profile_name" : "CIS AWS Foundations Benchmark v1.2.0",
         "acked" : "false",
         "_id" : "1c248c457f5c2f2fb8b221f5",
         "type" : "nspolicy",
         "account_name" : "aws61",
         "alert_type" : "Security Assessment",
         "timestamp" : 1551713762,
         "activity" : "Introspection Scan",
         "object_type" : "Policy",
         "compliance_standards": [
        {
            "control": "02",
            "description": "Security Incident Management, E-Discovery, &amp; Cloud Forensics",
            "section": "SEF",
            "standard": "CSA-CCM-3.0.1",
            "reference_url": "https://cloudsecurityalliance.org/research/cloud-controls-matrix/",
            "id": -91402
        }
 ],
         "user" : "meghana@netskope.com",
         "alert" : "yes",
         "userkey" : "meghana@netskope.com",
         "sa_rule_remediation" : "&lt;html&gt;\n&lt;body&gt;\n    &lt;b&gt;Using the Amazon unified command line interface:&lt;/b&gt;\n    &lt;ol&gt;\n        &lt;li&gt;Create an IAM role for managing incidents with AWS:\n            &lt;ul style='list-style-type: circle;'&gt;\n                &lt;li&gt;Create a trust relationship policy document that allows &amp;lt;iam_user&amp;gt; to manage AWS incidents, and save it locally as /tmp/TrustPolicy.json:&lt;/li&gt;\n                &lt;li&gt;\n                    &lt;code&gt;\n                            {\n                                'Version': '2012-10-17',\n                                'Statement': [\n                                                {\n                                                    'Effect': 'Allow',\n                                                    'Principal': { 'AWS': '&amp;lt;iam_user&amp;gt;'\n                                                    },\n                                                    'Action': 'sts:AssumeRole'\n                                                }\n                                            ]\n                            }\n                    &lt;/code&gt;\n                &lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n            &lt;ul style='list-style-type: circle;'&gt;\n                &lt;li&gt;Create the IAM role using the above trust policy:&lt;/li&gt;\n                &lt;li&gt;aws iam create-role --role-name &amp;lt;aws_support_iam_role&amp;gt; --assume-role- policy-document file:///tmp/TrustPolicy.json&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n        &lt;li&gt;\n            &lt;ul style='list-style-type: circle;'&gt;\n                &lt;li&gt;Attach 'AWSSupportAccess' managed policy to the created IAM role:&lt;/li&gt;\n                &lt;li&gt;aws iam attach-role-policy --policy-arn &amp;lt;iam_policy_arn&amp;gt; --role-name &amp;lt;aws_support_iam_role&amp;gt;&lt;/li&gt;\n            &lt;/ul&gt;\n        &lt;/li&gt;\n    &lt;/ol&gt;\n    &lt;p&gt;\n    &lt;b&gt;Impact&lt;/b&gt;&lt;br&gt;\n        All AWS Support plans include an unlimited number of account and billing support cases,\n        with no long-term contracts.&lt;br&gt;\n        Support billing calculations are performed on a per-account basis for all plans. Enterprise\n        Support plan customers have the option to include multiple enabled accounts in an\n        aggregated monthly billing calculation.&lt;br&gt;\n        Monthly charges for the Business and Enterprise support plans are based on each month's\n        AWS usage charges, subject to a monthly minimum, billed in advance&lt;br&gt;\n   &lt;/p&gt; \n&lt;/body&gt;\n&lt;/html&gt;\n",
         "sa_rule_id" : -1001017,
         "sa_rule_name" : "CIS-AWSFND | 1.22 Ensure a support role has been created to manage incidents with AWS Support",
         "os" : "unknown",
         "resource_category" : "Identity",
         "object" : "arn:aws:iam::215406114230:policy/automation1551712932",
         "policy" : "aws61policy",
         "traffic_type" : "CloudApp",
         "count" : 1,
         "region_id" : "",
         "policy_id" : 3,
         "action" : "alert",
         "sa_rule_severity" : "2",
         "cci" : 94,
         "account_id" : "215406114230",
         "sa_profile_id" : -1001000,
         "site" : "Amazon Web Services",
         "appcategory" : null,
         "_insertion_epoch_timestamp" : 1551713763,
         "category" : null
      }
   ],
   "status" : "success"
}</pre><p><span class="bold bold"><strong>Query for DLP violations grouped by user</strong></span>:</p><pre class="programlisting">https://<span class="emphasis"><em>&lt;tenant-name&gt;</em></span>.goskope.com/api/v1/report?token=<span class="emphasis"><em>&lt;token&gt;</em></span>&amp;query=alert_type eq DLP&amp;type=alert&amp;groupby=user&amp;timeperiod=2592000</pre><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Set endpoint name as <code class="literal">report</code></p></li><li class="listitem"><p>Set <code class="literal">query=alert_type eq DLP</code> to query for DLP alerts</p></li><li class="listitem"><p>Set <code class="literal">type=alert to query</code> for DLP alerts</p></li><li class="listitem"><p>Set <code class="literal">groupby=user</code></p></li></ul></div></section><div class="footer-content"><div class="section-toc section-toc-after"><div class="section-toc-title">In this section<span class="section-toc-title-delimiter">: </span></div></div><div class="glossary-definitions"></div></div><footer></footer></div></article><article id="search-result-wrapper"><div class="search-container" style="display: none;"><h2>Search results</h2><ul class="searchresults"></ul><p class="noresults">No results found</p></div></article><div class="feedback-panel"><div id="email-feedback" class="no-voting toggle-feedback"><p><a href="mailto:techpubs@netskope.com?subject=Feedback%20for%20help%20topic%20%22Get%20Alerts%20Data%22&amp;body=%0A%09%09%09%09%0A%09%09%09%09%0A%09%09%09%09_______________________%0A%09%09%09%09%0A%09%09%09Please%20add%20your%20feedback%20above%20for%20topic%20%22Get%20Alerts%20Data%22%20in%20the%20publication%20%22Netskope%20Help%22."><i aria-hidden="true" class="fa fa-pencil-square-o feedbackicon"></i>Would you like to provide feedback? Just click here to suggest edits.</a></p></div></div></main><div id="bottom-pager"><ul class="pager"><li class="previous"><a accesskey="p" id="header-navigation-prev" class="pull-left prev visible-lg visible-md" href="rest-api.html">Prev</a></li><li class="next"><a accesskey="n" id="header-navigation-next" class="pull-right next visible-lg visible-md" href="get-events-data.html">Next</a></li></ul></div><footer class="site-footer"><div class="inner"><div class="copyright"> © 2021 Netskope </div><div class="date-modified"><span class="date-modified-text">Last modified: </span><span class="formatted-date">December 10, 2020</span></div><div class="publication-date"><span class="publication-date-text">Publication date</span><span class="pubdate-delimiter">: </span><span class="formatted-date"></span></div></div></footer></div></div></div></div></body></html>
