<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!--
<script src="jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="rules_styles.css">
-->
<style>
/* http://meyerweb.com/eric/tools/css/reset/
   v2.0 | 20110126
   License: none (public domain)
*/
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed,
figure, figcaption, footer, header, hgroup,
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure,
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}

/* Start Netskope styles */

h1 {font-size: 1.8em; font-family: Arial,sans-serif; margin: 1.2rem}
h2 {font-size: 1.6em; font-family: Arial,sans-serif; margin: 1.2rem}
body {font-family: Arial,sans-serif;}

table.rule_table {font-size: 90%}
td.code {font-family: monospace}
th {font-weight: bold; cursor: pointer; }
input { margin-left: 2px; margin-bottom: 5px; padding: 2px 3px; width: 300; }
.headerSortDown:after,
.headerSortUp:after{
    content: ' ';
    position: relative;
    left: 10px;
    border: 7px solid transparent;
}
.headerSortDown:after{
    top: 10px;
    border-top-color: silver;
}
.headerSortUp:after{
    bottom: 15px;
    border-bottom-color: silver;
}
.headerSortDown,
.headerSortUp{
    padding-left: 20px;
}

img[alt="Netskope"] {display:block; margin:1.2rem;}
.container {display: flex; flex-direction: row; padding: 1.5rem; position: fixed; top: 110;}
._TAB{ display: inline-block; width: 0.4rem; height: 0.1rem; border-top: 0.5rem solid transparent; border-bottom: 0.5rem solid transparent; border-left: 0.5rem solid rgba(125,125,125,0.40); margin-left: 1.4rem; margin-right: 0.1rem;}
.rule_keys {display:inline-block; margin:0.7rem; margin-top:0; padding-right:2.0rem}
.rule_keys>.rule_category:first-child{margin-top:0;}
.rule_keys ul {list-style: none;}
.rule_keys li {cursor: pointer;}
.rule_keys li:hover {background-color: rgba(255,131,0,0.39); }

img {position: fixed; top: 0}
h1 {position: fixed; top: 75}

.rule_tables {flex:3 1 0px;display:inline-block; height: calc(100vh - 110px - 1.5rem); overflow: scroll;}
.rule_tables table, .rule_tables th, .rule_tables td { border: 1px solid rgba(150,150,100,0.5);  }
.rule_tables table {table-layout: fixed; width:100%;}
.rule_tables th {background-color: rgba(180,180,180,0.2); padding:0.2rem;}
.rule_tables td {padding: 0.2rem;}

/* rule styles */
.rule_category, .rule_name {display:inline-block;float:none; padding-right:0.2rem;}
.rule_category {font-size:1.3em;width: 100%;background-color: rgba(180,180,180,0.2); margin:0.5rem 0 0.2rem 0;padding:0;}
.rule_category:before, .rule_category:after {display:inline-block; content:''; width:0.4rem;}
.rule_key {padding:0.3rem;padding-left: 1.5rem;}
.rule_key.active {background-color: #ff8300; color:#ffffff;}
.rule_name {width:100%; text-align: left;}
</style>

<title>AWS Predefined Rules</title>
</head>
<body>
  <img src="logo.png" alt="Netskope"/>
  <h1>AWS Predefined Rules</h1>
  <div class="container">
    <div class="rule_keys">
        <ul>
            
            <li class="rule_key" data-profile-name="BPR">
              <span class="rule_name">AWS Best Practices v1.0.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CCM">
              <span class="rule_name">CSA CCM v3.0.1</span>
            </li>
            
            <li class="rule_key" data-profile-name="CIS">
              <span class="rule_name">CIS AWS Foundations Benchmark v1.2.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CISv14">
              <span class="rule_name">CIS AWS Foundations Benchmark v1.4.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="FSBP">
              <span class="rule_name">AWS Foundational Security Best Practices</span>
            </li>
            
            <li class="rule_key" data-profile-name="GDPR">
              <span class="rule_name">GDPR 1996/679 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="HIPAA">
              <span class="rule_name">HIPAA 1996 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="ISO27K">
              <span class="rule_name">ISO 27002 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST">
              <span class="rule_name">NIST CSF v1.1 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST800-53">
              <span class="rule_name">NIST 800-53 r4 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="PCI">
              <span class="rule_name">PCI-DSS v3.2.1 (AWS)</span>
            </li>
            
            <li class="rule_key" data-profile-name="SOC2">
              <span class="rule_name">AICPA SOC2 TSC 2017 (AWS)</span>
            </li>
            
            <!--
            <li class="rule_key" data-profile-name="ALL">
              <span class="rule_name">All Rules</span>
            </li>
            -->
        </ul>
        <br><br>
        <!--
        -->
        &#x1F50D;<input type="text" id="search" placeholder="Type to search">
    </div>
    <div class="rule_tables">
      
        <table id="table" class="rule_table" data-profile-name="BPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="1">
            <!-- <td>1</td> -->
            <td>Ensure EC2 Instance does not have open DNS port</td>
            <td>DNS Port 53, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "udp") and ( FromPort lte 53 and ToPort gte 53 ) ] ] </td>
          </tr>
          
          <tr num="2">
            <!-- <td>2</td> -->
            <td>Ensure EC2 Instance does not have open MongoDB port</td>
            <td>MongoDB Port 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( (FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="3">
            <!-- <td>3</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in default Network ACL</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL should not have IsDefault eq true and Rules with [ RuleAction eq "allow" and Protocol eq "-1" and Egress eq False and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="4">
            <!-- <td>4</td> -->
            <td>Ensure EC2 Instance does not have open NFS port</td>
            <td>NFS Port 2049, 111 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","udp","tcp") and ( (FromPort lte 2049 and ToPort gte 2049) or (FromPort lte 111 and ToPort gte 111)) ] ] </td>
          </tr>
          
          <tr num="5">
            <!-- <td>5</td> -->
            <td>Ensure EC2 Instance does not have open SMTP port</td>
            <td>SMTP Port 25, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 25 and ToPort gte 25) ) ] ] </td>
          </tr>
          
          <tr num="6">
            <!-- <td>6</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in Network ACL which is associated with a subnet</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs. Network ACLs associated with subnets and VPCs should not allow all ingress traffic.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL where Subnets len( ) gt 0 should not have Rules with [ Egress eq False and RuleAction eq "allow" and Protocol eq "-1" and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="7">
            <!-- <td>7</td> -->
            <td>Ensure EC2 Instance does not have open UDP ports</td>
            <td>UDP Ports 22, 80, 443, 1433, 1521, 3306, 3389, 5432, 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "udp") and ( ( FromPort lte 22 and ToPort gte 22) or ( FromPort lte 80 and ToPort gte 80) or ( FromPort lte 443 and ToPort gte 443) or ( FromPort lte 1433 and ToPort gte 1433) or ( FromPort lte 1521 and ToPort gte 1521) or ( FromPort lte 3306 and ToPort gte 3306) or ( FromPort lte 3389 and ToPort gte 3389) or ( FromPort lte 5432 and ToPort gte 5432) or ( FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="8">
            <!-- <td>8</td> -->
            <td>Ensure SNS Topics do not have Policies containing AddPermission Action to all principals</td>
            <td>SNS Topic should not have Policy with Add Permission Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:AddPermission" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="9">
            <!-- <td>9</td> -->
            <td>Ensure CloudWatch alarm has at least one Action</td>
            <td>Each CloudWatch alarm should have at least one action</td>
            <td>
            
              CloudWatch<br>
            
            </td>
            <td class="code">MetricAlarm should have AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] </td>
          </tr>
          
          <tr num="10">
            <!-- <td>10</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect Allow and NotActions</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Effect eq "Allow" and ( NotAction len ( ) gt 0 or Action with [ value eq "*" ] ) ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="11">
            <!-- <td>11</td> -->
            <td>Ensure ChangeMessageVisibility Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have ChangeMessageVisibility action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action with [ value like "(?i)SQS:ChangeMessageVisibility" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="12">
            <!-- <td>12</td> -->
            <td>Access permissions and authorizations: Ensure Redshift Clusters are not Publicly accessible</td>
            <td>Redshift Clusters should not be accessible to the public.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Access eq "Public" </td>
          </tr>
          
          <tr num="13">
            <!-- <td>13</td> -->
            <td>Ensure Delete Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Delete action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action with [ value like "(?i)s3:Delete" or value like "(?i)S3:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="14">
            <!-- <td>14</td> -->
            <td>Ensure Delete Message Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have DeleteMessage action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ (Action with [ value like "(?i)SQS:DeleteMessage" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="15">
            <!-- <td>15</td> -->
            <td>Ensure SNS Topics do not have Policies containing Delete Topic Action to all principals</td>
            <td>SNS Topic should not have Policy with Delete Topic Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:DeleteTopic" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="16">
            <!-- <td>16</td> -->
            <td>Ensure Domain Auto Renew is enabled</td>
            <td>To ensure that the domain is always up, enable Auto Domain Renewal</td>
            <td>
            
              Route53<br>
            
            </td>
            <td class="code">Route53Domain should have AutoRenew </td>
          </tr>
          
          <tr num="17">
            <!-- <td>17</td> -->
            <td>Ensure Domain Transfer Lock is enabled</td>
            <td>To lock a domain to prevent unauthorized transfer to another registrar.</td>
            <td>
            
              Route53<br>
            
            </td>
            <td class="code">Route53Domain should have TransferLock </td>
          </tr>
          
          <tr num="18">
            <!-- <td>18</td> -->
            <td>Ensure Get Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Get action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action with [ value like "(?i)s3:GetObject" or value like "(?i)S3:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="19">
            <!-- <td>19</td> -->
            <td>Ensure Get Queue Attribute Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have GetQueueAttribute action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action with [ value like "(?i)SQS:GetQueueAttributes" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="20">
            <!-- <td>20</td> -->
            <td>Ensure Get Queue URL Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have GetQueueURL action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action with [ value like "(?i)SQS:GetQueueUrl" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="21">
            <!-- <td>21</td> -->
            <td>Ensure Deletion Protection is enabled on Elastic Load Balancer</td>
            <td>Enabling deletion protection on load balancers mitigates risks of accidental deletion.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have DeletionProtection </td>
          </tr>
          
          <tr num="22">
            <!-- <td>22</td> -->
            <td>Ensure List Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have List action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action with [ value like "(?i)s3:ListBucket" or value like "(?i)S3:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="23">
            <!-- <td>23</td> -->
            <td>Ensure Manage Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Manage action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ (Action with [ value like "(?i)s3:Put" or value like "(?i)S3:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="24">
            <!-- <td>24</td> -->
            <td>Ensure default security groups of EC2Instances contain rules</td>
            <td>Non-empty rule sets for default security groups should not exist.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where SecurityGroups with [ Name eq "default" ] should not have SecurityGroups with [ InboundRules len ( ) neq 0 or OutboundRules len ( ) neq 0 ] </td>
          </tr>
          
          <tr num="25">
            <!-- <td>25</td> -->
            <td>Data-in-transit is protected: Ensure older SSL/TLS policies are not used with Elastic Load Balancers</td>
            <td>Older SSL/TLS policy should not be used with Elastic Load Balancer Security Policy.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have SslPolicy in ( "ELBSecurityPolicy-2016-08", "ELBSecurityPolicy-TLS-1-2-2017-01", "ELBSecurityPolicy-TLS-1-1-2017-01" ) </td>
          </tr>
          
          <tr num="26">
            <!-- <td>26</td> -->
            <td>Access permissions and authorizations: Ensure RDS Instances do not have Publicly Accessible Snapshots</td>
            <td>RDS Instances should not have publicly accessible snapshots.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have Snapshots with [ PubliclyAccessible ] </td>
          </tr>
          
          <tr num="27">
            <!-- <td>27</td> -->
            <td>Ensure SNS Topics do not have Policies containing Publish Action to all principals</td>
            <td>SNS Topic should not have Policy with Publish Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:Publish" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="28">
            <!-- <td>28</td> -->
            <td>Ensure PurgeQueue Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue should not have Policy with PurgeQueue Action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action with [ value like "(?i)SQS:PurgeQueue" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="29">
            <!-- <td>29</td> -->
            <td>Ensure Put Action is not authorized to all principals in S3 Bucket Policy</td>
            <td>S3 Bucket Policy should not have Put action authorized to all principals</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketPolicy with [ Statement with [ ( Action with [ value like "(?i)s3:PutObject" or value like "(?i)S3:\*" ]) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="30">
            <!-- <td>30</td> -->
            <td>Ensure SNS Topics do not have Policies containing Receive Action to all principals</td>
            <td>SNS Topic should not have Policy with Receive Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:Receive" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="31">
            <!-- <td>31</td> -->
            <td>Ensure ReceiveMessage Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have ReceiveMessage action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action with [ value like "(?i)SQS:ReceiveMessage" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="32">
            <!-- <td>32</td> -->
            <td>Ensure SNS Topics do not have Policies containing Remove Permission Action to all principals</td>
            <td>SNS Topic should not have Policy with Remove Permission Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:RemovePermission" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="33">
            <!-- <td>33</td> -->
            <td>Ensure roles are not passed to CloudFormation stacks</td>
            <td>Passing a role to CloudFormation stacks may result in privilege escalation because IAM users with privileges, within the CloudFormation scope, implicitly inherit the stack's role's permissions.</td>
            <td>
            
              CloudFormation<br>
            
            </td>
            <td class="code">CloudFormation where Status in ("CREATE_COMPLETE", "UPDATE_COMPLETE") should not have StackRole . id </td>
          </tr>
          
          <tr num="34">
            <!-- <td>34</td> -->
            <td>Ensure SendEmail Action in SES Policy is not authorized to all principals</td>
            <td>SES should not have Policy with action as SendEmail, authorized to all principals</td>
            <td>
            
              SES<br>
            
            </td>
            <td class="code">SESIdentity should not have Policy with [ Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)ses:SendEmail" or value like "(?i)ses:SendRawEmail" or value like "(?i)ses:\*" ] )and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="35">
            <!-- <td>35</td> -->
            <td>Ensure SendMessage Action is not authorized to all principals in SQS Queue Policy</td>
            <td>SQS Queue Policy should not have SendMessage action authorized to all principals</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should not have SQSPolicy with [ Statement with [ ( Action with [ value like "(?i)SQS:SendMessage" or value like "(?i)SQS:\*" ] ) and Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="36">
            <!-- <td>36</td> -->
            <td>Ensure SNS Topics do not have Policies containing Set Topic Attribute Action to all principals</td>
            <td>SNS Topic should not have Policy with Set Topic Attribute Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:SetTopicAttributes" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="37">
            <!-- <td>37</td> -->
            <td>Backups of information: Ensure Backup Retention Period is set greater than or equal to 30 days.</td>
            <td>Setting Backup Retention Period of RDS Instance to a value greater than or equal to 30 ensures safety of data.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have BackupRetentionPeriod lt 30 </td>
          </tr>
          
          <tr num="38">
            <!-- <td>38</td> -->
            <td>Ensure SNS Topics do not have Policies containing Subscribe Action to all principals</td>
            <td>SNS Topic should not have Policy with Subscribe Action authorized to all principals</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should not have Policy . Statement with [ Effect eq "Allow" and ( Action with [ value like "(?i)SNS:Subscribe" or value like "(?i)SNS:\*" ] ) and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] </td>
          </tr>
          
          <tr num="39">
            <!-- <td>39</td> -->
            <td>Ensure unused role for EC2Instance does not exist</td>
            <td>IAMRoles which are not attached to any EC2Instance should not exist.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have InstanceProfile with [ InstanceCount eq 0 ] </td>
          </tr>
          
          <tr num="40">
            <!-- <td>40</td> -->
            <td>Ensure that no inline policy is attached to an IAMUser</td>
            <td>IAMUsers should not have any Inline policy attached to them.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have Policies . Inline len ( ) > 0 </td>
          </tr>
          
          <tr num="41">
            <!-- <td>41</td> -->
            <td>Ensure that an IAMUser has no more than 1 Active API Key</td>
            <td>IAMUsers should not have multiple active API keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have every AccessKey with [ Active eq true] </td>
          </tr>
          
          <tr num="42">
            <!-- <td>42</td> -->
            <td>Vulnerability management plan: Ensure Allow Version Upgrade is set to yes for Redshift Cluster</td>
            <td>Redshift Clusters should have Version Upgrade set to avoid missing important security updates.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AllowVersionUpgrade </td>
          </tr>
          
          <tr num="43">
            <!-- <td>43</td> -->
            <td>Ensure EC2 Instance does not have open MySQL port</td>
            <td>MySQL Port 3306, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( (FromPort lte 3306 and ToPort gte 3306) ) ] ] </td>
          </tr>
          
          <tr num="44">
            <!-- <td>44</td> -->
            <td>Ensure EC2 Instance does not have open SQL Server port</td>
            <td>MySQL Port 1433, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( (FromPort lte 1433 and ToPort gte 1434) ) ] ] </td>
          </tr>
          
          <tr num="45">
            <!-- <td>45</td> -->
            <td>Ensure EC2 Instance does not have open OracleDb port</td>
            <td>OracleDb Port 1521, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 1521 and ToPort gte 1521) ) ] ] </td>
          </tr>
          
          <tr num="46">
            <!-- <td>46</td> -->
            <td>Ensure EC2 Instance does not have open PostgreSQL port</td>
            <td>PostgreSQL Port 5432, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5432 and ToPort gte 5432) ) ] ] </td>
          </tr>
          
          <tr num="47">
            <!-- <td>47</td> -->
            <td>Ensure EC2 Instance does not have open RDP port</td>
            <td>RDP Port 3389, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","udp","tcp") and ( (FromPort lte 3389 and ToPort gte 3389) ) ] ] </td>
          </tr>
          
          <tr num="48">
            <!-- <td>48</td> -->
            <td>Ensure EC2 Instance does not have open SSH port</td>
            <td>SSH Port 22, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 22 and ToPort gte 22) ) ] ] </td>
          </tr>
          
          <tr num="49">
            <!-- <td>49</td> -->
            <td>Data-at-rest is protected: Ensure RDS encryption is enabled</td>
            <td>Ensure RDS encryption is enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have StorageEncrypted eq true </td>
          </tr>
          
          <tr num="50">
            <!-- <td>50</td> -->
            <td>Communications and control network protection: Ensure RDS instances are not in public subnets</td>
            <td>Ensure RDS instances are not in public subnets.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code"> RDSInstance should not have Access eq "Public" </td>
          </tr>
          
          <tr num="51">
            <!-- <td>51</td> -->
            <td>Ensure RDS database instances have detailed monitoring enabled</td>
            <td>Ensure RDS database instances have detailed monitoring enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have MonitoringInterval eq 0 </td>
          </tr>
          
          <tr num="52">
            <!-- <td>52</td> -->
            <td>Data-at-rest is protected: Ensure RDS instance snapshots are encrypted</td>
            <td>Ensure RDS instance snapshots are encrypted.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have every Snapshots with [ Encrypted eq true ] </td>
          </tr>
          
          <tr num="53">
            <!-- <td>53</td> -->
            <td>Backups of information: Ensure DynamoDB tables are backed up</td>
            <td>Ensure DynamoDB tables are backed up.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have BackedUp eq true </td>
          </tr>
          
          <tr num="54">
            <!-- <td>54</td> -->
            <td>Backups of information: Ensure DynamoDB tables have point in time recovery enabled</td>
            <td>Ensure DynamoDB tables have point in time recovery enabled.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have PointInTimeRecovery eq "ENABLED" </td>
          </tr>
          
          <tr num="55">
            <!-- <td>55</td> -->
            <td>Data-at-rest is protected: Ensure DynamoDB tables are encrypted at rest</td>
            <td>Ensure DynamoDB tables are encrypted at rest.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have SSEDescription . Status eq "ENABLED" </td>
          </tr>
          
          <tr num="56">
            <!-- <td>56</td> -->
            <td>Ensure Amazon Redshift clusters are launched within a Virtual Private Cloud (VPC)</td>
            <td>Ensure Amazon Redshift clusters are launched within a Virtual Private Cloud (VPC).</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have VPC len ( ) gt 0 </td>
          </tr>
          
          <tr num="57">
            <!-- <td>57</td> -->
            <td>Ensure automated snapshots are enabled for Redshift clusters</td>
            <td>Ensure automated snapshots are enabled for Redshift clusters.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AutomatedSnapshotRetentionPeriod gt 0 </td>
          </tr>
          
          <tr num="58">
            <!-- <td>58</td> -->
            <td>Ensure Amazon Redshift clusters are not using port 5439 (default port) for database access.</td>
            <td>Ensure Amazon Redshift clusters are not using port 5439 (default port) for database access.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Port eq 5439 </td>
          </tr>
          
          <tr num="59">
            <!-- <td>59</td> -->
            <td>Data-in-transit is protected: Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where ( Environment len() > 0 ) should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="60">
            <!-- <td>60</td> -->
            <td>Ensure Lambda functions do not have administrative level execution privileges.</td>
            <td>Ensure Lambda functions do not have administrative level execution privileges</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have AdminPrivileges eq True </td>
          </tr>
          
          <tr num="61">
            <!-- <td>61</td> -->
            <td>Ensure EKS Clusters have logging enabled.</td>
            <td>Ensure EKS Clusters have logging enabled</td>
            <td>
            
              EKSCluster<br>
            
            </td>
            <td class="code">EKSCluster should have Logging . ClusterLogging with [ Type has ( "api", "audit", "authenticator", "controllerManager", "scheduler") and Enabled eq true ] </td>
          </tr>
          
          <tr num="62">
            <!-- <td>62</td> -->
            <td>Ensure unattached EBS volumes are removed.</td>
            <td>Ensure unattached EBS volumes are removed.</td>
            <td>
            
              EC2Instance<br>
            
            </td>
            <td class="code">Volume should not have Attachments len ( ) eq 0 </td>
          </tr>
          
          <tr num="63">
            <!-- <td>63</td> -->
            <td>Ensure EBS Snapshots are encrypted.</td>
            <td>Ensure EBS Snapshots are encrypted</td>
            <td>
            
              EC2Instance<br>
            
            </td>
            <td class="code">Snapshots should have Encrypted </td>
          </tr>
          
          <tr num="64">
            <!-- <td>64</td> -->
            <td>Ensure Lambda functions have an associated Tag.</td>
            <td>Ensure Lambda functions have an associated Tag.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have Tags len( ) eq 0 </td>
          </tr>
          
          <tr num="65">
            <!-- <td>65</td> -->
            <td>Ensure Lambda execution role has permissions to log to CloudWatch.</td>
            <td>Ensure Lambda execution role has permissions to log to CloudWatch.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should have IAMRole . Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource len ( ) gt 0 and Action with [ value eq "logs:CreateLogGroup" ] ] and PolicyDocument . Statements with [ Effect eq "Allow" and Resource len ( ) gt 0 and Action with [ value eq "logs:CreateLogStream" ] ] and PolicyDocument . Statements with [ Effect eq "Allow" and Resource len ( ) gt 0 and Action with [ value eq "logs:PutLogEvents" ] ] ] or IAMRole . Policies . Managed with [ Permissions . Statements with [ Effect eq "Allow" and Resource len ( ) gt 0 and Action with [ value eq "logs:CreateLogGroup" ] ] and Permissions . Statements with [ Effect eq "Allow" and Resource len ( ) gt 0 and Action with [ value eq "logs:CreateLogStream" ] ] and Permissions . Statements with [ Effect eq "Allow" and Resource len ( ) gt 0 and Action with [ value eq "logs:PutLogEvents" ] ] ] </td>
          </tr>
          
          <tr num="66">
            <!-- <td>66</td> -->
            <td>Ensure Lambda execution role does not have IAM admin permissions.</td>
            <td>Ensure Lambda execution role does not have IAM admin permissions.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have IAMRole . Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "iam:*" ] ] ] or IAMRole . Policies . Managed with [ Permissions . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "iam:*" ] ] ] </td>
          </tr>
          
          <tr num="67">
            <!-- <td>67</td> -->
            <td>Ensure Lambda execution role does not have full admin permissions.</td>
            <td>Ensure Lambda execution role does not have full admin permissions.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have IAMRole . Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "*" ] ] ] or IAMRole . Policies . Managed with [ Permissions . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="68">
            <!-- <td>68</td> -->
            <td>Ensure CloudTrail logs to S3Bucket without any failures.</td>
            <td>Alert if any Error is encountered by CloudTrail while logging to the designated S3Bucket.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LatestDeliveryError eq "None" </td>
          </tr>
          
          <tr num="69">
            <!-- <td>69</td> -->
            <td>Ensure CloudTrail sends SNS notifications without any failures.</td>
            <td>Alert if any Error is encountered by CloudTrail when attempting to send a SNS notification.</td>
            <td>
            
              SNS<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LatestNotificationError eq "None" </td>
          </tr>
          
          <tr num="70">
            <!-- <td>70</td> -->
            <td>Ensure CloudTrail logging bucket has Multi-Factor Authentication (MFA) Enabled.</td>
            <td>Ensure that your AWS CloudTrail logging bucket use Multi-Factor Authentication (MFA) Delete feature in order to prevent the deletion of any versioned log files.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . BucketVersioning . MFADelete eq "Enabled" </td>
          </tr>
          
          <tr num="71">
            <!-- <td>71</td> -->
            <td>Ensure VPC Flow Log records are successfully published to a CloudWatch log group or an Amazon S3 bucket.</td>
            <td>Ensure VPC Flow Log records are successfully published to a CloudWatch log group or an Amazon S3 bucket.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPCFlow where Status eq "ACTIVE" should have DeliverLogsStatus eq "SUCCESS" </td>
          </tr>
          
          <tr num="72">
            <!-- <td>72</td> -->
            <td>Ensure S3 Bucket is not publicly accessible.</td>
            <td>Ensure S3 Bucket is not publicly accessible</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have Access eq "Public" </td>
          </tr>
          
          <tr num="73">
            <!-- <td>73</td> -->
            <td>Ensure no user has the AdministratorAccess policy</td>
            <td>Ensure users are not attached to the overly-privileged AdministratorAccess IAM policy.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have Policies . Managed with [ Permissions . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "*" ] ] ] or Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Resource with [ value eq "*" ] and Action with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="74">
            <!-- <td>74</td> -->
            <td>Ensure EC2 Instance does not have open TCP ports</td>
            <td>TCP Ports 22, 80, 443, 1433, 1521, 3306, 3389, 5432, 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( ( FromPort lte 22 and ToPort gte 22) or ( FromPort lte 80 and ToPort gte 80) or ( FromPort lte 443 and ToPort gte 443) or ( FromPort lte 1433 and ToPort gte 1433) or ( FromPort lte 1521 and ToPort gte 1521) or ( FromPort lte 3306 and ToPort gte 3306) or ( FromPort lte 3389 and ToPort gte 3389) or ( FromPort lte 5432 and ToPort gte 5432) or ( FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="75">
            <!-- <td>75</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">AWS should have atleast one IAMPolicies with [ id eq "arn:aws:iam::aws:policy/AWSSupportAccess" and ( AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 or AttachedEntities . Groups len ( ) gt 0 ) ] </td>
          </tr>
          
          <tr num="76">
            <!-- <td>76</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with sts:AssumeRole for CrossAccountArn</td>
            <td>Establish an access control system(s) for IAM AssumeRole Policies having cross account ARN to have condition specifying “sts:ExternalId”</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole where AssumeRolePolicy . CrossAccountArn eq True should have AssumeRolePolicy . Statement with [ Conditions with [ Condition eq "StringEquals" and Name eq "sts:ExternalId" and Value len() gt 0 ]] </td>
          </tr>
          
          <tr num="77">
            <!-- <td>77</td> -->
            <td>Ensure Image Vulnerability Scanning using Amazon ECR image scanning or a third party provider.</td>
            <td>Scan images being deployed to Amazon EKS for vulnerabilities.</td>
            <td>
            
              ECRRepository<br>
            
            </td>
            <td class="code">ECRRepository should have ImageScanningConfiguration.ScanOnPush </td>
          </tr>
          
          <tr num="78">
            <!-- <td>78</td> -->
            <td>Ensure Kubernetes Secrets are encrypted using Customer Master Keys (CMKs) managed in AWS KMS.</td>
            <td>Encrypt Kubernetes secrets, stored in etcd, using secrets encryption feature during Amazon EKS cluster creation.</td>
            <td>
            
              EKSCluster<br>
            
            </td>
            <td class="code">EKSCluster should have EncryptionConfig len() gt 0 </td>
          </tr>
          
          <tr num="79">
            <!-- <td>79</td> -->
            <td>Restrict Access to the Control Plane Endpoint</td>
            <td>Enable Endpoint Private Access to restrict access to the cluster's control plane to only an allowlist of authorized IPs.</td>
            <td>
            
              EKSCluster<br>
            
            </td>
            <td class="code">EKSCluster where EndPointPublicAccess should not have PublicAccessCidrs with [ CidrBlock eq 0.0.0.0/0] </td>
          </tr>
          
          <tr num="80">
            <!-- <td>80</td> -->
            <td>Ensure EKS Clusters are created with Private Endpoint Enabled and Public Access Disabled</td>
            <td>Disable access to the Kubernetes API from outside the node network if it is not required.</td>
            <td>
            
              EKSCluster<br>
            
            </td>
            <td class="code">EKSCluster should have EndPointPrivateAccess and not EndPointPublicAccess </td>
          </tr>
          
          <tr num="81">
            <!-- <td>81</td> -->
            <td>Consider Fargate for running untrusted workloads</td>
            <td>It is Best Practice to restrict or fence untrusted workloads when running in a multi-tenant environment.</td>
            <td>
            
              EKSCluster<br>
            
            </td>
            <td class="code">EKSCluster should not have FargateProfileNames len() eq 0 </td>
          </tr>
          
          <tr num="82">
            <!-- <td>82</td> -->
            <td>Amazon Redshift clusters should use enhanced VPC routing</td>
            <td>This control checks whether an Amazon Redshift cluster has EnhancedVpcRouting enabled</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have EnhancedVpcRouting </td>
          </tr>
          
          <tr num="83">
            <!-- <td>83</td> -->
            <td>Amazon EBS snapshots should not be public, determined by the ability to be restorable by anyone</td>
            <td>This control checks that Amazon Elastic Block Store snapshots are not public, as determined by the ability to be restorable by anyone. EBS snapshots are used to back up the data on your EBS volumes to Amazon S3 at a specific point in time. You can use the snapshots to restore previous states of EBS volumes. It is rarely acceptable to share a snapshot with the public. Typically the decision to share a snapshot publicly was made in error or without a complete understanding of the implications. This check helps ensure that all such sharing was fully planned and intentional</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Snapshots should have Access neq "Public" </td>
          </tr>
          
          <tr num="84">
            <!-- <td>84</td> -->
            <td>The VPC default security group should not allow inbound and outbound traffic</td>
            <td>This control checks that the default security group of a VPC does not allow inbound or outbound traffic</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len () eq 0 and OutboundRules len () eq 0 </td>
          </tr>
          
          <tr num="85">
            <!-- <td>85</td> -->
            <td>Attached EBS volumes should be encrypted at rest</td>
            <td>This control checks whether the EBS volumes that are in an attached state are encrypted</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Volume where Attachments len () gt 0 should have Encrypted </td>
          </tr>
          
          <tr num="86">
            <!-- <td>86</td> -->
            <td>Stopped EC2 instances should be removed after a specified time period</td>
            <td>This control checks whether any EC2 instances have been stopped for more than the allowed number of days. An EC2 instance fails this check if it is stopped for longer than the maximum allowed time period, which by default is 30 days</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where Status eq "stopped" should have StateTransitionTime isLaterThan ( -30 , "days" ) </td>
          </tr>
          
          <tr num="87">
            <!-- <td>87</td> -->
            <td>EBS default encryption should be enabled</td>
            <td>This control checks whether account-level encryption is enabled by default for Amazon Elastic Block Store(Amazon EBS)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Volume should have EbsEncryptionByDefault </td>
          </tr>
          
          <tr num="88">
            <!-- <td>88</td> -->
            <td>EC2 instances should use IMDSv2</td>
            <td>This control checks whether your EC2 instance metadata version is configured with Instance Metadata Service Version 2 (IMDSv2)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should have MetadataOptions.HttpTokens eq "required" </td>
          </tr>
          
          <tr num="89">
            <!-- <td>89</td> -->
            <td>EC2 instances should not have a public IP address</td>
            <td>This rule checks whether EC2 instances have a public IP address. The rule fails if the publicIp field is present in the EC2 instance configuration item. This rule applies to IPv4 addresses only</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have PublicIPv4 len () gt 0 </td>
          </tr>
          
          <tr num="90">
            <!-- <td>90</td> -->
            <td>Amazon EC2 should be configured to use VPC endpoints that are created for the Amazon EC2 service</td>
            <td>This control checks whether a service endpoint for Amazon EC2 is created for each VPC</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have Endpoints with [ ServiceName like "\.ec2$"] </td>
          </tr>
          
          <tr num="91">
            <!-- <td>91</td> -->
            <td>EC2 subnets should not automatically assign public IP addresses</td>
            <td>This control checks whether the assignment of public IPs in Amazon Virtual Private Cloud (Amazon VPC) subnets have MapPublicIpOnLaunch set to FALSE. The control passes if the flag is set to FALSE</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Subnet should not have MapPublicIpOnLaunch </td>
          </tr>
          
          <tr num="92">
            <!-- <td>92</td> -->
            <td>Unused network access control lists should be removed</td>
            <td>This control checks whether there are any unused network access control lists (ACLs)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL should have Subnets len () gt 0 </td>
          </tr>
          
          <tr num="93">
            <!-- <td>93</td> -->
            <td>EC2 instances should not use multiple ENIs</td>
            <td>This control checks whether an EC2 instance uses multiple Elastic Network Interfaces (ENIs)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should have NetworkInterfaces len ( ) lte 1 </td>
          </tr>
          
          <tr num="94">
            <!-- <td>94</td> -->
            <td>RDS DB instances should have deletion protection enabled</td>
            <td>This control checks whether your RDS DB instances that use one of the listed database engines have deletion protection enabled</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have DeletionProtection </td>
          </tr>
          
          <tr num="95">
            <!-- <td>95</td> -->
            <td>Database logging should be enabled</td>
            <td>This control checks whether the logs of Amazon RDS are enabled and sent to CloudWatch Logs</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have EnabledCloudwatchLogsExports len () gt 0 </td>
          </tr>
          
          <tr num="96">
            <!-- <td>96</td> -->
            <td>IAM authentication should be configured for RDS instances</td>
            <td>This control checks whether an RDS DB instance has IAM database authentication enabled</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have IAMDatabaseAuthenticationEnabled </td>
          </tr>
          
          <tr num="97">
            <!-- <td>97</td> -->
            <td>RDS automatic minor version upgrades should be enabled</td>
            <td>This control checks whether automatic minor version upgrades are enabled for the RDS database instance. Enabling automatic minor version upgrades ensures that the latest minor version updates to the relational database management system (RDBMS) are installed. These upgrades might include security patches and bug fixes. Keeping up to date with patch installation is an important step in securing systems</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have AutoMinorVersionUpgrade </td>
          </tr>
          
          <tr num="98">
            <!-- <td>98</td> -->
            <td>Amazon Aurora clusters should have backtracking enabled</td>
            <td>This control checks whether Amazon Aurora clusters have backtracking enabled</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSCluster where Engine eq "aurora-mysql" should have BacktrackWindow gt 0 </td>
          </tr>
          
          <tr num="99">
            <!-- <td>99</td> -->
            <td>RDS DB clusters should be configured to copy tags to snapshots</td>
            <td>This control checks whether RDS DB clusters are configured to copy all tags to snapshots when the snapshots are created</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSCluster should have CopyTagsToSnapshot </td>
          </tr>
          
          <tr num="100">
            <!-- <td>100</td> -->
            <td>RDS DB instances should be configured to copy tags to snapshots</td>
            <td>This control checks whether RDS DB instances are configured to copy all tags to snapshots when the snapshots are created</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have CopyTagsToSnapshot </td>
          </tr>
          
          <tr num="101">
            <!-- <td>101</td> -->
            <td>An RDS event notifications subscription should be configured for critical cluster events</td>
            <td>This control checks whether an Amazon RDS event subscription exists that has notifications enabled for the DBCluster source type with maintenance,failure event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-cluster" and (EventCategoriesList has ("maintenance") and EventCategoriesList has ("failure")) and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="102">
            <!-- <td>102</td> -->
            <td>An RDS event notifications subscription should be configured for critical database instance events</td>
            <td>This control checks whether an Amazon RDS event subscription exists with notifications enabled for the DBInstance source type with maintenance,configuration change,failure event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-instance" and (EventCategoriesList has ("maintenance") and EventCategoriesList has ("failure") and EventCategoriesList has("configuration change")) and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="103">
            <!-- <td>103</td> -->
            <td>An RDS event notifications subscription should be configured for critical database parameter group events</td>
            <td>This control checks whether an Amazon RDS event subscription exists with notifications enabled for the DBParameterGroup source type with configuration change event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-parameter-group" and EventCategoriesList has("configuration change") and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="104">
            <!-- <td>104</td> -->
            <td>An RDS event notifications subscription should be configured for critical database security group events</td>
            <td>This control checks whether an Amazon RDS event subscription exists with notifications enabled for the DBSecurityGroup source type with configuration change failure event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-security-group" and (EventCategoriesList has ("failure") and EventCategoriesList has("configuration change")) and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="105">
            <!-- <td>105</td> -->
            <td>RDS clusters should not use a database engine default port</td>
            <td>This control checks whether the RDS cluster uses a port other than the default port of the database engine</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSCluster should not have Port eq 3306 </td>
          </tr>
          
          <tr num="106">
            <!-- <td>106</td> -->
            <td>Classic Load Balancer listeners should be configured with HTTPS or TLS termination</td>
            <td>This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS protocol for front-end (client to load balancer) connections.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ClassicLoadBalancer where ( ListenerDescriptions len () gt 0 ) should have ListenerDescriptions with [ Listener . Protocol in ("HTTPS", "SSL") ] </td>
          </tr>
          
          <tr num="107">
            <!-- <td>107</td> -->
            <td>Application load balancers should be configured to drop HTTP headers</td>
            <td>This control evaluates AWS Application Load Balancers to ensure they are configured to drop invalid HTTP headers</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer where Type eq "application" should have RoutingHttpDropInvalidHeaderFieldsEnabled eq True </td>
          </tr>
          
          <tr num="108">
            <!-- <td>108</td> -->
            <td>Application Load Balancers logging should be enabled</td>
            <td>This control checks whether the Application Load Balancer have logging enabled</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer where Type eq "application" should have AccessLogsEnabled eq True </td>
          </tr>
          
          <tr num="109">
            <!-- <td>109</td> -->
            <td>Classic Load Balancers logging should be enabled</td>
            <td>This rule checks whether the Classic Load Balancer have logging enabled</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ClassicLoadBalancer should have Attributes . AccessLog . Enabled </td>
          </tr>
          
          <tr num="110">
            <!-- <td>110</td> -->
            <td>Classic Load Balancers should have connection draining enabled</td>
            <td>This rule checks whether Classic Load Balancers have connection draining enabled. Enabling connection draining on Classic Load Balancers ensures that the load balancer stops sending requests to instances that are de-registering or unhealthy. It keeps the existing connections open. This is particularly useful for instances in Auto Scaling groups, to ensure that connections aren’t severed abruptly</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ClassicLoadBalancer should have Attributes . ConnectionDraining . Enabled </td>
          </tr>
          
          <tr num="111">
            <!-- <td>111</td> -->
            <td>Application Load Balancer should be configured to redirect all HTTP requests to HTTPS</td>
            <td>This control checks whether HTTP to HTTPS redirection is configured on all HTTP listeners of Application Load Balancers</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer where (Type eq "application" and Listeners with [ Protocol eq "HTTP" ]) should have Listeners with [ Protocol eq "HTTP" and DefaultActions with [ Type eq "redirect" and RedirectConfig . Protocol eq "HTTPS" and RedirectConfig . Port eq 443 ] ] </td>
          </tr>
          
          <tr num="112">
            <!-- <td>112</td> -->
            <td>CodeBuild GitHub or Bitbucket source repository URLs should use OAuth</td>
            <td>This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password</td>
            <td>
            
              CodeBuild<br>
            
            </td>
            <td class="code">SourceCredential should have AuthType eq "OAUTH" </td>
          </tr>
          
          <tr num="113">
            <!-- <td>113</td> -->
            <td>CodeBuild project environment variables should not contain clear text credentials</td>
            <td>This control checks whether the project contains clear text credentials in the environment variables</td>
            <td>
            
              CodeBuild<br>
            
            </td>
            <td class="code">CodeBuild should not have Environment . EnvironmentVariables with [Type eq "PLAINTEXT" ] </td>
          </tr>
          
          <tr num="114">
            <!-- <td>114</td> -->
            <td>AWS Database Migration Service replication instances should not be public</td>
            <td>This control checks whether AWS DMS replication instances are public</td>
            <td>
            
              DMS<br>
            
            </td>
            <td class="code">DMSReplicationInstance should not have PubliclyAccessible </td>
          </tr>
          
          <tr num="115">
            <!-- <td>115</td> -->
            <td>IAM customer managed policies that you create should not allow wildcard actions for services</td>
            <td>This control checks whether the IAM identity-based policies that you create have Allow statements that use the * wildcard to grant permissions for all actions on any service</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where Type eq "Customer Managed" should not have Permissions . Statements with [ Effect eq "Allow" and ( NotAction with [ value like "\:\*$" ] or Action with [ value like "\:\*$" ] ) ] </td>
          </tr>
          
          <tr num="116">
            <!-- <td>116</td> -->
            <td>IAM customer managed policies should not allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the default version of IAM customer managed policies allow principals to use the AWS KMS decryption actions on all resources</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where Type eq "Customer Managed" should not have Permissions . Statements with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] </td>
          </tr>
          
          <tr num="117">
            <!-- <td>117</td> -->
            <td>AWS KMS keys should not be unintentionally deleted</td>
            <td>This control checks whether KMS keys are scheduled for deletion. KMS keys cannot be recovered once deleted. Data encrypted under a KMS key is also permanently unrecoverable if the KMS key is deleted. If meaningful data has been encrypted under a KMS key scheduled for deletion, consider decrypting the data or re-encrypting the data under a new KMS key unless you are intentionally performing a cryptographic erasure</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should not have Status eq "PendingDeletion" </td>
          </tr>
          
          <tr num="118">
            <!-- <td>118</td> -->
            <td>IAM principals should not have IAM Group inline policies that allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the inline policies that are embedded in your IAM group allow the AWS KMS decryption and re-encryption actions on all KMS keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMGroup should not have GroupPolicy . InlinePolicies with [ PolicyDocument . Statement with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="119">
            <!-- <td>119</td> -->
            <td>IAM principals should not have IAM Role inline policies that allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the inline policies that are embedded in your IAM role allow the AWS KMS decryption and re-encryption actions on all KMS keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="120">
            <!-- <td>120</td> -->
            <td>IAM principals should not have IAM User inline policies that allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the inline policies that are embedded in your IAM user allow the AWS KMS decryption and re-encryption actions on all KMS keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="121">
            <!-- <td>121</td> -->
            <td>Lambda function policies should prohibit public access</td>
            <td>This control checks whether the Lambda function resource-based policy prohibits public access outside of your account</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have ResourceBasedIAMPolicy . Statements with [ Effect eq "Allow" and Principal with [ value eq "*"] ] </td>
          </tr>
          
          <tr num="122">
            <!-- <td>122</td> -->
            <td>Lambda function s3 invoked policies should prohibit public access</td>
            <td>This control checks whether the Lambda function resource-based s3 invoked policy prohibits public access outside of your account. The control also fails if a Lambda function is invoked from Amazon S3 and the policy does not include a condition for AWS:SourceAccount</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where ResourceBasedIAMPolicy . Statements with [ Action with [ value eq "lambda:InvokeFunction" ] and Principal with [ value eq "s3.amazonaws.com" ]] should have ResourceBasedIAMPolicy . Statements with [ Action with [ value eq "lambda:InvokeFunction" ] and Principal with [ value eq "s3.amazonaws.com" ] and Conditions with [ Name eq "AWS:SourceAccount" and Value len() gt 0 ]] </td>
          </tr>
          
          <tr num="123">
            <!-- <td>123</td> -->
            <td>Lambda functions should use supported runtimes</td>
            <td>This control checks that the Lambda function settings for runtimes match the expected values set for the supported runtimes for each language</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where PackageType neq "Image" should have Runtime in ("nodejs14.x", "nodejs12.x", "python3.9", "python3.8", "python3.7", "python3.6", "ruby2.7", "java11", "java8", "java8.al2", "go1.x", "dotnetcore3.1") </td>
          </tr>
          
          <tr num="124">
            <!-- <td>124</td> -->
            <td>Amazon ECS task definitions should have secure networking modes and user definitions</td>
            <td>This control checks whether an active Amazon ECS task definition that has host networking mode also has privileged or user container definitions. The control fails for task definitions that have host network mode and container definitions where privileged=false or is empty and user=root or is empty</td>
            <td>
            
              ECS<br>
            
            </td>
            <td class="code">ECSTaskDefinition where NetworkMode eq "host" should have ContainerDefinitions with [ Privileged and User len () gt 0 and User neq "root" ] </td>
          </tr>
          
          <tr num="125">
            <!-- <td>125</td> -->
            <td>Amazon ECS services should not have public IP addresses assigned to them automatically</td>
            <td>This control checks whether Amazon ECS services are configured to automatically assign public IP addresses. A public IP address is an IP address that is reachable from the internet. If you launch your Amazon ECS instances with a public IP address, then your Amazon ECS instances are reachable from the internet. Amazon ECS services should not be publicly accessible, as this may allow unintended access to your container application servers</td>
            <td>
            
              ECS<br>
            
            </td>
            <td class="code">ECSCluster where Services with [ TaskDefinition . NetworkMode eq "awsvpc"] should have Services with [ TaskDefinition . NetworkMode eq "awsvpc" and AwsVPCConfiguration . AssignPublicIp neq "ENABLED" ] </td>
          </tr>
          
          <tr num="126">
            <!-- <td>126</td> -->
            <td>SNS topics should be encrypted at rest using AWS KMS</td>
            <td>This control checks whether an SNS topic is encrypted at rest using AWS KMS</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should have KmsMasterKeyId len () gt 0 </td>
          </tr>
          
          <tr num="127">
            <!-- <td>127</td> -->
            <td>Amazon SQS queues should be encrypted at rest</td>
            <td>This control checks whether Amazon SQS queues are encrypted at rest</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should have ( KmsMasterKeyId len ( ) gt 0 or SqsManagedSseEnabled ) </td>
          </tr>
          
          <tr num="128">
            <!-- <td>128</td> -->
            <td>Imported ACM certificates should be renewed after a specified time period</td>
            <td>This control checks whether ACM certificates in your account are marked for expiration within 30 days. It checks both imported certificates and certificates provided by AWS Certificate Manager.</td>
            <td>
            
              ACM<br>
            
            </td>
            <td class="code">ACM should have NotAfter isLaterThan(30, "days") </td>
          </tr>
          
          <tr num="129">
            <!-- <td>129</td> -->
            <td>API Gateway REST and WebSocket API logging should be enabled</td>
            <td>This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if logging is not enabled for all methods of a stage or if loggingLevel is neither ERROR nor INFO.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway where Stages len( ) gt 0 should have Stages with [ MethodSettings with [ MethodValue . LoggingLevel in ("INFO", "ERROR") ] ] </td>
          </tr>
          
          <tr num="130">
            <!-- <td>130</td> -->
            <td>API Gateway REST API stages should be configured to use SSL certificates for backend authentication</td>
            <td>This control checks whether Amazon API Gateway REST API stages have SSL certificates configured. Backend systems use these certificates to authenticate that incoming requests are from API Gateway.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ ClientCertificateId len( ) gt 0 ] </td>
          </tr>
          
          <tr num="131">
            <!-- <td>131</td> -->
            <td>API Gateway REST API stages should have AWS X-Ray tracing enabled</td>
            <td>This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages.</td>
            <td>
            
              Category<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ TracingEnabled ] </td>
          </tr>
          
          <tr num="132">
            <!-- <td>132</td> -->
            <td>API Gateway should be associated with an AWS WAF web ACL</td>
            <td>Checks whether an API Gateway stage uses an AWS WAF web access control list (ACL). The control fails if it is not attached to a REST API Gateway stage.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ WebAclArn len( ) gt 0 ] </td>
          </tr>
          
          <tr num="133">
            <!-- <td>133</td> -->
            <td>API Gateway REST API cache data should be encrypted at rest</td>
            <td>Checks whether all methods in API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in an API Gateway REST API stage is configured to cache and the cache is not encrypted.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ MethodSettings with [ MethodValue . CacheDataEncrypted ] ] </td>
          </tr>
          
          <tr num="134">
            <!-- <td>134</td> -->
            <td>Auto Scaling groups associated with a load balancer should use load balancer health checks</td>
            <td>This control checks whether your Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks.</td>
            <td>
            
              AutoScalingGroup<br>
            
            </td>
            <td class="code">AutoScalingGroup where LoadBalancerNames len( ) gt 0 should have HealthCheckType eq "ELB" </td>
          </tr>
          
          <tr num="135">
            <!-- <td>135</td> -->
            <td>CloudFront distributions should have a default root object configured</td>
            <td>This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have DefaultRootObject len( ) gt 0 </td>
          </tr>
          
          <tr num="136">
            <!-- <td>136</td> -->
            <td>CloudFront distributions should have origin access identity enabled</td>
            <td>This control checks whether an Amazon CloudFront distribution with Amazon S3 Origin type has Origin Access Identity (OAI) configured. The control fails if OAI is not configured.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have Origins . Items with [ S3OriginConfig . OriginAccessIdentity len( ) gt 0 ] </td>
          </tr>
          
          <tr num="137">
            <!-- <td>137</td> -->
            <td>CloudFront distributions should require encryption in transit</td>
            <td>This control checks whether an Amazon CloudFront distribution requires viewers to use HTTPS directly or whether it uses redirection. The control fails if ViewerProtocolPolicy is set to allow-all for defaultCacheBehavior or for cacheBehaviors.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should not have DefaultCacheBehavior . ViewerProtocolPolicy eq "allow-all" </td>
          </tr>
          
          <tr num="138">
            <!-- <td>138</td> -->
            <td>CloudFront distributions should have origin failover configured</td>
            <td>This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have OriginGroups . Quantity gt 0 and OriginGroups . Items len( ) gt 0 </td>
          </tr>
          
          <tr num="139">
            <!-- <td>139</td> -->
            <td>CloudFront distributions should have logging enabled</td>
            <td>This control checks whether server access logging is enabled on CloudFront distributions. The control fails if access logging is not enabled for a distribution.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have Logging . Enabled </td>
          </tr>
          
          <tr num="140">
            <!-- <td>140</td> -->
            <td>CloudFront distributions should have AWS WAF enabled</td>
            <td>This control checks whether CloudFront distributions are associated with either AWS WAF or AWS WAFv2 web ACLs. The control fails if the distribution is not associated with a web ACL.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have WebACLId len( ) gt 0 </td>
          </tr>
          
          <tr num="141">
            <!-- <td>141</td> -->
            <td>CloudTrail should have encryption at rest enabled</td>
            <td>This control checks whether CloudTrail is configured to use the server-side encryption (SSE) AWS KMS key encryption. The check passes if the KmsKeyId is defined.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len( ) > 0 </td>
          </tr>
          
          <tr num="142">
            <!-- <td>142</td> -->
            <td>DynamoDB tables should automatically scale capacity with demand</td>
            <td>This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. This control passes if the table uses either on-demand capacity mode or provisioned mode with auto scaling configured.</td>
            <td>
            
              DynamoDB<br>
            
            </td>
            <td class="code">DynamoDBTable should have ScalableTargets len( ) gt 0 </td>
          </tr>
          
          <tr num="143">
            <!-- <td>143</td> -->
            <td>DynamoDB Accelerator (DAX) clusters should be encrypted at rest</td>
            <td>This control checks whether a DAX cluster is encrypted at rest.</td>
            <td>
            
              DynamoDB<br>
            
            </td>
            <td class="code">DAX should have SSEDescription . Status eq "ENABLED" </td>
          </tr>
          
          <tr num="144">
            <!-- <td>144</td> -->
            <td>Amazon EFS should be configured to encrypt file data at rest using AWS KMS</td>
            <td>This control checks whether Amazon Elastic File System is configured to encrypt the file data using AWS KMS.</td>
            <td>
            
              EFS<br>
            
            </td>
            <td class="code">ElasticFileSystem should have Encrypted and KMSKey . Enabled </td>
          </tr>
          
          <tr num="145">
            <!-- <td>145</td> -->
            <td>Elastic Beanstalk environments should have enhanced health reporting enabled</td>
            <td>This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments.</td>
            <td>
            
              ElasticBeanstalk<br>
            
            </td>
            <td class="code">ElasticBeanstalk should have ConfigurationSettings with [ OptionSettings with [ OptionName eq "EnhancedHealthAuthEnabled" and Value eq "true" ] ] </td>
          </tr>
          
          <tr num="146">
            <!-- <td>146</td> -->
            <td>Elastic Beanstalk managed platform updates should be enabled</td>
            <td>This control checks whether managed platform updates are enabled for the Elastic Beanstalk environment.</td>
            <td>
            
              ElasticBeanstalk<br>
            
            </td>
            <td class="code">ElasticBeanstalk should have ConfigurationSettings with [ OptionSettings with [ OptionName eq "ManagedActionsEnabled" and Value eq "true" ] ] </td>
          </tr>
          
          <tr num="147">
            <!-- <td>147</td> -->
            <td>Amazon EMR cluster master nodes should not have public IP addresses</td>
            <td>This control checks whether master nodes on Amazon EMR clusters have public IP addresses.</td>
            <td>
            
              EMR<br>
            
            </td>
            <td class="code">EMRCluster should not have Instances with [ PublicIpAddress isPublic() ] </td>
          </tr>
          
          <tr num="148">
            <!-- <td>148</td> -->
            <td>Elasticsearch domains should have encryption at rest enabled</td>
            <td>This control checks whether Elasticsearch domains have encryption at rest configuration enabled. The check fails if encryption at rest is not enabled.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have EncryptionAtRestOptions . Enabled </td>
          </tr>
          
          <tr num="149">
            <!-- <td>149</td> -->
            <td>Elasticsearch domains should be in a VPC</td>
            <td>This control checks whether Elasticsearch domains are in a VPC. It should be ensured that Elasticsearch domains are not attached to public subnets.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have VPCOptions . VPC . Status eq "available" </td>
          </tr>
          
          <tr num="150">
            <!-- <td>150</td> -->
            <td>Elasticsearch domains should encrypt data sent between nodes</td>
            <td>This control checks whether Elasticsearch domains have node-to-node encryption enabled.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have NodeToNodeEncryptionOptions . Enabled </td>
          </tr>
          
          <tr num="151">
            <!-- <td>151</td> -->
            <td>Elasticsearch domain error logging to CloudWatch Logs should be enabled</td>
            <td>This control checks whether Elasticsearch domains are configured to send error logs to CloudWatch Logs.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have LogPublishingOptions with [ Name eq "ES_APPLICATION_LOGS" and Enabled and CloudWatchLogsLogGroup . id len( ) gt 0 ] </td>
          </tr>
          
          <tr num="152">
            <!-- <td>152</td> -->
            <td>Elasticsearch domains should have audit logging enabled</td>
            <td>This control checks whether Elasticsearch domains have audit logging enabled. This control fails if an Elasticsearch domain does not have audit logging enabled.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have LogPublishingOptions with [ Name eq "AUDIT_LOGS" and Enabled and CloudWatchLogsLogGroup . id len( ) gt 0 ] </td>
          </tr>
          
          <tr num="153">
            <!-- <td>153</td> -->
            <td>Elasticsearch domains should have at least three data nodes</td>
            <td>This control checks whether Elasticsearch domains are configured with at least three data nodes and zoneAwarenessEnabled is true.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have ElasticsearchClusterConfig . ZoneAwarenessEnabled and ElasticsearchClusterConfig . ZoneAwarenessConfig . AvailabilityZoneCount gte 3 </td>
          </tr>
          
          <tr num="154">
            <!-- <td>154</td> -->
            <td>Elasticsearch domains should be configured with at least three dedicated master nodes</td>
            <td>This control checks whether Elasticsearch domains are configured with at least three dedicated master nodes. This control fails if the domain does not use dedicated master nodes.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have ElasticsearchClusterConfig . DedicatedMasterEnabled and ElasticsearchClusterConfig . DedicatedMasterCount gte 3 </td>
          </tr>
          
          <tr num="155">
            <!-- <td>155</td> -->
            <td>Connections to Elasticsearch domains should be encrypted using TLS 1.2</td>
            <td>This control checks whether connections to Elasticsearch domains are required to use TLS 1.2. The check fails if the Elasticsearch domain TLSSecurityPolicy is not Policy-Min-TLS-1-2-2019-07.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have DomainEndpointOptions . TLSSecurityPolicy eq "Policy-Min-TLS-1-2-2019-07" </td>
          </tr>
          
          <tr num="156">
            <!-- <td>156</td> -->
            <td>GuardDuty should be enabled</td>
            <td>This control checks whether Amazon GuardDuty is enabled in your GuardDuty account and Region.</td>
            <td>
            
              GuardDuty<br>
            
            </td>
            <td class="code">GuardDutyDetector should have Status eq "ENABLED" </td>
          </tr>
          
          <tr num="157">
            <!-- <td>157</td> -->
            <td>IAM authentication should be configured for RDS clusters</td>
            <td>This control checks whether an RDS DB cluster has IAM database authentication enabled.</td>
            <td>
            
              RDSCluster<br>
            
            </td>
            <td class="code">RDSCluster should have IAMDatabaseAuthenticationEnabled </td>
          </tr>
          
          <tr num="158">
            <!-- <td>158</td> -->
            <td>RDS DB clusters should be configured for multiple Availability Zones</td>
            <td>This control checks whether high availability is enabled for your RDS DB clusters.</td>
            <td>
            
              RDSCluster<br>
            
            </td>
            <td class="code">RDSCluster should have MultiAZ eq true and AvailabilityZones len ( ) gt 0 </td>
          </tr>
          
          <tr num="159">
            <!-- <td>159</td> -->
            <td>RDS clusters should have deletion protection enabled</td>
            <td>This control checks whether RDS clusters have deletion protection enabled.</td>
            <td>
            
              RDSCluster<br>
            
            </td>
            <td class="code">RDSCluster should have DeletionProtection </td>
          </tr>
          
          <tr num="160">
            <!-- <td>160</td> -->
            <td>SageMaker notebook instances should not have direct internet access</td>
            <td>This control checks whether direct internet access is disabled for an SageMaker notebook instance</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">SageMakerNotebookInstance should have DirectInternetAccess eq "Disabled" </td>
          </tr>
          
          <tr num="161">
            <!-- <td>161</td> -->
            <td>Secrets Manager secrets should have automatic rotation enabled</td>
            <td>This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret should have RotationEnabled </td>
          </tr>
          
          <tr num="162">
            <!-- <td>162</td> -->
            <td>Secrets Manager secrets configured with automatic rotation should rotate successfully</td>
            <td>This control checks whether an AWS Secrets Manager secret rotated successfully based on the rotation schedule. The control does not evaluate secrets that do not have rotation configured</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret where RotationEnabled should have RotationOccurringAsScheduled </td>
          </tr>
          
          <tr num="163">
            <!-- <td>163</td> -->
            <td>Remove unused Secrets Manager secrets</td>
            <td>This control checks whether your secrets have been accessed within a specified number of days. If a secret was not accessed within 90 days, this control fails</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret should have LastAccessedDate isLaterThan(-90, "days") </td>
          </tr>
          
          <tr num="164">
            <!-- <td>164</td> -->
            <td>Secrets Manager secrets should be rotated within a specified number of days</td>
            <td>This control checks whether your secrets have been rotated at least once within 90 days. Rotating secrets can help you to reduce the risk of an unauthorized use of your secrets in your AWS account. Examples include database credentials, passwords, third-party API keys, and even arbitrary text. If you do not change your secrets for a long period of time, the secrets are more likely to be compromised</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret should have LastRotatedDate isLaterThan(-90, "days") </td>
          </tr>
          
          <tr num="165">
            <!-- <td>165</td> -->
            <td>AWS WAF Classic global web ACL logging should be enabled</td>
            <td>This control checks if logging is enabled on AWS Web Application Firewall (WAF) classic global web ACLs. This rule is NON_COMPLIANT for a global web ACL, if it does not have logging enabled.</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">WebACL should have LoggingConfiguration . LogDestinationConfigs len( ) gt 0 </td>
          </tr>
          
          <tr num="166">
            <!-- <td>166</td> -->
            <td>EC2 instances should be managed by AWS Systems Manager</td>
            <td>This control checks whether the stopped and running EC2 instances in the account are managed by AWS Systems Manager. Systems Manager is an AWS service that can be used to view and control the AWS infrastructure.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should have SSMInformation len () gt 0 </td>
          </tr>
          
          <tr num="167">
            <!-- <td>167</td> -->
            <td>All EC2 instances managed by Systems Manager should be compliant with patching requirements</td>
            <td>This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is COMPLIANT or NON_COMPLIANT after the patch installation on the instance. It only checks instances that are managed by Systems Manager Patch Manager.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where SSMInformation len() gt 0 and ComplianceSummaryItems with [ ComplianceType eq "Patch" ] should have ComplianceSummaryItems with [ ComplianceType eq "Patch" and NonCompliantSummary . NonCompliantCount eq 0 ] </td>
          </tr>
          
          <tr num="168">
            <!-- <td>168</td> -->
            <td>Instances managed by Systems Manager should have an association compliance status of COMPLIANT</td>
            <td>This control checks whether the status of the AWS Systems Manager association compliance is COMPLIANT or NON_COMPLIANT after the association is run on an instance. The control passes if the association compliance status is COMPLIANT.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where SSMInformation len() gt 0 and ComplianceSummaryItems with [ ComplianceType eq "Association" ] should have ComplianceSummaryItems with [ ComplianceType eq "Association" and NonCompliantSummary . NonCompliantCount eq 0 ] </td>
          </tr>
          
          <tr num="169">
            <!-- <td>169</td> -->
            <td>Ensure EC2 Instance does not have open ahsp port</td>
            <td>Ahsp Port 4333, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 4333 and ToPort gte 4333) ) ] ] </td>
          </tr>
          
          <tr num="170">
            <!-- <td>170</td> -->
            <td>Ensure EC2 Instance does not have open Alternative HTTP port</td>
            <td>Alternative HTTP Port 8888, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 8888 and ToPort gte 8888) ) ] ] </td>
          </tr>
          
          <tr num="171">
            <!-- <td>171</td> -->
            <td>Ensure EC2 Instance does not have open CIFS port</td>
            <td>CIFS Port 445, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 445 and ToPort gte 445) ) ] ] </td>
          </tr>
          
          <tr num="172">
            <!-- <td>172</td> -->
            <td>Ensure EC2 Instance does not have open fcp-addr-srvr1 port</td>
            <td>fcp-addr-srvr1 Port 5500, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5500 and ToPort gte 5500) ) ] ] </td>
          </tr>
          
          <tr num="173">
            <!-- <td>173</td> -->
            <td>Ensure EC2 Instance does not have open FTP port</td>
            <td>FTP Port 20 and 21, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 20 and ToPort gte 21) ) ] ] </td>
          </tr>
          
          <tr num="174">
            <!-- <td>174</td> -->
            <td>Ensure EC2 Instance does not have open IMAP port</td>
            <td>IMAP Port 143, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 143 and ToPort gte 143) ) ] ] </td>
          </tr>
          
          <tr num="175">
            <!-- <td>175</td> -->
            <td>Ensure EC2 Instance does not have open Legacy HTTP port</td>
            <td>Legacy HTTP Port 8088, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 8088 and ToPort gte 8088) ) ] ] </td>
          </tr>
          
          <tr num="176">
            <!-- <td>176</td> -->
            <td>Ensure EC2 Instance does not have open OpenSearch Dashboards port</td>
            <td>OpenSearch Dashboards Port 5601, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5601 and ToPort gte 5601) ) ] ] </td>
          </tr>
          
          <tr num="177">
            <!-- <td>177</td> -->
            <td>Ensure EC2 Instance does not have open OpenSearch port</td>
            <td>OpenSearch Port 9200 or 9300, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 9200 and ToPort gte 9200) or (FromPort lte 9300 and ToPort gte 9300) ) ] ] </td>
          </tr>
          
          <tr num="178">
            <!-- <td>178</td> -->
            <td>Ensure EC2 Instance does not have open POP3 port</td>
            <td>POP3 Port 110, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 110 and ToPort gte 110) ) ] ] </td>
          </tr>
          
          <tr num="179">
            <!-- <td>179</td> -->
            <td>Ensure EC2 Instance does not have open Proxy port</td>
            <td>Proxy Port 8080, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 8080 and ToPort gte 8080) ) ] ] </td>
          </tr>
          
          <tr num="180">
            <!-- <td>180</td> -->
            <td>Ensure EC2 Instance does not have open RPC port</td>
            <td>RPC Port 135, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 135 and ToPort gte 135) ) ] ] </td>
          </tr>
          
          <tr num="181">
            <!-- <td>181</td> -->
            <td>Ensure EC2 Instance does not have open Telnet port</td>
            <td>Telnet Port 23, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 23 and ToPort gte 23) ) ] ] </td>
          </tr>
          
          <tr num="182">
            <!-- <td>182</td> -->
            <td>Ensure EC2 Instance does not have open Python web development frameworks port</td>
            <td>Python web development frameworks Port 5000, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5000 and ToPort gte 5000) ) ] ] </td>
          </tr>
          
          <tr num="183">
            <!-- <td>183</td> -->
            <td>Ensure EC2 Instance does not have open Go, Node.js, and Ruby web development frameworks port</td>
            <td>Go, Node.js, and Ruby web development frameworks Port 3000, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 3000 and ToPort gte 3000) ) ] ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CCM">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="184">
            <!-- <td>184</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="185">
            <!-- <td>185</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="186">
            <!-- <td>186</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="187">
            <!-- <td>187</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="188">
            <!-- <td>188</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="189">
            <!-- <td>189</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="190">
            <!-- <td>190</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="191">
            <!-- <td>191</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="192">
            <!-- <td>192</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="193">
            <!-- <td>193</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="194">
            <!-- <td>194</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="195">
            <!-- <td>195</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="196">
            <!-- <td>196</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="197">
            <!-- <td>197</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="198">
            <!-- <td>198</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="199">
            <!-- <td>199</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="200">
            <!-- <td>200</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="201">
            <!-- <td>201</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="202">
            <!-- <td>202</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="203">
            <!-- <td>203</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="204">
            <!-- <td>204</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="205">
            <!-- <td>205</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="206">
            <!-- <td>206</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="207">
            <!-- <td>207</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="208">
            <!-- <td>208</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="209">
            <!-- <td>209</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="210">
            <!-- <td>210</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="211">
            <!-- <td>211</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="212">
            <!-- <td>212</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="213">
            <!-- <td>213</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="214">
            <!-- <td>214</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="215">
            <!-- <td>215</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="216">
            <!-- <td>216</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="217">
            <!-- <td>217</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="218">
            <!-- <td>218</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="219">
            <!-- <td>219</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="220">
            <!-- <td>220</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="221">
            <!-- <td>221</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="222">
            <!-- <td>222</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="223">
            <!-- <td>223</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="224">
            <!-- <td>224</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="225">
            <!-- <td>225</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="226">
            <!-- <td>226</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="227">
            <!-- <td>227</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CIS">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="228">
            <!-- <td>228</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="229">
            <!-- <td>229</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="230">
            <!-- <td>230</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="231">
            <!-- <td>231</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="232">
            <!-- <td>232</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="233">
            <!-- <td>233</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="234">
            <!-- <td>234</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="235">
            <!-- <td>235</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="236">
            <!-- <td>236</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="237">
            <!-- <td>237</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="238">
            <!-- <td>238</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="239">
            <!-- <td>239</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="240">
            <!-- <td>240</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="241">
            <!-- <td>241</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="242">
            <!-- <td>242</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="243">
            <!-- <td>243</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="244">
            <!-- <td>244</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
          <tr num="245">
            <!-- <td>245</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="246">
            <!-- <td>246</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="247">
            <!-- <td>247</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="248">
            <!-- <td>248</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="249">
            <!-- <td>249</td> -->
            <td>Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . Access eq "Public" </td>
          </tr>
          
          <tr num="250">
            <!-- <td>250</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="251">
            <!-- <td>251</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="252">
            <!-- <td>252</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="253">
            <!-- <td>253</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="254">
            <!-- <td>254</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="255">
            <!-- <td>255</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="256">
            <!-- <td>256</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="257">
            <!-- <td>257</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="258">
            <!-- <td>258</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="259">
            <!-- <td>259</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="260">
            <!-- <td>260</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="261">
            <!-- <td>261</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="262">
            <!-- <td>262</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="263">
            <!-- <td>263</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="264">
            <!-- <td>264</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="265">
            <!-- <td>265</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="266">
            <!-- <td>266</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="267">
            <!-- <td>267</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="268">
            <!-- <td>268</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="269">
            <!-- <td>269</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="270">
            <!-- <td>270</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="271">
            <!-- <td>271</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CISv14">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="272">
            <!-- <td>272</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="273">
            <!-- <td>273</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="274">
            <!-- <td>274</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="275">
            <!-- <td>275</td> -->
            <td>Identities and credentials: Eliminate use of the 'root' user for administrative and daily tasks</td>
            <td>With the creation of an AWS account, a 'root user' is created that cannot be disabled or deleted. That user has unrestricted access to and control over all resources in the AWS account. It is highly recommended that the use of this account be avoided for everyday tasks.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have ( ( AccessKey with [ Active and LastUsedTime isLaterThan ( -1, "days" ) ] ) or ( Password . Enabled and Password . LastUsedTime isLaterThan ( -1, "days" ) ) ) </td>
          </tr>
          
          <tr num="276">
            <!-- <td>276</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="277">
            <!-- <td>277</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="278">
            <!-- <td>278</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="279">
            <!-- <td>279</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="280">
            <!-- <td>280</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="281">
            <!-- <td>281</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="282">
            <!-- <td>282</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
          <tr num="283">
            <!-- <td>283</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="284">
            <!-- <td>284</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="285">
            <!-- <td>285</td> -->
            <td>Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . Access eq "Public" </td>
          </tr>
          
          <tr num="286">
            <!-- <td>286</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="287">
            <!-- <td>287</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="288">
            <!-- <td>288</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="289">
            <!-- <td>289</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="290">
            <!-- <td>290</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="291">
            <!-- <td>291</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="292">
            <!-- <td>292</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="293">
            <!-- <td>293</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="294">
            <!-- <td>294</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="295">
            <!-- <td>295</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="296">
            <!-- <td>296</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="297">
            <!-- <td>297</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="298">
            <!-- <td>298</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="299">
            <!-- <td>299</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="300">
            <!-- <td>300</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="301">
            <!-- <td>301</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="302">
            <!-- <td>302</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="303">
            <!-- <td>303</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="304">
            <!-- <td>304</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="305">
            <!-- <td>305</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="306">
            <!-- <td>306</td> -->
            <td>Data-at-rest is protected: Ensure RDS encryption is enabled</td>
            <td>Ensure RDS encryption is enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have StorageEncrypted eq true </td>
          </tr>
          
          <tr num="307">
            <!-- <td>307</td> -->
            <td>Ensure MFA Delete is enable on S3 buckets</td>
            <td>Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have BucketVersioning . Status eq "Enabled" and BucketVersioning . MFADelete eq "Enabled" </td>
          </tr>
          
          <tr num="308">
            <!-- <td>308</td> -->
            <td>Ensure S3 Bucket Policy is set to deny HTTP requests</td>
            <td>At the Amazon S3 bucket level, you can configure permissions through a bucket policy making the objects accessible only through HTTPS</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have BucketPolicy with [Statement with [Effect eq "Deny" and Conditions with [Name eq "aws:SecureTransport" and Value has ("false") ]]] </td>
          </tr>
          
          <tr num="309">
            <!-- <td>309</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exists for AWS Organizations changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for AWS Organizations changes made in the master AWS Account.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*organizations\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*AcceptHandshake\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateAccount\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateOrganizationalUnit\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeclineHandshake\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteOrganization\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteOrganizationalUnit\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisablePolicyType\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnablePolicyType\)\s*\|\|\s*\(\$\.eventName\s*=\s*InviteAccountToOrganization\)\s*\|\|\s*\(\$\.eventName\s*=\s*LeaveOrganization\)\s*\|\|\s*\(\$\.eventName\s*=\s*MoveAccount\)\s*\|\|\s*\(\$\.eventName\s*=\s*RemoveAccountFromOrganization\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateOrganizationalUnit\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="310">
            <!-- <td>310</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for security group changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security Groups are a stateful packet filter that controls ingress and egress traffic within a VPC. It is recommended that a metric filter and alarm be established for detecting changes to Security Groups.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*AuthorizeSecurityGroupIngress\)\s*\|\|\s*\(\$\.eventName\s*=\s*AuthorizeSecurityGroupEgress\)\s*\|\|\s*\(\$\.eventName\s*=\s*RevokeSecurityGroupIngress\)\s*\|\|\s*\(\$\.eventName\s*=\s*RevokeSecurityGroupEgress\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateSecurityGroup\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteSecurityGroup\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="311">
            <!-- <td>311</td> -->
            <td>Ensure all S3 buckets employ encryption-at-rest</td>
            <td>Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have DefaultEncryption eq "Disabled" </td>
          </tr>
          
          <tr num="312">
            <!-- <td>312</td> -->
            <td>Ensure credentials unused for 45 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all credentials that have been unused in 45 or greater days be deactivated or removed</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have ( RootUser eq False and ( ( AccessKey with [ Active and LastUsedTime isEarlierThan ( -45, "days" ) ] ) or ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -45, "days" ) ) ) ) or ( RootUser eq False and ( ( AccessKey with [ Active and LastUsedTime eq 0 ] ) or ( Password . Enabled and Password . LastUsedTime eq 0 ) ) and CreationDate isEarlierThan ( -45, "days" ) ) </td>
          </tr>
          
          <tr num="313">
            <!-- <td>313</td> -->
            <td>Ensure there is only one active access key available for any single IAM user</td>
            <td>Access keys are long-term credentials for an IAM user or the AWS account 'root' user. You can use access keys to sign programmatic requests to the AWS CLI or AWS API (directly or using the AWS SDK)</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have every AccessKey with [ Active eq true] and AccessKey len() gt 1 </td>
          </tr>
          
          <tr num="314">
            <!-- <td>314</td> -->
            <td>Ensure IAM Users Receive Permissions Only Through Groups</td>
            <td>IAM users are granted access to services, functions, and data through IAM policies. There are three ways to define policies for a user: 1) Edit the user policy directly, aka an inline, or user, policy; 2) attach a policy directly to a user; 3) add the user to an IAM group that has an attached policy. Only the third implementation is recommended.</td>
            <td>
            
              Identity<br>
            
            </td>
            <td class="code">IAMUser should have Policies . Managed len () eq 0 and Policies . Inline len () eq 0 </td>
          </tr>
          
          <tr num="315">
            <!-- <td>315</td> -->
            <td>Ensure that all the expired SSL/TLS certificates stored in AWS IAM are removed</td>
            <td>To enable HTTPS connections to your website or application in AWS, you need an SSL/TLS server certificate. You can use ACM or IAM to store and deploy server certificates. Use IAM as a certificate manager only when you must support HTTPS connections in a region that is not supported by ACM. IAM securely encrypts your private keys and stores the encrypted version in IAM SSL certificate storage. IAM supports deploying server certificates in all regions, but you must obtain your certificate from an external provider for use with AWS. You cannot upload an ACM certificate to IAM. Additionally, you cannot manage your certificates from the IAM Console.</td>
            <td>
            
              Identity<br>
            
            </td>
            <td class="code">ServerCertificate should not have Expiration isEarlierThan (0, "seconds") </td>
          </tr>
          
          <tr num="316">
            <!-- <td>316</td> -->
            <td>Ensure that IAM Access analyzer is enabled</td>
            <td>IAM Access Analyzer is a technology introduced at AWS reinvent 2019. After the Analyzer is enabled in IAM, scan results are displayed on the console showing the accessible resources. Scans show resources that other accounts and federated users can access, such as KMS keys and IAM roles. So the results allow you to determine if an unintended user is allowed, making it easier for administrators to monitor least privileges access.</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">AccessAnalyzer should have Status eq "ACTIVE" </td>
          </tr>
          
          <tr num="317">
            <!-- <td>317</td> -->
            <td>Ensure that S3 Buckets are configured with 'Block public access (bucket settings)'</td>
            <td>Amazon S3 provides Block public access (bucket settings) and Block public access (account settings) to help you manage public access to Amazon S3 resources. By default, S3 buckets and objects are created with public access disabled. However, an IAM principle with sufficient S3 permissions can enable public access at the bucket and/or object level. While enabled, Block public access (bucket settings) prevents an individual bucket, and its contained objects, from becoming publicly accessible. Similarly, Block public access (account settings) prevents all buckets, and contained objects, from becoming publicly accessible across the entire account.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">S3Bucket should have BlockPublicAccess . BlockPublicAcls and BlockPublicAccess . IgnorePublicAcls and BlockPublicAccess . BlockPublicPolicy and BlockPublicAccess . RestrictPublicBuckets </td>
          </tr>
          
          <tr num="318">
            <!-- <td>318</td> -->
            <td>Ensure no Network ACLs allow ingress from 0.0.0.0/0 to remote server administration ports</td>
            <td>The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. It is recommended that no NACL allows unrestricted ingress access to remote server administration ports, such as SSH to port 22 and RDP to port 3389.</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">NetworkACL should not have Rules with [ Egress eq False and RuleAction eq "allow" and CidrBlock eq 0.0.0.0/0 and ( (FromPort lte 22 and ToPort gte 22) or (FromPort lte 3389 and ToPort gte 3389) ) ] </td>
          </tr>
          
          <tr num="319">
            <!-- <td>319</td> -->
            <td>Ensure no security groups allow ingress from 0.0.0.0/0 to remote server administration ports</td>
            <td>Ensure no security groups allow ingress from 0.0.0.0/0 to remote server administration ports</td>
            <td>
            
              Network<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( (FromPort lte 22 and ToPort gte 22) or (FromPort lte 3389 and ToPort gte 3389) ) ] </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="FSBP">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="320">
            <!-- <td>320</td> -->
            <td>Imported ACM certificates should be renewed after a specified time period</td>
            <td>This control checks whether ACM certificates in your account are marked for expiration within 30 days. It checks both imported certificates and certificates provided by AWS Certificate Manager.</td>
            <td>
            
              ACM<br>
            
            </td>
            <td class="code">ACM should have NotAfter isLaterThan(30, "days") </td>
          </tr>
          
          <tr num="321">
            <!-- <td>321</td> -->
            <td>API Gateway REST and WebSocket API logging should be enabled</td>
            <td>This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if logging is not enabled for all methods of a stage or if loggingLevel is neither ERROR nor INFO.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway where Stages len( ) gt 0 should have Stages with [ MethodSettings with [ MethodValue . LoggingLevel in ("INFO", "ERROR") ] ] </td>
          </tr>
          
          <tr num="322">
            <!-- <td>322</td> -->
            <td>API Gateway REST API stages should be configured to use SSL certificates for backend authentication</td>
            <td>This control checks whether Amazon API Gateway REST API stages have SSL certificates configured. Backend systems use these certificates to authenticate that incoming requests are from API Gateway.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ ClientCertificateId len( ) gt 0 ] </td>
          </tr>
          
          <tr num="323">
            <!-- <td>323</td> -->
            <td>API Gateway REST API stages should have AWS X-Ray tracing enabled</td>
            <td>This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages.</td>
            <td>
            
              Category<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ TracingEnabled ] </td>
          </tr>
          
          <tr num="324">
            <!-- <td>324</td> -->
            <td>API Gateway should be associated with an AWS WAF web ACL</td>
            <td>Checks whether an API Gateway stage uses an AWS WAF web access control list (ACL). The control fails if it is not attached to a REST API Gateway stage.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ WebAclArn len( ) gt 0 ] </td>
          </tr>
          
          <tr num="325">
            <!-- <td>325</td> -->
            <td>API Gateway REST API cache data should be encrypted at rest</td>
            <td>Checks whether all methods in API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in an API Gateway REST API stage is configured to cache and the cache is not encrypted.</td>
            <td>
            
              APIGateway<br>
            
            </td>
            <td class="code">APIGateway should have Stages with [ MethodSettings with [ MethodValue . CacheDataEncrypted ] ] </td>
          </tr>
          
          <tr num="326">
            <!-- <td>326</td> -->
            <td>Auto Scaling groups associated with a load balancer should use load balancer health checks</td>
            <td>This control checks whether your Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks.</td>
            <td>
            
              AutoScalingGroup<br>
            
            </td>
            <td class="code">AutoScalingGroup where LoadBalancerNames len( ) gt 0 should have HealthCheckType eq "ELB" </td>
          </tr>
          
          <tr num="327">
            <!-- <td>327</td> -->
            <td>CloudFront distributions should have a default root object configured</td>
            <td>This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have DefaultRootObject len( ) gt 0 </td>
          </tr>
          
          <tr num="328">
            <!-- <td>328</td> -->
            <td>CloudFront distributions should have origin access identity enabled</td>
            <td>This control checks whether an Amazon CloudFront distribution with Amazon S3 Origin type has Origin Access Identity (OAI) configured. The control fails if OAI is not configured.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have Origins . Items with [ S3OriginConfig . OriginAccessIdentity len( ) gt 0 ] </td>
          </tr>
          
          <tr num="329">
            <!-- <td>329</td> -->
            <td>CloudFront distributions should require encryption in transit</td>
            <td>This control checks whether an Amazon CloudFront distribution requires viewers to use HTTPS directly or whether it uses redirection. The control fails if ViewerProtocolPolicy is set to allow-all for defaultCacheBehavior or for cacheBehaviors.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should not have DefaultCacheBehavior . ViewerProtocolPolicy eq "allow-all" </td>
          </tr>
          
          <tr num="330">
            <!-- <td>330</td> -->
            <td>CloudFront distributions should have origin failover configured</td>
            <td>This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have OriginGroups . Quantity gt 0 and OriginGroups . Items len( ) gt 0 </td>
          </tr>
          
          <tr num="331">
            <!-- <td>331</td> -->
            <td>CloudFront distributions should have logging enabled</td>
            <td>This control checks whether server access logging is enabled on CloudFront distributions. The control fails if access logging is not enabled for a distribution.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have Logging . Enabled </td>
          </tr>
          
          <tr num="332">
            <!-- <td>332</td> -->
            <td>CloudFront distributions should have AWS WAF enabled</td>
            <td>This control checks whether CloudFront distributions are associated with either AWS WAF or AWS WAFv2 web ACLs. The control fails if the distribution is not associated with a web ACL.</td>
            <td>
            
              CloudFront<br>
            
            </td>
            <td class="code">CloudfrontDistribution should have WebACLId len( ) gt 0 </td>
          </tr>
          
          <tr num="333">
            <!-- <td>333</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="334">
            <!-- <td>334</td> -->
            <td>CloudTrail should have encryption at rest enabled</td>
            <td>This control checks whether CloudTrail is configured to use the server-side encryption (SSE) AWS KMS key encryption. The check passes if the KmsKeyId is defined.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . id len( ) > 0 </td>
          </tr>
          
          <tr num="335">
            <!-- <td>335</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="336">
            <!-- <td>336</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="337">
            <!-- <td>337</td> -->
            <td>CodeBuild GitHub or Bitbucket source repository URLs should use OAuth</td>
            <td>This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password</td>
            <td>
            
              CodeBuild<br>
            
            </td>
            <td class="code">SourceCredential should have AuthType eq "OAUTH" </td>
          </tr>
          
          <tr num="338">
            <!-- <td>338</td> -->
            <td>CodeBuild project environment variables should not contain clear text credentials</td>
            <td>This control checks whether the project contains clear text credentials in the environment variables</td>
            <td>
            
              CodeBuild<br>
            
            </td>
            <td class="code">CodeBuild should not have Environment . EnvironmentVariables with [Type eq "PLAINTEXT" ] </td>
          </tr>
          
          <tr num="339">
            <!-- <td>339</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="340">
            <!-- <td>340</td> -->
            <td>AWS Database Migration Service replication instances should not be public</td>
            <td>This control checks whether AWS DMS replication instances are public</td>
            <td>
            
              DMS<br>
            
            </td>
            <td class="code">DMSReplicationInstance should not have PubliclyAccessible </td>
          </tr>
          
          <tr num="341">
            <!-- <td>341</td> -->
            <td>DynamoDB tables should automatically scale capacity with demand</td>
            <td>This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. This control passes if the table uses either on-demand capacity mode or provisioned mode with auto scaling configured.</td>
            <td>
            
              DynamoDB<br>
            
            </td>
            <td class="code">DynamoDBTable should have ScalableTargets len( ) gt 0 </td>
          </tr>
          
          <tr num="342">
            <!-- <td>342</td> -->
            <td>Backups of information: Ensure DynamoDB tables have point in time recovery enabled</td>
            <td>Ensure DynamoDB tables have point in time recovery enabled.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have PointInTimeRecovery eq "ENABLED" </td>
          </tr>
          
          <tr num="343">
            <!-- <td>343</td> -->
            <td>DynamoDB Accelerator (DAX) clusters should be encrypted at rest</td>
            <td>This control checks whether a DAX cluster is encrypted at rest.</td>
            <td>
            
              DynamoDB<br>
            
            </td>
            <td class="code">DAX should have SSEDescription . Status eq "ENABLED" </td>
          </tr>
          
          <tr num="344">
            <!-- <td>344</td> -->
            <td>Amazon EBS snapshots should not be public, determined by the ability to be restorable by anyone</td>
            <td>This control checks that Amazon Elastic Block Store snapshots are not public, as determined by the ability to be restorable by anyone. EBS snapshots are used to back up the data on your EBS volumes to Amazon S3 at a specific point in time. You can use the snapshots to restore previous states of EBS volumes. It is rarely acceptable to share a snapshot with the public. Typically the decision to share a snapshot publicly was made in error or without a complete understanding of the implications. This check helps ensure that all such sharing was fully planned and intentional</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Snapshots should have Access neq "Public" </td>
          </tr>
          
          <tr num="345">
            <!-- <td>345</td> -->
            <td>The VPC default security group should not allow inbound and outbound traffic</td>
            <td>This control checks that the default security group of a VPC does not allow inbound or outbound traffic</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len () eq 0 and OutboundRules len () eq 0 </td>
          </tr>
          
          <tr num="346">
            <!-- <td>346</td> -->
            <td>Attached EBS volumes should be encrypted at rest</td>
            <td>This control checks whether the EBS volumes that are in an attached state are encrypted</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Volume where Attachments len () gt 0 should have Encrypted </td>
          </tr>
          
          <tr num="347">
            <!-- <td>347</td> -->
            <td>Stopped EC2 instances should be removed after a specified time period</td>
            <td>This control checks whether any EC2 instances have been stopped for more than the allowed number of days. An EC2 instance fails this check if it is stopped for longer than the maximum allowed time period, which by default is 30 days</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where Status eq "stopped" should have StateTransitionTime isLaterThan ( -30 , "days" ) </td>
          </tr>
          
          <tr num="348">
            <!-- <td>348</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="349">
            <!-- <td>349</td> -->
            <td>EBS default encryption should be enabled</td>
            <td>This control checks whether account-level encryption is enabled by default for Amazon Elastic Block Store(Amazon EBS)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Volume should have EbsEncryptionByDefault </td>
          </tr>
          
          <tr num="350">
            <!-- <td>350</td> -->
            <td>EC2 instances should use IMDSv2</td>
            <td>This control checks whether your EC2 instance metadata version is configured with Instance Metadata Service Version 2 (IMDSv2)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should have MetadataOptions.HttpTokens eq "required" </td>
          </tr>
          
          <tr num="351">
            <!-- <td>351</td> -->
            <td>EC2 instances should not have a public IP address</td>
            <td>This rule checks whether EC2 instances have a public IP address. The rule fails if the publicIp field is present in the EC2 instance configuration item. This rule applies to IPv4 addresses only</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have PublicIPv4 len () gt 0 </td>
          </tr>
          
          <tr num="352">
            <!-- <td>352</td> -->
            <td>Amazon EC2 should be configured to use VPC endpoints that are created for the Amazon EC2 service</td>
            <td>This control checks whether a service endpoint for Amazon EC2 is created for each VPC</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have Endpoints with [ ServiceName like "\.ec2$"] </td>
          </tr>
          
          <tr num="353">
            <!-- <td>353</td> -->
            <td>EC2 subnets should not automatically assign public IP addresses</td>
            <td>This control checks whether the assignment of public IPs in Amazon Virtual Private Cloud (Amazon VPC) subnets have MapPublicIpOnLaunch set to FALSE. The control passes if the flag is set to FALSE</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">Subnet should not have MapPublicIpOnLaunch </td>
          </tr>
          
          <tr num="354">
            <!-- <td>354</td> -->
            <td>Unused network access control lists should be removed</td>
            <td>This control checks whether there are any unused network access control lists (ACLs)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL should have Subnets len () gt 0 </td>
          </tr>
          
          <tr num="355">
            <!-- <td>355</td> -->
            <td>EC2 instances should not use multiple ENIs</td>
            <td>This control checks whether an EC2 instance uses multiple Elastic Network Interfaces (ENIs)</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should have NetworkInterfaces len ( ) lte 1 </td>
          </tr>
          
          <tr num="356">
            <!-- <td>356</td> -->
            <td>Ensure EC2 Instance does not have open TCP ports</td>
            <td>TCP Ports 22, 80, 443, 1433, 1521, 3306, 3389, 5432, 27017, 27018, 27019 of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( ( FromPort lte 22 and ToPort gte 22) or ( FromPort lte 80 and ToPort gte 80) or ( FromPort lte 443 and ToPort gte 443) or ( FromPort lte 1433 and ToPort gte 1433) or ( FromPort lte 1521 and ToPort gte 1521) or ( FromPort lte 3306 and ToPort gte 3306) or ( FromPort lte 3389 and ToPort gte 3389) or ( FromPort lte 5432 and ToPort gte 5432) or ( FromPort lte 27019 and ToPort gte 27017) ) ] ] </td>
          </tr>
          
          <tr num="357">
            <!-- <td>357</td> -->
            <td>Ensure EC2 Instance does not have open ahsp port</td>
            <td>Ahsp Port 4333, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 4333 and ToPort gte 4333) ) ] ] </td>
          </tr>
          
          <tr num="358">
            <!-- <td>358</td> -->
            <td>Ensure EC2 Instance does not have open Alternative HTTP port</td>
            <td>Alternative HTTP Port 8888, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 8888 and ToPort gte 8888) ) ] ] </td>
          </tr>
          
          <tr num="359">
            <!-- <td>359</td> -->
            <td>Ensure EC2 Instance does not have open CIFS port</td>
            <td>CIFS Port 445, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 445 and ToPort gte 445) ) ] ] </td>
          </tr>
          
          <tr num="360">
            <!-- <td>360</td> -->
            <td>Ensure EC2 Instance does not have open fcp-addr-srvr1 port</td>
            <td>fcp-addr-srvr1 Port 5500, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5500 and ToPort gte 5500) ) ] ] </td>
          </tr>
          
          <tr num="361">
            <!-- <td>361</td> -->
            <td>Ensure EC2 Instance does not have open FTP port</td>
            <td>FTP Port 20 and 21, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 20 and ToPort gte 21) ) ] ] </td>
          </tr>
          
          <tr num="362">
            <!-- <td>362</td> -->
            <td>Ensure EC2 Instance does not have open IMAP port</td>
            <td>IMAP Port 143, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 143 and ToPort gte 143) ) ] ] </td>
          </tr>
          
          <tr num="363">
            <!-- <td>363</td> -->
            <td>Ensure EC2 Instance does not have open Legacy HTTP port</td>
            <td>Legacy HTTP Port 8088, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 8088 and ToPort gte 8088) ) ] ] </td>
          </tr>
          
          <tr num="364">
            <!-- <td>364</td> -->
            <td>Ensure EC2 Instance does not have open MySQL port</td>
            <td>MySQL Port 3306, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( (FromPort lte 3306 and ToPort gte 3306) ) ] ] </td>
          </tr>
          
          <tr num="365">
            <!-- <td>365</td> -->
            <td>Ensure EC2 Instance does not have open SQL Server port</td>
            <td>MySQL Port 1433, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1", "tcp") and ( (FromPort lte 1433 and ToPort gte 1434) ) ] ] </td>
          </tr>
          
          <tr num="366">
            <!-- <td>366</td> -->
            <td>Ensure EC2 Instance does not have open OpenSearch Dashboards port</td>
            <td>OpenSearch Dashboards Port 5601, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5601 and ToPort gte 5601) ) ] ] </td>
          </tr>
          
          <tr num="367">
            <!-- <td>367</td> -->
            <td>Ensure EC2 Instance does not have open OpenSearch port</td>
            <td>OpenSearch Port 9200 or 9300, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 9200 and ToPort gte 9200) or (FromPort lte 9300 and ToPort gte 9300) ) ] ] </td>
          </tr>
          
          <tr num="368">
            <!-- <td>368</td> -->
            <td>Ensure EC2 Instance does not have open POP3 port</td>
            <td>POP3 Port 110, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 110 and ToPort gte 110) ) ] ] </td>
          </tr>
          
          <tr num="369">
            <!-- <td>369</td> -->
            <td>Ensure EC2 Instance does not have open PostgreSQL port</td>
            <td>PostgreSQL Port 5432, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5432 and ToPort gte 5432) ) ] ] </td>
          </tr>
          
          <tr num="370">
            <!-- <td>370</td> -->
            <td>Ensure EC2 Instance does not have open Proxy port</td>
            <td>Proxy Port 8080, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 8080 and ToPort gte 8080) ) ] ] </td>
          </tr>
          
          <tr num="371">
            <!-- <td>371</td> -->
            <td>Ensure EC2 Instance does not have open RDP port</td>
            <td>RDP Port 3389, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","udp","tcp") and ( (FromPort lte 3389 and ToPort gte 3389) ) ] ] </td>
          </tr>
          
          <tr num="372">
            <!-- <td>372</td> -->
            <td>Ensure EC2 Instance does not have open RPC port</td>
            <td>RPC Port 135, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 135 and ToPort gte 135) ) ] ] </td>
          </tr>
          
          <tr num="373">
            <!-- <td>373</td> -->
            <td>Ensure EC2 Instance does not have open SMTP port</td>
            <td>SMTP Port 25, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 25 and ToPort gte 25) ) ] ] </td>
          </tr>
          
          <tr num="374">
            <!-- <td>374</td> -->
            <td>Ensure EC2 Instance does not have open SSH port</td>
            <td>SSH Port 22, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 22 and ToPort gte 22) ) ] ] </td>
          </tr>
          
          <tr num="375">
            <!-- <td>375</td> -->
            <td>Ensure EC2 Instance does not have open Telnet port</td>
            <td>Telnet Port 23, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 23 and ToPort gte 23) ) ] ] </td>
          </tr>
          
          <tr num="376">
            <!-- <td>376</td> -->
            <td>Ensure EC2 Instance does not have open Python web development frameworks port</td>
            <td>Python web development frameworks Port 5000, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 5000 and ToPort gte 5000) ) ] ] </td>
          </tr>
          
          <tr num="377">
            <!-- <td>377</td> -->
            <td>Ensure EC2 Instance does not have open Go, Node.js, and Ruby web development frameworks port</td>
            <td>Go, Node.js, and Ruby web development frameworks Port 3000, of an EC2 Instance, should not be open to public.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should not have SecurityGroups with [ InboundRules with [ IPRanges with [ IP isPublic () ] and Protocol in ("-1","tcp") and ( (FromPort lte 3000 and ToPort gte 3000) ) ] ] </td>
          </tr>
          
          <tr num="378">
            <!-- <td>378</td> -->
            <td>Amazon ECS task definitions should have secure networking modes and user definitions</td>
            <td>This control checks whether an active Amazon ECS task definition that has host networking mode also has privileged or user container definitions. The control fails for task definitions that have host network mode and container definitions where privileged=false or is empty and user=root or is empty</td>
            <td>
            
              ECS<br>
            
            </td>
            <td class="code">ECSTaskDefinition where NetworkMode eq "host" should have ContainerDefinitions with [ Privileged and User len () gt 0 and User neq "root" ] </td>
          </tr>
          
          <tr num="379">
            <!-- <td>379</td> -->
            <td>Amazon ECS services should not have public IP addresses assigned to them automatically</td>
            <td>This control checks whether Amazon ECS services are configured to automatically assign public IP addresses. A public IP address is an IP address that is reachable from the internet. If you launch your Amazon ECS instances with a public IP address, then your Amazon ECS instances are reachable from the internet. Amazon ECS services should not be publicly accessible, as this may allow unintended access to your container application servers</td>
            <td>
            
              ECS<br>
            
            </td>
            <td class="code">ECSCluster where Services with [ TaskDefinition . NetworkMode eq "awsvpc"] should have Services with [ TaskDefinition . NetworkMode eq "awsvpc" and AwsVPCConfiguration . AssignPublicIp neq "ENABLED" ] </td>
          </tr>
          
          <tr num="380">
            <!-- <td>380</td> -->
            <td>Amazon EFS should be configured to encrypt file data at rest using AWS KMS</td>
            <td>This control checks whether Amazon Elastic File System is configured to encrypt the file data using AWS KMS.</td>
            <td>
            
              EFS<br>
            
            </td>
            <td class="code">ElasticFileSystem should have Encrypted and KMSKey . Enabled </td>
          </tr>
          
          <tr num="381">
            <!-- <td>381</td> -->
            <td>Elastic Beanstalk environments should have enhanced health reporting enabled</td>
            <td>This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments.</td>
            <td>
            
              ElasticBeanstalk<br>
            
            </td>
            <td class="code">ElasticBeanstalk should have ConfigurationSettings with [ OptionSettings with [ OptionName eq "EnhancedHealthAuthEnabled" and Value eq "true" ] ] </td>
          </tr>
          
          <tr num="382">
            <!-- <td>382</td> -->
            <td>Elastic Beanstalk managed platform updates should be enabled</td>
            <td>This control checks whether managed platform updates are enabled for the Elastic Beanstalk environment.</td>
            <td>
            
              ElasticBeanstalk<br>
            
            </td>
            <td class="code">ElasticBeanstalk should have ConfigurationSettings with [ OptionSettings with [ OptionName eq "ManagedActionsEnabled" and Value eq "true" ] ] </td>
          </tr>
          
          <tr num="383">
            <!-- <td>383</td> -->
            <td>Classic Load Balancer listeners should be configured with HTTPS or TLS termination</td>
            <td>This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS protocol for front-end (client to load balancer) connections.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ClassicLoadBalancer where ( ListenerDescriptions len () gt 0 ) should have ListenerDescriptions with [ Listener . Protocol in ("HTTPS", "SSL") ] </td>
          </tr>
          
          <tr num="384">
            <!-- <td>384</td> -->
            <td>Application load balancers should be configured to drop HTTP headers</td>
            <td>This control evaluates AWS Application Load Balancers to ensure they are configured to drop invalid HTTP headers</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer where Type eq "application" should have RoutingHttpDropInvalidHeaderFieldsEnabled eq True </td>
          </tr>
          
          <tr num="385">
            <!-- <td>385</td> -->
            <td>Application Load Balancers logging should be enabled</td>
            <td>This control checks whether the Application Load Balancer have logging enabled</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer where Type eq "application" should have AccessLogsEnabled eq True </td>
          </tr>
          
          <tr num="386">
            <!-- <td>386</td> -->
            <td>Classic Load Balancers logging should be enabled</td>
            <td>This rule checks whether the Classic Load Balancer have logging enabled</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ClassicLoadBalancer should have Attributes . AccessLog . Enabled </td>
          </tr>
          
          <tr num="387">
            <!-- <td>387</td> -->
            <td>Ensure Deletion Protection is enabled on Elastic Load Balancer</td>
            <td>Enabling deletion protection on load balancers mitigates risks of accidental deletion.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have DeletionProtection </td>
          </tr>
          
          <tr num="388">
            <!-- <td>388</td> -->
            <td>Classic Load Balancers should have connection draining enabled</td>
            <td>This rule checks whether Classic Load Balancers have connection draining enabled. Enabling connection draining on Classic Load Balancers ensures that the load balancer stops sending requests to instances that are de-registering or unhealthy. It keeps the existing connections open. This is particularly useful for instances in Auto Scaling groups, to ensure that connections aren’t severed abruptly</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ClassicLoadBalancer should have Attributes . ConnectionDraining . Enabled </td>
          </tr>
          
          <tr num="389">
            <!-- <td>389</td> -->
            <td>Application Load Balancer should be configured to redirect all HTTP requests to HTTPS</td>
            <td>This control checks whether HTTP to HTTPS redirection is configured on all HTTP listeners of Application Load Balancers</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer where (Type eq "application" and Listeners with [ Protocol eq "HTTP" ]) should have Listeners with [ Protocol eq "HTTP" and DefaultActions with [ Type eq "redirect" and RedirectConfig . Protocol eq "HTTPS" and RedirectConfig . Port eq 443 ] ] </td>
          </tr>
          
          <tr num="390">
            <!-- <td>390</td> -->
            <td>Amazon EMR cluster master nodes should not have public IP addresses</td>
            <td>This control checks whether master nodes on Amazon EMR clusters have public IP addresses.</td>
            <td>
            
              EMR<br>
            
            </td>
            <td class="code">EMRCluster should not have Instances with [ PublicIpAddress isPublic() ] </td>
          </tr>
          
          <tr num="391">
            <!-- <td>391</td> -->
            <td>Elasticsearch domains should have encryption at rest enabled</td>
            <td>This control checks whether Elasticsearch domains have encryption at rest configuration enabled. The check fails if encryption at rest is not enabled.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have EncryptionAtRestOptions . Enabled </td>
          </tr>
          
          <tr num="392">
            <!-- <td>392</td> -->
            <td>Elasticsearch domains should be in a VPC</td>
            <td>This control checks whether Elasticsearch domains are in a VPC. It should be ensured that Elasticsearch domains are not attached to public subnets.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have VPCOptions . VPC . Status eq "available" </td>
          </tr>
          
          <tr num="393">
            <!-- <td>393</td> -->
            <td>Elasticsearch domains should encrypt data sent between nodes</td>
            <td>This control checks whether Elasticsearch domains have node-to-node encryption enabled.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have NodeToNodeEncryptionOptions . Enabled </td>
          </tr>
          
          <tr num="394">
            <!-- <td>394</td> -->
            <td>Elasticsearch domain error logging to CloudWatch Logs should be enabled</td>
            <td>This control checks whether Elasticsearch domains are configured to send error logs to CloudWatch Logs.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have LogPublishingOptions with [ Name eq "ES_APPLICATION_LOGS" and Enabled and CloudWatchLogsLogGroup . id len( ) gt 0 ] </td>
          </tr>
          
          <tr num="395">
            <!-- <td>395</td> -->
            <td>Elasticsearch domains should have audit logging enabled</td>
            <td>This control checks whether Elasticsearch domains have audit logging enabled. This control fails if an Elasticsearch domain does not have audit logging enabled.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have LogPublishingOptions with [ Name eq "AUDIT_LOGS" and Enabled and CloudWatchLogsLogGroup . id len( ) gt 0 ] </td>
          </tr>
          
          <tr num="396">
            <!-- <td>396</td> -->
            <td>Elasticsearch domains should have at least three data nodes</td>
            <td>This control checks whether Elasticsearch domains are configured with at least three data nodes and zoneAwarenessEnabled is true.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have ElasticsearchClusterConfig . ZoneAwarenessEnabled and ElasticsearchClusterConfig . ZoneAwarenessConfig . AvailabilityZoneCount gte 3 </td>
          </tr>
          
          <tr num="397">
            <!-- <td>397</td> -->
            <td>Elasticsearch domains should be configured with at least three dedicated master nodes</td>
            <td>This control checks whether Elasticsearch domains are configured with at least three dedicated master nodes. This control fails if the domain does not use dedicated master nodes.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have ElasticsearchClusterConfig . DedicatedMasterEnabled and ElasticsearchClusterConfig . DedicatedMasterCount gte 3 </td>
          </tr>
          
          <tr num="398">
            <!-- <td>398</td> -->
            <td>Connections to Elasticsearch domains should be encrypted using TLS 1.2</td>
            <td>This control checks whether connections to Elasticsearch domains are required to use TLS 1.2. The check fails if the Elasticsearch domain TLSSecurityPolicy is not Policy-Min-TLS-1-2-2019-07.</td>
            <td>
            
              ElasticSearch<br>
            
            </td>
            <td class="code">ElasticSearchDomain should have DomainEndpointOptions . TLSSecurityPolicy eq "Policy-Min-TLS-1-2-2019-07" </td>
          </tr>
          
          <tr num="399">
            <!-- <td>399</td> -->
            <td>GuardDuty should be enabled</td>
            <td>This control checks whether Amazon GuardDuty is enabled in your GuardDuty account and Region.</td>
            <td>
            
              GuardDuty<br>
            
            </td>
            <td class="code">GuardDutyDetector should have Status eq "ENABLED" </td>
          </tr>
          
          <tr num="400">
            <!-- <td>400</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="401">
            <!-- <td>401</td> -->
            <td>Ensure IAM Users Receive Permissions Only Through Groups</td>
            <td>IAM users are granted access to services, functions, and data through IAM policies. There are three ways to define policies for a user: 1) Edit the user policy directly, aka an inline, or user, policy; 2) attach a policy directly to a user; 3) add the user to an IAM group that has an attached policy. Only the third implementation is recommended.</td>
            <td>
            
              Identity<br>
            
            </td>
            <td class="code">IAMUser should have Policies . Managed len () eq 0 and Policies . Inline len () eq 0 </td>
          </tr>
          
          <tr num="402">
            <!-- <td>402</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="403">
            <!-- <td>403</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="404">
            <!-- <td>404</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="405">
            <!-- <td>405</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="406">
            <!-- <td>406</td> -->
            <td>Ensure proper user-authentication management for non-consumer users and administrators : IAM Weak Password Policy</td>
            <td>Passwords/passphrases must meet the following: Require a minimum length of at least seven characters. Contain both numeric and alphabetic characters. Alternatively, the passwords/passphrases must have complexity and strength at least equivalent to the parameters specified above</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have RequireUppercaseCharacters and RequireLowercaseCharacters and (MinimumPasswordLength gte 8 or RequireSymbols ) </td>
          </tr>
          
          <tr num="407">
            <!-- <td>407</td> -->
            <td>Ensure credentials unused for 45 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all credentials that have been unused in 45 or greater days be deactivated or removed</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have ( RootUser eq False and ( ( AccessKey with [ Active and LastUsedTime isEarlierThan ( -45, "days" ) ] ) or ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -45, "days" ) ) ) ) or ( RootUser eq False and ( ( AccessKey with [ Active and LastUsedTime eq 0 ] ) or ( Password . Enabled and Password . LastUsedTime eq 0 ) ) and CreationDate isEarlierThan ( -45, "days" ) ) </td>
          </tr>
          
          <tr num="408">
            <!-- <td>408</td> -->
            <td>IAM customer managed policies that you create should not allow wildcard actions for services</td>
            <td>This control checks whether the IAM identity-based policies that you create have Allow statements that use the * wildcard to grant permissions for all actions on any service</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where Type eq "Customer Managed" should not have Permissions . Statements with [ Effect eq "Allow" and ( NotAction with [ value like "\:\*$" ] or Action with [ value like "\:\*$" ] ) ] </td>
          </tr>
          
          <tr num="409">
            <!-- <td>409</td> -->
            <td>IAM customer managed policies should not allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the default version of IAM customer managed policies allow principals to use the AWS KMS decryption actions on all resources</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where Type eq "Customer Managed" should not have Permissions . Statements with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] </td>
          </tr>
          
          <tr num="410">
            <!-- <td>410</td> -->
            <td>IAM principals should not have IAM Group inline policies that allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the inline policies that are embedded in your IAM group allow the AWS KMS decryption and re-encryption actions on all KMS keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMGroup should not have GroupPolicy . InlinePolicies with [ PolicyDocument . Statement with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="411">
            <!-- <td>411</td> -->
            <td>IAM principals should not have IAM Role inline policies that allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the inline policies that are embedded in your IAM role allow the AWS KMS decryption and re-encryption actions on all KMS keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="412">
            <!-- <td>412</td> -->
            <td>IAM principals should not have IAM User inline policies that allow decryption and re-encryption actions on all KMS keys</td>
            <td>Checks whether the inline policies that are embedded in your IAM user allow the AWS KMS decryption and re-encryption actions on all KMS keys</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have Policies . Inline with [ PolicyDocument . Statements with [ Effect eq "Allow" and Action with [ value in ("kms:Decrypt", "kms:ReEncryptFrom") ] and Resource with [ value eq "*" ] ] ] </td>
          </tr>
          
          <tr num="413">
            <!-- <td>413</td> -->
            <td>AWS KMS keys should not be unintentionally deleted</td>
            <td>This control checks whether KMS keys are scheduled for deletion. KMS keys cannot be recovered once deleted. Data encrypted under a KMS key is also permanently unrecoverable if the KMS key is deleted. If meaningful data has been encrypted under a KMS key scheduled for deletion, consider decrypting the data or re-encrypting the data under a new KMS key unless you are intentionally performing a cryptographic erasure</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey should not have Status eq "PendingDeletion" </td>
          </tr>
          
          <tr num="414">
            <!-- <td>414</td> -->
            <td>Lambda function policies should prohibit public access</td>
            <td>This control checks whether the Lambda function resource-based policy prohibits public access outside of your account</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda should not have ResourceBasedIAMPolicy . Statements with [ Effect eq "Allow" and Principal with [ value eq "*"] ] </td>
          </tr>
          
          <tr num="415">
            <!-- <td>415</td> -->
            <td>Lambda function s3 invoked policies should prohibit public access</td>
            <td>This control checks whether the Lambda function resource-based s3 invoked policy prohibits public access outside of your account. The control also fails if a Lambda function is invoked from Amazon S3 and the policy does not include a condition for AWS:SourceAccount</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where ResourceBasedIAMPolicy . Statements with [ Action with [ value eq "lambda:InvokeFunction" ] and Principal with [ value eq "s3.amazonaws.com" ]] should have ResourceBasedIAMPolicy . Statements with [ Action with [ value eq "lambda:InvokeFunction" ] and Principal with [ value eq "s3.amazonaws.com" ] and Conditions with [ Name eq "AWS:SourceAccount" and Value len() gt 0 ]] </td>
          </tr>
          
          <tr num="416">
            <!-- <td>416</td> -->
            <td>Lambda functions should use supported runtimes</td>
            <td>This control checks that the Lambda function settings for runtimes match the expected values set for the supported runtimes for each language</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where PackageType neq "Image" should have Runtime in ("nodejs14.x", "nodejs12.x", "python3.9", "python3.8", "python3.7", "python3.6", "ruby2.7", "java11", "java8", "java8.al2", "go1.x", "dotnetcore3.1") </td>
          </tr>
          
          <tr num="417">
            <!-- <td>417</td> -->
            <td>Access permissions and authorizations: Ensure RDS Instances do not have Publicly Accessible Snapshots</td>
            <td>RDS Instances should not have publicly accessible snapshots.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have Snapshots with [ PubliclyAccessible ] </td>
          </tr>
          
          <tr num="418">
            <!-- <td>418</td> -->
            <td>Communications and control network protection: Ensure RDS instances are not in public subnets</td>
            <td>Ensure RDS instances are not in public subnets.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code"> RDSInstance should not have Access eq "Public" </td>
          </tr>
          
          <tr num="419">
            <!-- <td>419</td> -->
            <td>Data-at-rest is protected: Ensure RDS encryption is enabled</td>
            <td>Ensure RDS encryption is enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have StorageEncrypted eq true </td>
          </tr>
          
          <tr num="420">
            <!-- <td>420</td> -->
            <td>Data-at-rest is protected: Ensure RDS instance snapshots are encrypted</td>
            <td>Ensure RDS instance snapshots are encrypted.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have every Snapshots with [ Encrypted eq true ] </td>
          </tr>
          
          <tr num="421">
            <!-- <td>421</td> -->
            <td>Implement an incident response plan : Lack of Multi-AZ Deployment for RDS Instances</td>
            <td>Create the incident response plan to be implemented in the event of system breach. Ensure the plan addresses the following, at a minimum: Roles, responsibilities, and communication and contact strategies in the event of a compromise including notification of the payment brands, at a minimum. ; Specific incident response procedures. ; Business recovery and continuity procedures. ; Data backup processes. ; Analysis of legal requirements for reporting compromises. ; Coverage and responses of all critical system components. ;  Reference or inclusion of incident response procedures from the payment brands</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have MultiAZ eq true </td>
          </tr>
          
          <tr num="422">
            <!-- <td>422</td> -->
            <td>Ensure RDS database instances have detailed monitoring enabled</td>
            <td>Ensure RDS database instances have detailed monitoring enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have MonitoringInterval eq 0 </td>
          </tr>
          
          <tr num="423">
            <!-- <td>423</td> -->
            <td>RDS clusters should have deletion protection enabled</td>
            <td>This control checks whether RDS clusters have deletion protection enabled.</td>
            <td>
            
              RDSCluster<br>
            
            </td>
            <td class="code">RDSCluster should have DeletionProtection </td>
          </tr>
          
          <tr num="424">
            <!-- <td>424</td> -->
            <td>RDS DB instances should have deletion protection enabled</td>
            <td>This control checks whether your RDS DB instances that use one of the listed database engines have deletion protection enabled</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have DeletionProtection </td>
          </tr>
          
          <tr num="425">
            <!-- <td>425</td> -->
            <td>Database logging should be enabled</td>
            <td>This control checks whether the logs of Amazon RDS are enabled and sent to CloudWatch Logs</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have EnabledCloudwatchLogsExports len () gt 0 </td>
          </tr>
          
          <tr num="426">
            <!-- <td>426</td> -->
            <td>IAM authentication should be configured for RDS instances</td>
            <td>This control checks whether an RDS DB instance has IAM database authentication enabled</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have IAMDatabaseAuthenticationEnabled </td>
          </tr>
          
          <tr num="427">
            <!-- <td>427</td> -->
            <td>IAM authentication should be configured for RDS clusters</td>
            <td>This control checks whether an RDS DB cluster has IAM database authentication enabled.</td>
            <td>
            
              RDSCluster<br>
            
            </td>
            <td class="code">RDSCluster should have IAMDatabaseAuthenticationEnabled </td>
          </tr>
          
          <tr num="428">
            <!-- <td>428</td> -->
            <td>RDS automatic minor version upgrades should be enabled</td>
            <td>This control checks whether automatic minor version upgrades are enabled for the RDS database instance. Enabling automatic minor version upgrades ensures that the latest minor version updates to the relational database management system (RDBMS) are installed. These upgrades might include security patches and bug fixes. Keeping up to date with patch installation is an important step in securing systems</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have AutoMinorVersionUpgrade </td>
          </tr>
          
          <tr num="429">
            <!-- <td>429</td> -->
            <td>Amazon Aurora clusters should have backtracking enabled</td>
            <td>This control checks whether Amazon Aurora clusters have backtracking enabled</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSCluster where Engine eq "aurora-mysql" should have BacktrackWindow gt 0 </td>
          </tr>
          
          <tr num="430">
            <!-- <td>430</td> -->
            <td>RDS DB clusters should be configured for multiple Availability Zones</td>
            <td>This control checks whether high availability is enabled for your RDS DB clusters.</td>
            <td>
            
              RDSCluster<br>
            
            </td>
            <td class="code">RDSCluster should have MultiAZ eq true and AvailabilityZones len ( ) gt 0 </td>
          </tr>
          
          <tr num="431">
            <!-- <td>431</td> -->
            <td>RDS DB clusters should be configured to copy tags to snapshots</td>
            <td>This control checks whether RDS DB clusters are configured to copy all tags to snapshots when the snapshots are created</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSCluster should have CopyTagsToSnapshot </td>
          </tr>
          
          <tr num="432">
            <!-- <td>432</td> -->
            <td>RDS DB instances should be configured to copy tags to snapshots</td>
            <td>This control checks whether RDS DB instances are configured to copy all tags to snapshots when the snapshots are created</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have CopyTagsToSnapshot </td>
          </tr>
          
          <tr num="433">
            <!-- <td>433</td> -->
            <td>An RDS event notifications subscription should be configured for critical cluster events</td>
            <td>This control checks whether an Amazon RDS event subscription exists that has notifications enabled for the DBCluster source type with maintenance,failure event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-cluster" and (EventCategoriesList has ("maintenance") and EventCategoriesList has ("failure")) and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="434">
            <!-- <td>434</td> -->
            <td>An RDS event notifications subscription should be configured for critical database instance events</td>
            <td>This control checks whether an Amazon RDS event subscription exists with notifications enabled for the DBInstance source type with maintenance,configuration change,failure event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-instance" and (EventCategoriesList has ("maintenance") and EventCategoriesList has ("failure") and EventCategoriesList has("configuration change")) and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="435">
            <!-- <td>435</td> -->
            <td>An RDS event notifications subscription should be configured for critical database parameter group events</td>
            <td>This control checks whether an Amazon RDS event subscription exists with notifications enabled for the DBParameterGroup source type with configuration change event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-parameter-group" and EventCategoriesList has("configuration change") and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="436">
            <!-- <td>436</td> -->
            <td>An RDS event notifications subscription should be configured for critical database security group events</td>
            <td>This control checks whether an Amazon RDS event subscription exists with notifications enabled for the DBSecurityGroup source type with configuration change failure event category</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">AWS should have atleast one RDSEventSubscriptions with [ SourceType eq "db-security-group" and (EventCategoriesList has ("failure") and EventCategoriesList has("configuration change")) and Enabled and SnsTopic . Subscriptions len () gt 0 ] </td>
          </tr>
          
          <tr num="437">
            <!-- <td>437</td> -->
            <td>RDS clusters should not use a database engine default port</td>
            <td>This control checks whether the RDS cluster uses a port other than the default port of the database engine</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSCluster should not have Port eq 3306 </td>
          </tr>
          
          <tr num="438">
            <!-- <td>438</td> -->
            <td>Access permissions and authorizations: Ensure Redshift Clusters are not Publicly accessible</td>
            <td>Redshift Clusters should not be accessible to the public.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Access eq "Public" </td>
          </tr>
          
          <tr num="439">
            <!-- <td>439</td> -->
            <td>Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission: Redshift Cluster has require_ssl disabled</td>
            <td>Sensitive information must be encrypted during transmission over public networks, because it is easy and common for a malicious individual to intercept and/or divert data while in transit.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have ClusterParameterGroups with [ ClusterParameterGroup with [ ParameterName eq "require_ssl" and ParameterValue eq "true" ] ] </td>
          </tr>
          
          <tr num="440">
            <!-- <td>440</td> -->
            <td>Ensure automated snapshots are enabled for Redshift clusters</td>
            <td>Ensure automated snapshots are enabled for Redshift clusters.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AutomatedSnapshotRetentionPeriod gt 0 </td>
          </tr>
          
          <tr num="441">
            <!-- <td>441</td> -->
            <td>Implement automated audit trails for all system components : Redshift Parameter Groups Disable Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have LoggingEnabled eq true </td>
          </tr>
          
          <tr num="442">
            <!-- <td>442</td> -->
            <td>Vulnerability management plan: Ensure Allow Version Upgrade is set to yes for Redshift Cluster</td>
            <td>Redshift Clusters should have Version Upgrade set to avoid missing important security updates.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AllowVersionUpgrade </td>
          </tr>
          
          <tr num="443">
            <!-- <td>443</td> -->
            <td>Amazon Redshift clusters should use enhanced VPC routing</td>
            <td>This control checks whether an Amazon Redshift cluster has EnhancedVpcRouting enabled</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have EnhancedVpcRouting </td>
          </tr>
          
          <tr num="444">
            <!-- <td>444</td> -->
            <td>Ensure that S3 Buckets are configured with 'Block public access (bucket settings)'</td>
            <td>Amazon S3 provides Block public access (bucket settings) and Block public access (account settings) to help you manage public access to Amazon S3 resources. By default, S3 buckets and objects are created with public access disabled. However, an IAM principle with sufficient S3 permissions can enable public access at the bucket and/or object level. While enabled, Block public access (bucket settings) prevents an individual bucket, and its contained objects, from becoming publicly accessible. Similarly, Block public access (account settings) prevents all buckets, and contained objects, from becoming publicly accessible across the entire account.</td>
            <td>
            
              Storage<br>
            
            </td>
            <td class="code">S3Bucket should have BlockPublicAccess . BlockPublicAcls and BlockPublicAccess . IgnorePublicAcls and BlockPublicAccess . BlockPublicPolicy and BlockPublicAccess . RestrictPublicBuckets </td>
          </tr>
          
          <tr num="445">
            <!-- <td>445</td> -->
            <td>Ensure all S3 buckets employ encryption-at-rest</td>
            <td>Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have DefaultEncryption eq "Disabled" </td>
          </tr>
          
          <tr num="446">
            <!-- <td>446</td> -->
            <td>Ensure S3 Bucket Policy is set to deny HTTP requests</td>
            <td>At the Amazon S3 bucket level, you can configure permissions through a bucket policy making the objects accessible only through HTTPS</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have BucketPolicy with [Statement with [Effect eq "Deny" and Conditions with [Name eq "aws:SecureTransport" and Value has ("false") ]]] </td>
          </tr>
          
          <tr num="447">
            <!-- <td>447</td> -->
            <td>Ensure S3 Bucket is not publicly accessible.</td>
            <td>Ensure S3 Bucket is not publicly accessible</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have Access eq "Public" </td>
          </tr>
          
          <tr num="448">
            <!-- <td>448</td> -->
            <td>SNS topics should be encrypted at rest using AWS KMS</td>
            <td>This control checks whether an SNS topic is encrypted at rest using AWS KMS</td>
            <td>
            
              SNS<br>
            
            </td>
            <td class="code">SNSTopic should have KmsMasterKeyId len () gt 0 </td>
          </tr>
          
          <tr num="449">
            <!-- <td>449</td> -->
            <td>Amazon SQS queues should be encrypted at rest</td>
            <td>This control checks whether Amazon SQS queues are encrypted at rest</td>
            <td>
            
              SQS<br>
            
            </td>
            <td class="code">SQSQueue should have ( KmsMasterKeyId len ( ) gt 0 or SqsManagedSseEnabled ) </td>
          </tr>
          
          <tr num="450">
            <!-- <td>450</td> -->
            <td>SageMaker notebook instances should not have direct internet access</td>
            <td>This control checks whether direct internet access is disabled for an SageMaker notebook instance</td>
            <td>
            
              Compute<br>
            
            </td>
            <td class="code">SageMakerNotebookInstance should have DirectInternetAccess eq "Disabled" </td>
          </tr>
          
          <tr num="451">
            <!-- <td>451</td> -->
            <td>Secrets Manager secrets should have automatic rotation enabled</td>
            <td>This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret should have RotationEnabled </td>
          </tr>
          
          <tr num="452">
            <!-- <td>452</td> -->
            <td>Secrets Manager secrets configured with automatic rotation should rotate successfully</td>
            <td>This control checks whether an AWS Secrets Manager secret rotated successfully based on the rotation schedule. The control does not evaluate secrets that do not have rotation configured</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret where RotationEnabled should have RotationOccurringAsScheduled </td>
          </tr>
          
          <tr num="453">
            <!-- <td>453</td> -->
            <td>Remove unused Secrets Manager secrets</td>
            <td>This control checks whether your secrets have been accessed within a specified number of days. If a secret was not accessed within 90 days, this control fails</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret should have LastAccessedDate isLaterThan(-90, "days") </td>
          </tr>
          
          <tr num="454">
            <!-- <td>454</td> -->
            <td>Secrets Manager secrets should be rotated within a specified number of days</td>
            <td>This control checks whether your secrets have been rotated at least once within 90 days. Rotating secrets can help you to reduce the risk of an unauthorized use of your secrets in your AWS account. Examples include database credentials, passwords, third-party API keys, and even arbitrary text. If you do not change your secrets for a long period of time, the secrets are more likely to be compromised</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">Secret should have LastRotatedDate isLaterThan(-90, "days") </td>
          </tr>
          
          <tr num="455">
            <!-- <td>455</td> -->
            <td>EC2 instances should be managed by AWS Systems Manager</td>
            <td>This control checks whether the stopped and running EC2 instances in the account are managed by AWS Systems Manager. Systems Manager is an AWS service that can be used to view and control the AWS infrastructure.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance should have SSMInformation len () gt 0 </td>
          </tr>
          
          <tr num="456">
            <!-- <td>456</td> -->
            <td>All EC2 instances managed by Systems Manager should be compliant with patching requirements</td>
            <td>This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is COMPLIANT or NON_COMPLIANT after the patch installation on the instance. It only checks instances that are managed by Systems Manager Patch Manager.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where SSMInformation len() gt 0 and ComplianceSummaryItems with [ ComplianceType eq "Patch" ] should have ComplianceSummaryItems with [ ComplianceType eq "Patch" and NonCompliantSummary . NonCompliantCount eq 0 ] </td>
          </tr>
          
          <tr num="457">
            <!-- <td>457</td> -->
            <td>Instances managed by Systems Manager should have an association compliance status of COMPLIANT</td>
            <td>This control checks whether the status of the AWS Systems Manager association compliance is COMPLIANT or NON_COMPLIANT after the association is run on an instance. The control passes if the association compliance status is COMPLIANT.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">EC2Instance where SSMInformation len() gt 0 and ComplianceSummaryItems with [ ComplianceType eq "Association" ] should have ComplianceSummaryItems with [ ComplianceType eq "Association" and NonCompliantSummary . NonCompliantCount eq 0 ] </td>
          </tr>
          
          <tr num="458">
            <!-- <td>458</td> -->
            <td>AWS WAF Classic global web ACL logging should be enabled</td>
            <td>This control checks if logging is enabled on AWS Web Application Firewall (WAF) classic global web ACLs. This rule is NON_COMPLIANT for a global web ACL, if it does not have logging enabled.</td>
            <td>
            
              Security<br>
            
            </td>
            <td class="code">WebACL should have LoggingConfiguration . LogDestinationConfigs len( ) gt 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GDPR">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="459">
            <!-- <td>459</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="460">
            <!-- <td>460</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="461">
            <!-- <td>461</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="462">
            <!-- <td>462</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="463">
            <!-- <td>463</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="464">
            <!-- <td>464</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="465">
            <!-- <td>465</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="466">
            <!-- <td>466</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="467">
            <!-- <td>467</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="468">
            <!-- <td>468</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="469">
            <!-- <td>469</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="470">
            <!-- <td>470</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="471">
            <!-- <td>471</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="472">
            <!-- <td>472</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="473">
            <!-- <td>473</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="474">
            <!-- <td>474</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="475">
            <!-- <td>475</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="476">
            <!-- <td>476</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="477">
            <!-- <td>477</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="478">
            <!-- <td>478</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="479">
            <!-- <td>479</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="480">
            <!-- <td>480</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="481">
            <!-- <td>481</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="482">
            <!-- <td>482</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="483">
            <!-- <td>483</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="484">
            <!-- <td>484</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="485">
            <!-- <td>485</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="486">
            <!-- <td>486</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="487">
            <!-- <td>487</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="HIPAA">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="488">
            <!-- <td>488</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="489">
            <!-- <td>489</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="490">
            <!-- <td>490</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="491">
            <!-- <td>491</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="492">
            <!-- <td>492</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="493">
            <!-- <td>493</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="494">
            <!-- <td>494</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="495">
            <!-- <td>495</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="496">
            <!-- <td>496</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="497">
            <!-- <td>497</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="498">
            <!-- <td>498</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="499">
            <!-- <td>499</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="500">
            <!-- <td>500</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="501">
            <!-- <td>501</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="502">
            <!-- <td>502</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="503">
            <!-- <td>503</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="504">
            <!-- <td>504</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="505">
            <!-- <td>505</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="506">
            <!-- <td>506</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="507">
            <!-- <td>507</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="508">
            <!-- <td>508</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="509">
            <!-- <td>509</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="510">
            <!-- <td>510</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="511">
            <!-- <td>511</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="512">
            <!-- <td>512</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="513">
            <!-- <td>513</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="514">
            <!-- <td>514</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="515">
            <!-- <td>515</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="ISO27K">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="516">
            <!-- <td>516</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="517">
            <!-- <td>517</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="518">
            <!-- <td>518</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="519">
            <!-- <td>519</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="520">
            <!-- <td>520</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="521">
            <!-- <td>521</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="522">
            <!-- <td>522</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="523">
            <!-- <td>523</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="524">
            <!-- <td>524</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="525">
            <!-- <td>525</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="526">
            <!-- <td>526</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="527">
            <!-- <td>527</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="528">
            <!-- <td>528</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="529">
            <!-- <td>529</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="530">
            <!-- <td>530</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="531">
            <!-- <td>531</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="532">
            <!-- <td>532</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="533">
            <!-- <td>533</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="534">
            <!-- <td>534</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="535">
            <!-- <td>535</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="536">
            <!-- <td>536</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="537">
            <!-- <td>537</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="538">
            <!-- <td>538</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="539">
            <!-- <td>539</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="540">
            <!-- <td>540</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="541">
            <!-- <td>541</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="542">
            <!-- <td>542</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="543">
            <!-- <td>543</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="544">
            <!-- <td>544</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="545">
            <!-- <td>545</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="546">
            <!-- <td>546</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="547">
            <!-- <td>547</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="548">
            <!-- <td>548</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="549">
            <!-- <td>549</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="550">
            <!-- <td>550</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="551">
            <!-- <td>551</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="552">
            <!-- <td>552</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="553">
            <!-- <td>553</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="554">
            <!-- <td>554</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="555">
            <!-- <td>555</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="556">
            <!-- <td>556</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="557">
            <!-- <td>557</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="558">
            <!-- <td>558</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="559">
            <!-- <td>559</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="560">
            <!-- <td>560</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="561">
            <!-- <td>561</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="562">
            <!-- <td>562</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="563">
            <!-- <td>563</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="564">
            <!-- <td>564</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="565">
            <!-- <td>565</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="566">
            <!-- <td>566</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="567">
            <!-- <td>567</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="568">
            <!-- <td>568</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="569">
            <!-- <td>569</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="570">
            <!-- <td>570</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="571">
            <!-- <td>571</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="572">
            <!-- <td>572</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="573">
            <!-- <td>573</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="574">
            <!-- <td>574</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="575">
            <!-- <td>575</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="576">
            <!-- <td>576</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="577">
            <!-- <td>577</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="578">
            <!-- <td>578</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="579">
            <!-- <td>579</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="580">
            <!-- <td>580</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with iam:PassRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "iam:PassRole" ] and Resource with [ value eq "*" ] ] </td>
          </tr>
          
          <tr num="581">
            <!-- <td>581</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with sts:AssumeRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have AssumeRolePolicy . Statement with [ Action eq "sts:AssumeRole" and Principal . AWS has ("*") ] </td>
          </tr>
          
          <tr num="582">
            <!-- <td>582</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to All Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] </td>
          </tr>
          
          <tr num="583">
            <!-- <td>583</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to Authenticated Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . Type eq "Group" and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AuthenticatedUsers" ] </td>
          </tr>
          
          <tr num="584">
            <!-- <td>584</td> -->
            <td>Access permissions and authorizations: Ensure Redshift Clusters are not Publicly accessible</td>
            <td>Redshift Clusters should not be accessible to the public.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should not have Access eq "Public" </td>
          </tr>
          
          <tr num="585">
            <!-- <td>585</td> -->
            <td>Access permissions and authorizations: Ensure RDS Instances do not have Publicly Accessible Snapshots</td>
            <td>RDS Instances should not have publicly accessible snapshots.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have Snapshots with [ PubliclyAccessible ] </td>
          </tr>
          
          <tr num="586">
            <!-- <td>586</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="587">
            <!-- <td>587</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="588">
            <!-- <td>588</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="589">
            <!-- <td>589</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="590">
            <!-- <td>590</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="591">
            <!-- <td>591</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="592">
            <!-- <td>592</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="593">
            <!-- <td>593</td> -->
            <td>Establish an access control system(s) : Inadequate Access Controls on S3 Buckets</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket where BucketVersioning . Status eq "Enabled" should not have BucketVersioning . MFADelete eq "Disabled" </td>
          </tr>
          
          <tr num="594">
            <!-- <td>594</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="595">
            <!-- <td>595</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="596">
            <!-- <td>596</td> -->
            <td>Data-at-rest is protected: Ensure RDS encryption is enabled</td>
            <td>Ensure RDS encryption is enabled.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have StorageEncrypted eq true </td>
          </tr>
          
          <tr num="597">
            <!-- <td>597</td> -->
            <td>Data-at-rest is protected: Ensure RDS instance snapshots are encrypted</td>
            <td>Ensure RDS instance snapshots are encrypted.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have every Snapshots with [ Encrypted eq true ] </td>
          </tr>
          
          <tr num="598">
            <!-- <td>598</td> -->
            <td>Data-at-rest is protected: Ensure DynamoDB tables are encrypted at rest</td>
            <td>Ensure DynamoDB tables are encrypted at rest.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have SSEDescription . Status eq "ENABLED" </td>
          </tr>
          
          <tr num="599">
            <!-- <td>599</td> -->
            <td>Render PAN unreadable anywhere it is stored : Redshift Cluster Not Encrypted At Rest</td>
            <td>Render PAN unreadable anywhere it is stored (including on portable digital media, backup media, and in logs) by using any of the following approaches: One-way hashes based on strong cryptography, (hash must be of the entire PAN). ; Truncation (hashing cannot be used to replace the truncated segment of PAN). ; Index tokens and pads (pads must be securely stored). ; Strong cryptography with associated key-management processes and procedures. ; Note: It is a relatively trivial effort for a malicious individual to reconstruct original PAN date if they have access to both the truncated and hashed version of a PAN. Where hashed and truncated versions of the same PAN are present in an entity’s environment, additional controls must be in place to ensure that the hashed and truncated versions cannot be correlated to reconstruct the original PAN</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have Encrypted eq true </td>
          </tr>
          
          <tr num="600">
            <!-- <td>600</td> -->
            <td>Data-in-transit is protected: Ensure older SSL/TLS policies are not used with Elastic Load Balancers</td>
            <td>Older SSL/TLS policy should not be used with Elastic Load Balancer Security Policy.</td>
            <td>
            
              ElasticLoadBalancer<br>
            
            </td>
            <td class="code">ElasticLoadBalancer should have SslPolicy in ( "ELBSecurityPolicy-2016-08", "ELBSecurityPolicy-TLS-1-2-2017-01", "ELBSecurityPolicy-TLS-1-1-2017-01" ) </td>
          </tr>
          
          <tr num="601">
            <!-- <td>601</td> -->
            <td>Data-in-transit is protected: Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>Ensure encryption in transit is enabled for lambda functions using environmental variables.</td>
            <td>
            
              Lambda<br>
            
            </td>
            <td class="code">Lambda where ( Environment len() > 0 ) should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="602">
            <!-- <td>602</td> -->
            <td>Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission: Redshift Cluster has require_ssl disabled</td>
            <td>Sensitive information must be encrypted during transmission over public networks, because it is easy and common for a malicious individual to intercept and/or divert data while in transit.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have ClusterParameterGroups with [ ClusterParameterGroup with [ ParameterName eq "require_ssl" and ParameterValue eq "true" ] ] </td>
          </tr>
          
          <tr num="603">
            <!-- <td>603</td> -->
            <td>Backups of information: Ensure Backup Retention Period is set greater than or equal to 30 days.</td>
            <td>Setting Backup Retention Period of RDS Instance to a value greater than or equal to 30 ensures safety of data.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should not have BackupRetentionPeriod lt 30 </td>
          </tr>
          
          <tr num="604">
            <!-- <td>604</td> -->
            <td>Backups of information: Ensure DynamoDB tables are backed up</td>
            <td>Ensure DynamoDB tables are backed up.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have BackedUp eq true </td>
          </tr>
          
          <tr num="605">
            <!-- <td>605</td> -->
            <td>Backups of information: Ensure DynamoDB tables have point in time recovery enabled</td>
            <td>Ensure DynamoDB tables have point in time recovery enabled.</td>
            <td>
            
              Dynamo<br>
            
            </td>
            <td class="code">DynamoDBTable should have PointInTimeRecovery eq "ENABLED" </td>
          </tr>
          
          <tr num="606">
            <!-- <td>606</td> -->
            <td>Install critical security patches within one month of release. : Auto Minor Version Upgrade Disabled for RDS Instances</td>
            <td>Ensure that all system components and software are protected from known vulnerabilities by installing applicable AWS RDSInstance security patches. Install critical security patches within one month of release.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have AutoMinorVersionUpgrade eq true </td>
          </tr>
          
          <tr num="607">
            <!-- <td>607</td> -->
            <td>Vulnerability management plan: Ensure Allow Version Upgrade is set to yes for Redshift Cluster</td>
            <td>Redshift Clusters should have Version Upgrade set to avoid missing important security updates.</td>
            <td>
            
              Redshift<br>
            
            </td>
            <td class="code">RedShiftCluster should have AllowVersionUpgrade </td>
          </tr>
          
          <tr num="608">
            <!-- <td>608</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="609">
            <!-- <td>609</td> -->
            <td>Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . Access eq "Public" </td>
          </tr>
          
          <tr num="610">
            <!-- <td>610</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="611">
            <!-- <td>611</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="612">
            <!-- <td>612</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="613">
            <!-- <td>613</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="614">
            <!-- <td>614</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="615">
            <!-- <td>615</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="616">
            <!-- <td>616</td> -->
            <td>Implement automated audit trails for all system components :  CloudTrail - Lack of Global Service Event Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have GlobalServiceEvents eq true </td>
          </tr>
          
          <tr num="617">
            <!-- <td>617</td> -->
            <td>Implement automated audit trails for all system components : Lack of Logging For Access to S3 Buckets</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have LoggingEnabled </td>
          </tr>
          
          <tr num="618">
            <!-- <td>618</td> -->
            <td>Implement automated audit trails for all system components : S3 Buckets Lack Versioning</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketVersioning . Status eq "Suspended" or BucketVersioning . Status eq "Disabled" </td>
          </tr>
          
          <tr num="619">
            <!-- <td>619</td> -->
            <td>Implement automated audit trails for all system components : Redshift Parameter Groups Disable Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have LoggingEnabled eq true </td>
          </tr>
          
          <tr num="620">
            <!-- <td>620</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="621">
            <!-- <td>621</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="622">
            <!-- <td>622</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="623">
            <!-- <td>623</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="624">
            <!-- <td>624</td> -->
            <td>Review firewall and router rule sets at least every six months : Numerous Unused EC2 Security Groups</td>
            <td>Establish and implement firewall and router configuration standards that include the requirement to review firewall and router rule sets at least every six months.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name neq "default" should have NetworkInterfaces len ( ) neq 0 </td>
          </tr>
          
          <tr num="625">
            <!-- <td>625</td> -->
            <td>Restrict inbound and outbound traffic to that which is necessary for the cardholder data environment, and specifically deny all other traffic : Do not use the default security group.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ Name eq "default" ] </td>
          </tr>
          
          <tr num="626">
            <!-- <td>626</td> -->
            <td>Do not allow unauthorized outbound traffic from the cardholder data environment to the Internet : Outbound Internet unrestricted is not allowed.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ OutboundRules with [ IPv6Ranges with [ IPv6 in ( "::/0" ) ] or IPRanges with [ IP in ( "0.0.0.0/0" ) ] ] ] </td>
          </tr>
          
          <tr num="627">
            <!-- <td>627</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in default Network ACL</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL should not have IsDefault eq true and Rules with [ RuleAction eq "allow" and Protocol eq "-1" and Egress eq False and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="628">
            <!-- <td>628</td> -->
            <td>Communications and control network protection: Ensure no rule exists which allows all ingress traffic in Network ACL which is associated with a subnet</td>
            <td>Network ACLs are designed to provide a secondary layer of security. Adding a rule that allows all network traffic (all protocols, IPs, and source) prior to any deny rule defeats the purpose of network ACLs. Network ACLs associated with subnets and VPCs should not allow all ingress traffic.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkACL where Subnets len( ) gt 0 should not have Rules with [ Egress eq False and RuleAction eq "allow" and Protocol eq "-1" and CidrBlock eq 0.0.0.0/0 ] </td>
          </tr>
          
          <tr num="629">
            <!-- <td>629</td> -->
            <td>Communications and control network protection: Ensure RDS instances are not in public subnets</td>
            <td>Ensure RDS instances are not in public subnets.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code"> RDSInstance should not have Access eq "Public" </td>
          </tr>
          
          <tr num="630">
            <!-- <td>630</td> -->
            <td>Implement an incident response plan : Lack of Multi-AZ Deployment for RDS Instances</td>
            <td>Create the incident response plan to be implemented in the event of system breach. Ensure the plan addresses the following, at a minimum: Roles, responsibilities, and communication and contact strategies in the event of a compromise including notification of the payment brands, at a minimum. ; Specific incident response procedures. ; Business recovery and continuity procedures. ; Data backup processes. ; Analysis of legal requirements for reporting compromises. ; Coverage and responses of all critical system components. ;  Reference or inclusion of incident response procedures from the payment brands</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have MultiAZ eq true </td>
          </tr>
          
          <tr num="631">
            <!-- <td>631</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="632">
            <!-- <td>632</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST800-53">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="633">
            <!-- <td>633</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="634">
            <!-- <td>634</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="635">
            <!-- <td>635</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="636">
            <!-- <td>636</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="637">
            <!-- <td>637</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="638">
            <!-- <td>638</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="639">
            <!-- <td>639</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="640">
            <!-- <td>640</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="641">
            <!-- <td>641</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="642">
            <!-- <td>642</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="643">
            <!-- <td>643</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="644">
            <!-- <td>644</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="645">
            <!-- <td>645</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="646">
            <!-- <td>646</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="647">
            <!-- <td>647</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="648">
            <!-- <td>648</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="649">
            <!-- <td>649</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="650">
            <!-- <td>650</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="651">
            <!-- <td>651</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="652">
            <!-- <td>652</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="653">
            <!-- <td>653</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="654">
            <!-- <td>654</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="655">
            <!-- <td>655</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="656">
            <!-- <td>656</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="657">
            <!-- <td>657</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="658">
            <!-- <td>658</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="659">
            <!-- <td>659</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="660">
            <!-- <td>660</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="661">
            <!-- <td>661</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="662">
            <!-- <td>662</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="663">
            <!-- <td>663</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="664">
            <!-- <td>664</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="665">
            <!-- <td>665</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="666">
            <!-- <td>666</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="667">
            <!-- <td>667</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="668">
            <!-- <td>668</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="669">
            <!-- <td>669</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="670">
            <!-- <td>670</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="671">
            <!-- <td>671</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="672">
            <!-- <td>672</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="673">
            <!-- <td>673</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="674">
            <!-- <td>674</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="675">
            <!-- <td>675</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="676">
            <!-- <td>676</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="PCI">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="677">
            <!-- <td>677</td> -->
            <td>Review firewall and router rule sets at least every six months : Numerous Unused EC2 Security Groups</td>
            <td>Establish and implement firewall and router configuration standards that include the requirement to review firewall and router rule sets at least every six months.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name neq "default" should have NetworkInterfaces len ( ) neq 0 </td>
          </tr>
          
          <tr num="678">
            <!-- <td>678</td> -->
            <td>Restrict inbound and outbound traffic to that which is necessary for the cardholder data environment, and specifically deny all other traffic : Do not use the default security group.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ Name eq "default" ] </td>
          </tr>
          
          <tr num="679">
            <!-- <td>679</td> -->
            <td>Inbound Internet traffic is not allowed</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage. This rule specifically checks for public IPs in inbound rules of Security Group.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ InboundRules with [ IPv6Ranges with [ IPv6 isPublic ( ) ] or IPRanges with [ IP isPublic ( ) ] ] ] </td>
          </tr>
          
          <tr num="680">
            <!-- <td>680</td> -->
            <td>Inbound All ports/protocols is not allowed</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage. This rule specifically checks for security group inbound rule with all ports open.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ Protocol eq "-1" and ( FromPort eq 0 and ToPort eq 65535 ) ] </td>
          </tr>
          
          <tr num="681">
            <!-- <td>681</td> -->
            <td>Do not allow unauthorized outbound traffic from the cardholder data environment to the Internet : Outbound Internet unrestricted is not allowed.</td>
            <td>Build firewall and router configurations that restrict connections between untrusted networks and any system components in the cardholder data environment. Note: An untrusted network is any network that is external to the networks belonging to the entity under review, and/or which is out of the entity’s ability to control or manage</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">NetworkInterface should not have any SecurityGroups with [ OutboundRules with [ IPv6Ranges with [ IPv6 in ( "::/0" ) ] or IPRanges with [ IP in ( "0.0.0.0/0" ) ] ] ] </td>
          </tr>
          
          <tr num="682">
            <!-- <td>682</td> -->
            <td>Render PAN unreadable anywhere it is stored : Weak RDS backup policy</td>
            <td>Render PAN unreadable anywhere it is stored (including on portable digital media, backup media, and in logs) by using any of the following approaches: One-way hashes based on strong cryptography, (hash must be of the entire PAN). ; Truncation (hashing cannot be used to replace the truncated segment of PAN). ; Index tokens and pads (pads must be securely stored). ; Strong cryptography with associated key-management processes and procedures. ; Note: It is a relatively trivial effort for a malicious individual to reconstruct original PAN date if they have access to both the truncated and hashed version of a PAN. Where hashed and truncated versions of the same PAN are present in an entity’s environment, additional controls must be in place to ensure that the hashed and truncated versions cannot be correlated to reconstruct the original PAN</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have BackupRetentionPeriod neq 0 </td>
          </tr>
          
          <tr num="683">
            <!-- <td>683</td> -->
            <td>Render PAN unreadable anywhere it is stored : Redshift Cluster Not Encrypted At Rest</td>
            <td>Render PAN unreadable anywhere it is stored (including on portable digital media, backup media, and in logs) by using any of the following approaches: One-way hashes based on strong cryptography, (hash must be of the entire PAN). ; Truncation (hashing cannot be used to replace the truncated segment of PAN). ; Index tokens and pads (pads must be securely stored). ; Strong cryptography with associated key-management processes and procedures. ; Note: It is a relatively trivial effort for a malicious individual to reconstruct original PAN date if they have access to both the truncated and hashed version of a PAN. Where hashed and truncated versions of the same PAN are present in an entity’s environment, additional controls must be in place to ensure that the hashed and truncated versions cannot be correlated to reconstruct the original PAN</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have Encrypted eq true </td>
          </tr>
          
          <tr num="684">
            <!-- <td>684</td> -->
            <td>Fully document and implement all key-management processes and procedures for cryptographic keys used for encryption of cardholder data : Lack of Access Key Rotation</td>
            <td>Cryptographic key changes for keys that have reached the end of their cryptoperiod  (for example, after a defined period of time has passed and/or after a certain amount of cipher-text has been produced by a given key), as defined by the AWS or key owner, and based on industry best practices and guidelines (for example, NIST Special Publication 800-57).</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and CreatedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="685">
            <!-- <td>685</td> -->
            <td>Use strong cryptography and security protocols to safeguard sensitive cardholder data during transmission: Redshift Cluster has require_ssl disabled</td>
            <td>Sensitive information must be encrypted during transmission over public networks, because it is easy and common for a malicious individual to intercept and/or divert data while in transit.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have ClusterParameterGroups with [ ClusterParameterGroup with [ ParameterName eq "require_ssl" and ParameterValue eq "true" ] ] </td>
          </tr>
          
          <tr num="686">
            <!-- <td>686</td> -->
            <td>Install critical security patches within one month of release. : Auto Minor Version Upgrade Disabled for RDS Instances</td>
            <td>Ensure that all system components and software are protected from known vulnerabilities by installing applicable AWS RDSInstance security patches. Install critical security patches within one month of release.</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have AutoMinorVersionUpgrade eq true </td>
          </tr>
          
          <tr num="687">
            <!-- <td>687</td> -->
            <td>Restrict access to cardholder data : IAM Policies with Effect as Allow and Action with iam:PassRole for All Roles</td>
            <td>Limit access to system components and cardholder data to only those individuals whose job requires such access.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have Policies . Inline with [ PolicyDocument . Statements with [ Action with [ value eq "iam:PassRole" ]]] </td>
          </tr>
          
          <tr num="688">
            <!-- <td>688</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with iam:PassRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "iam:PassRole" ] and Resource with [ value eq "*" ] ] </td>
          </tr>
          
          <tr num="689">
            <!-- <td>689</td> -->
            <td>Establish an access control system(s) : Inadequate Access Controls on S3 Buckets</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket where BucketVersioning . Status eq "Enabled" should not have BucketVersioning . MFADelete eq "Disabled" </td>
          </tr>
          
          <tr num="690">
            <!-- <td>690</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect as Allow and Action with sts:AssumeRole for All Roles</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMRole should not have AssumeRolePolicy . Statement with [ Action eq "sts:AssumeRole" and Principal . AWS has ("*") ] </td>
          </tr>
          
          <tr num="691">
            <!-- <td>691</td> -->
            <td>Establish an access control system(s) : IAM Headless User Account with Password</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have ( atleast one AccessKey with [ Active eq true ] and Password . Enabled eq True ) </td>
          </tr>
          
          <tr num="692">
            <!-- <td>692</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to All Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] </td>
          </tr>
          
          <tr num="693">
            <!-- <td>693</td> -->
            <td>Establish an access control system(s) : S3 Bucket ACLs with Grant Access to Authenticated Users</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee . Type eq "Group" and Grantee . URI eq "http://acs.amazonaws.com/groups/global/AuthenticatedUsers" ] </td>
          </tr>
          
          <tr num="694">
            <!-- <td>694</td> -->
            <td>Establish an access control system(s) : IAM Policies with Effect Allow and NotActions</td>
            <td>Establish an access control system(s) for systems components that restricts access based on a user’s need to know, and is set to “deny all” unless specifically allowed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Effect eq "Allow" and ( NotAction len ( ) gt 0 or Action with [ value eq "*" ] ) ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="695">
            <!-- <td>695</td> -->
            <td>Remove/disable inactive user accounts within 90 days</td>
            <td>Define and implement policies and procedures to ensure proper user identification management for non-consumer users and administrators on all system components.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq false should not have ( ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) or ( AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] ) ) </td>
          </tr>
          
          <tr num="696">
            <!-- <td>696</td> -->
            <td>Ensure proper user-authentication management for non-consumer users and administrators : IAM Weak Password Policy</td>
            <td>Passwords/passphrases must meet the following: Require a minimum length of at least seven characters. Contain both numeric and alphabetic characters. Alternatively, the passwords/passphrases must have complexity and strength at least equivalent to the parameters specified above</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have RequireUppercaseCharacters and RequireLowercaseCharacters and (MinimumPasswordLength gte 8 or RequireSymbols ) </td>
          </tr>
          
          <tr num="697">
            <!-- <td>697</td> -->
            <td>Secure all individual non-console administrative access and all remote access using multi-factor authentication : IAM Users Lack Multi-Factor Authentication</td>
            <td>Incorporate multi-factor authentication for all remote network access (both user and administrator, and including third party access for support or maintenance) originating from outside the entity’s network</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should have MFAActive eq true </td>
          </tr>
          
          <tr num="698">
            <!-- <td>698</td> -->
            <td>Implement automated audit trails for all system components :  CloudTrail - Lack of Global Service Event Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have GlobalServiceEvents eq true </td>
          </tr>
          
          <tr num="699">
            <!-- <td>699</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="700">
            <!-- <td>700</td> -->
            <td>Implement automated audit trails for all system components : Lack of Logging For Access to S3 Buckets</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should have LoggingEnabled </td>
          </tr>
          
          <tr num="701">
            <!-- <td>701</td> -->
            <td>Implement automated audit trails for all system components : S3 Buckets Lack Versioning</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
            </td>
            <td class="code">S3Bucket should not have BucketVersioning . Status eq "Suspended" or BucketVersioning . Status eq "Disabled" </td>
          </tr>
          
          <tr num="702">
            <!-- <td>702</td> -->
            <td>Implement automated audit trails for all system components : Redshift Parameter Groups Disable Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              RedShift<br>
            
            </td>
            <td class="code">RedShiftCluster should have LoggingEnabled eq true </td>
          </tr>
          
          <tr num="703">
            <!-- <td>703</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="704">
            <!-- <td>704</td> -->
            <td>Implement an incident response plan : Lack of Multi-AZ Deployment for RDS Instances</td>
            <td>Create the incident response plan to be implemented in the event of system breach. Ensure the plan addresses the following, at a minimum: Roles, responsibilities, and communication and contact strategies in the event of a compromise including notification of the payment brands, at a minimum. ; Specific incident response procedures. ; Business recovery and continuity procedures. ; Data backup processes. ; Analysis of legal requirements for reporting compromises. ; Coverage and responses of all critical system components. ;  Reference or inclusion of incident response procedures from the payment brands</td>
            <td>
            
              RDS<br>
            
            </td>
            <td class="code">RDSInstance should have MultiAZ eq true </td>
          </tr>
          
          <tr num="705">
            <!-- <td>705</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="706">
            <!-- <td>706</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="707">
            <!-- <td>707</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="708">
            <!-- <td>708</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="709">
            <!-- <td>709</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="710">
            <!-- <td>710</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="711">
            <!-- <td>711</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="712">
            <!-- <td>712</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="713">
            <!-- <td>713</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="714">
            <!-- <td>714</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="715">
            <!-- <td>715</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="716">
            <!-- <td>716</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="717">
            <!-- <td>717</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="718">
            <!-- <td>718</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="719">
            <!-- <td>719</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="720">
            <!-- <td>720</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="721">
            <!-- <td>721</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="722">
            <!-- <td>722</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="723">
            <!-- <td>723</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="724">
            <!-- <td>724</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="725">
            <!-- <td>725</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="726">
            <!-- <td>726</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="727">
            <!-- <td>727</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="728">
            <!-- <td>728</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="729">
            <!-- <td>729</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="730">
            <!-- <td>730</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="731">
            <!-- <td>731</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="732">
            <!-- <td>732</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="733">
            <!-- <td>733</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="734">
            <!-- <td>734</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="735">
            <!-- <td>735</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="736">
            <!-- <td>736</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="737">
            <!-- <td>737</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="738">
            <!-- <td>738</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="739">
            <!-- <td>739</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="740">
            <!-- <td>740</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="741">
            <!-- <td>741</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="742">
            <!-- <td>742</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="743">
            <!-- <td>743</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="744">
            <!-- <td>744</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="745">
            <!-- <td>745</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="746">
            <!-- <td>746</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="SOC2">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="747">
            <!-- <td>747</td> -->
            <td>Identities and credentials: Avoid the use of the "root" account: check for recent logins.</td>
            <td>The 'root' account has unrestricted access to all resources in the AWS account. It is highly recommended that the use of this account be avoided.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have Password . LastUsedTime isLaterThan ( -1, "days" ) </td>
          </tr>
          
          <tr num="748">
            <!-- <td>748</td> -->
            <td>Authentication: Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password</td>
            <td>Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. It is recommended that MFA be enabled for all accounts that have a console password.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where ( RootUser eq false and Password . Enabled eq true ) should have MFAActive eq true </td>
          </tr>
          
          <tr num="749">
            <!-- <td>749</td> -->
            <td>Identities and credentials: Ensure passwords unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all passwords that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have ( Password . Enabled and Password . LastUsedTime isEarlierThan ( -90, "days" ) ) </td>
          </tr>
          
          <tr num="750">
            <!-- <td>750</td> -->
            <td>Remote access: Ensure access keys unused for 90 days or greater are disabled</td>
            <td>AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. It is recommended that all access keys that have been unused in 90 or greater days be disabled.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq False should not have AccessKey with [ Active and LastUsedTime isEarlierThan ( -90, "days" ) ] </td>
          </tr>
          
          <tr num="751">
            <!-- <td>751</td> -->
            <td>Remote access: Ensure access keys are rotated every 90 days or less.</td>
            <td>Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. It is recommended that all access keys be regularly rotated.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should not have AccessKey with [ Active and LastRotatedTime isEarlierThan ( -90 , "days" ) ] </td>
          </tr>
          
          <tr num="752">
            <!-- <td>752</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires at least one uppercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one uppercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireUppercaseCharacters </td>
          </tr>
          
          <tr num="753">
            <!-- <td>753</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one lowercase letter.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one lowercase letter.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireLowercaseCharacters </td>
          </tr>
          
          <tr num="754">
            <!-- <td>754</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one symbol.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one symbol.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireSymbols </td>
          </tr>
          
          <tr num="755">
            <!-- <td>755</td> -->
            <td>Identities and credentials: Ensure IAM password policy require at least one number.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. It is recommended that the password policy require at least one number.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and RequireNumbers </td>
          </tr>
          
          <tr num="756">
            <!-- <td>756</td> -->
            <td>Identities and credentials: Ensure IAM password policy requires minimum length of 14 or greater.</td>
            <td>Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. It is recommended that the password policy require a minimum password length 14.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and MinimumPasswordLength >= 14 </td>
          </tr>
          
          <tr num="757">
            <!-- <td>757</td> -->
            <td>Identities and credentials: Ensure IAM password policy prevents password reuse</td>
            <td>IAM password policies can prevent the reuse of a given password by the same user. It is recommended that the password policy prevent the reuse of passwords.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and PasswordReusePrevention >= 24 </td>
          </tr>
          
          <tr num="758">
            <!-- <td>758</td> -->
            <td>Identities and credentials: Ensure IAM password policy expires passwords within 90 days or less.</td>
            <td>IAM password policies can require passwords to be rotated or expired after a given number of days. It is recommended that the password policy expire passwords after 90 days or less.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPasswordPolicy should have Configured and ExpirePasswords and MaxPasswordAge <= 90 </td>
          </tr>
          
          <tr num="759">
            <!-- <td>759</td> -->
            <td>Remote access: Ensure no root account access key exists.</td>
            <td>The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. It is recommended that all access keys associated with the root account be removed.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should not have AccessKey with [ Active eq True ] </td>
          </tr>
          
          <tr num="760">
            <!-- <td>760</td> -->
            <td>Authentication: Ensure MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a username and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true </td>
          </tr>
          
          <tr num="761">
            <!-- <td>761</td> -->
            <td>Authentication: Ensure hardware MFA is enabled for the "root" account.</td>
            <td>The root account is the most privileged user in an AWS account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. For Level 2, it is recommended that the root account be protected with a hardware MFA.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where RootUser eq True should have MFAActive eq true and MFADevices . Physical len ( ) gt 0 </td>
          </tr>
          
          <tr num="762">
            <!-- <td>762</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies are attached only to groups or roles.</td>
            <td>By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended that IAM policies be applied directly to groups and roles but not users.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser should have ( Policies . Managed len ( ) eq 0 and Policies . Inline len ( ) eq 0 ) </td>
          </tr>
          
          <tr num="763">
            <!-- <td>763</td> -->
            <td>Remote access: Do not setup access keys during initial user setup for all IAM users that have a console password</td>
            <td>AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. </td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMUser where Password . Enabled eq true should not have AccessKey with [ Active and CreatedByDefault ] </td>
          </tr>
          
          <tr num="764">
            <!-- <td>764</td> -->
            <td>Access permissions and authorizations: Ensure IAM policies that allow full "*:*" administrative privileges are not created.</td>
            <td>IAM policies are the means by which privileges are granted to users, groups, or roles. It is recommended and considered a standard security advice to grant least privilege — that is, granting only the permissions required to perform a task. Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy should not have Permissions . Statements with [ Action with [ value eq "*" ] and Resource with [ value eq "*" ] and Effect eq "Allow" ] and ( AttachedEntities . Groups len ( ) gt 0 or AttachedEntities . Roles len ( ) gt 0 or AttachedEntities . Users len ( ) gt 0 ) </td>
          </tr>
          
          <tr num="765">
            <!-- <td>765</td> -->
            <td>Audit/log records: Ensure CloudTrail is enabled.</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation)</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ MultiRegionTrailEnabled and LoggingEnabled eq True ] </td>
          </tr>
          
          <tr num="766">
            <!-- <td>766</td> -->
            <td>Secure audit trails so they cannot be altered : CloudTrail Log Files Lack Integrity Validation</td>
            <td>Use file-integrity monitoring or change-detection on CloudTrail logs to ensure that existing log data cannot be changed without generating alerts (although new data being added should not cause an alert).</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogFileValidationEnabled </td>
          </tr>
          
          <tr num="767">
            <!-- <td>767</td> -->
            <td>Audit/log records: Ensure the S3 bucket CloudTrail logs to is not publicly accessible</td>
            <td>CloudTrail logs a record of every API call made in your AWS account. These logs file are stored in an S3 bucket. It is recommended that the bucket policy or access control list (ACL) applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should not have S3Bucket . ACL with [ ( Permission eq "WRITE" or Permission eq "WRITE_ACP" or Permission eq "READ" or Permission eq "READ_ACP" or Permission eq "FULL_CONTROL" ) and Grantee. URI eq "http://acs.amazonaws.com/groups/global/AllUsers" ] or S3Bucket . BucketPolicy with [ Statement with [ Effect eq "Allow" and Principal with [ value eq "*" ] and Conditions len ( ) eq 0 ] ] </td>
          </tr>
          
          <tr num="768">
            <!-- <td>768</td> -->
            <td>Audit/log records: Ensure CloudTrail trails are integrated with CloudWatch Logs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls made in a given AWS account.The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail uses Amazon S3 for log file storage and delivery, so log files are stored durably. In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, realtime analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. It is recommended that CloudTrail logs be sent to CloudWatch Logs.</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have LogGroup . CreationDate gt 0 </td>
          </tr>
          
          <tr num="769">
            <!-- <td>769</td> -->
            <td>Audit/log records: Ensure AWS Config is enabled in all regions</td>
            <td>AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing. It is recommended to enable AWS Config be enabled in all regions.</td>
            <td>
            
              CloudTrail<br>
            
              Config<br>
            
            </td>
            <td class="code">AWS should have ( ConfigRecorders with [ Status and RecordingGroup . AllSupported ] ) and ConfigDeliveryChannels with [ StreamDelivery . LastSuccess and HistoryDelivery . LastSuccess ] </td>
          </tr>
          
          <tr num="770">
            <!-- <td>770</td> -->
            <td>Implement automated audit trails for all system components : CloudTrail - Lack of API Access Logging</td>
            <td>Implement automated audit trails for all system components to reconstruct the following events : All individual user accesses to cardholder data ; All actions taken by any individual with root or administrative privileges ; Access to all audit trails ; Invalid logical access attempts ; Use of and changes to identification and authentication mechanisms ; Initialization, stopping, or pausing of the audit logs ; Creation and deletion of system-level objects.</td>
            <td>
            
              S3<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have S3Bucket . LoggingEnabled </td>
          </tr>
          
          <tr num="771">
            <!-- <td>771</td> -->
            <td>Audit/log records: Ensure CloudTrail logs are encrypted at rest using KMS CMKs</td>
            <td>AWS CloudTrail is a web service that records AWS API calls for an account and makes those logs available to users and resources in accordance with IAM policies. AWS Key Management Service (KMS) is a managed service that helps create and control the encryption keys used to encrypt account data, and uses Hardware Security Modules (HSMs) to protect the security of encryption keys. CloudTrail logs can be configured to leverage server side encryption (SSE) and KMS customer created master keys (CMK) to further protect CloudTrail logs. It is recommended that CloudTrail be configured to use SSE-KMS</td>
            <td>
            
              CloudTrail<br>
            
            </td>
            <td class="code">CloudTrail should have KMSKey . Enabled </td>
          </tr>
          
          <tr num="772">
            <!-- <td>772</td> -->
            <td>Data-at-rest is protected: Ensure rotation for customer created CMKs is enabled</td>
            <td>AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). It is the backing key that is used to perform cryptographic operations such as encryption and decryption. Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled</td>
            <td>
            
              KMS<br>
            
            </td>
            <td class="code">KMSKey where Description notlike "Default master key that protects my.*" should have RotationEnabled </td>
          </tr>
          
          <tr num="773">
            <!-- <td>773</td> -->
            <td>Baseline network operations and data flows: Ensure VPC flow logging is enabled in all VPCs</td>
            <td>VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet 'Rejects' for VPCs.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">VPC should have atleast one FlowLogs with [ Status eq "ACTIVE" ] </td>
          </tr>
          
          <tr num="774">
            <!-- <td>774</td> -->
            <td>Remote access: Ensure a log metric filter and alarm exist for unauthorized API calls</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for unauthorized API calls.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.errorCode\s*=\s*\"\*UnauthorizedOperation\"\)\s*\|\|\s*\(\$\.errorCode\s*=\s*\"AccessDenied\*\"\)\s*\|\|\s*\(\$\.sourceIPAddress\s*!=\s*\"delivery\.logs\.amazonaws\.com\"\)\s*\|\|\s*\(\$\.eventName\s*!=\s*\"HeadBucket\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="775">
            <!-- <td>775</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for Management Console sign-in without MFA</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA)</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*\"ConsoleLogin\"\)\s*\&\&\s*\(\$\.additionalEventData\.MFAUsed\s*!=\s*\"Yes\"\)\s*\&\&\s*\(\$\.userIdentity\.type\s*=\s*\"IAMUser\"\)\s*\&\&\s*\(\$\.responseElements\.ConsoleLogin\s*=\s*\"Success\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="776">
            <!-- <td>776</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for usage of "root" account</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for root login attempts</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "{\s*\$\.userIdentity\.type\s*=\s*\"Root\"\s*\&\&\s*\$\.userIdentity\.invokedBy\s*NOT\s*EXISTS\s*\&\&\s*\$\.eventType\s*!=\s*\"AwsServiceEvent\"\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="777">
            <!-- <td>777</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for IAM policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*DeleteGroupPolicy\)\|\|\(\$\.eventName\s*=\s*DeleteRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreatePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeletePolicyVersion\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachRolePolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachUserPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachGroupPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachGroupPolicy\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="778">
            <!-- <td>778</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for CloudTrail configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*UpdateTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteTrail\)\s*\|\|\s*\(\$\.eventName\s*=\s*StartLogging\)\s*\|\|\s*\(\$\.eventName\s*=\s*StopLogging\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="779">
            <!-- <td>779</td> -->
            <td>Identities and credentials: Ensure a log metric filter and alarm exist for AWS Management Console authentication failures</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for failed console authentication attempts.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*ConsoleLogin\)\s*\&\&\s*\(\$\.errorMessage\s*=\s*\"Failed\s*authentication\"\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="780">
            <!-- <td>780</td> -->
            <td>Data-at-rest is protected: Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*kms\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=DisableKey\)\s*\|\|\s*\(\$\.eventName=ScheduleKeyDeletion\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="781">
            <!-- <td>781</td> -->
            <td>Ensure a log metric filter and alarm exist for S3 bucket policy changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for changes to S3 bucket policies.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*s3\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName\s*=\s*PutBucketAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*PutBucketReplication\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketPolicy\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketCors\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketLifecycle\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteBucketReplication\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="782">
            <!-- <td>782</td> -->
            <td>Audit/log records: Ensure a log metric filter and alarm exist for AWS Config configuration changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventSource\s*=\s*config\.amazonaws\.com\)\s*\&\&\s*\(\(\$\.eventName=StopConfigurationRecorder\)\s*\|\|\s*\(\$\.eventName=DeleteDeliveryChannel\)\s*\|\|\(\$\.eventName=PutDeliveryChannel\)\s*\|\|\s*\(\$\.eventName=PutConfigurationRecorder\)\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="783">
            <!-- <td>783</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. It is recommended that a metric filter and alarm be established for changes made to NACLs.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAcl\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclEntry\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceNetworkAclAssociation\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="784">
            <!-- <td>784</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for changes to network gateways</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. It is recommended that a metric filter and alarm be established for changes to network gateways.</td>
            <td>
            
              CloudWatch<br>
            
              CloudTrail<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteCustomerGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteInternetGateway\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachInternetGateway\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="785">
            <!-- <td>785</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for route table changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. It is recommended that a metric filter and alarm be established for changes to route tables.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*ReplaceRouteTableAssociation\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRouteTable\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteRoute\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisassociateRouteTable\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="786">
            <!-- <td>786</td> -->
            <td>Network integrity: Ensure a log metric filter and alarm exist for VPC changes</td>
            <td>Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs.</td>
            <td>
            
              CloudTrail<br>
            
              CloudWatch<br>
            
            </td>
            <td class="code">AWS should have atleast one CloudTrails with [ LogGroup . MetricFilters with [ FilterPattern like "\{\s*\(\$\.eventName\s*=\s*CreateVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*ModifyVpcAttribute\)\s*\|\|\s*\(\$\.eventName\s*=\s*AcceptVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*CreateVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*DeleteVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*RejectVpcPeeringConnection\)\s*\|\|\s*\(\$\.eventName\s*=\s*AttachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DetachClassicLinkVpc\)\s*\|\|\s*\(\$\.eventName\s*=\s*DisableVpcClassicLink\)\s*\|\|\s*\(\$\.eventName\s*=\s*EnableVpcClassicLink\)\s*\}" and Transformations with [ MetricAlarms with [ AlarmActions with [ SNSTopic . Subscriptions len () > 0 ] ] ] ] ] </td>
          </tr>
          
          <tr num="787">
            <!-- <td>787</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 22</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 22. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 22 and ToPort gte 22 ) and Protocol in ("-1", "tcp") ] </td>
          </tr>
          
          <tr num="788">
            <!-- <td>788</td> -->
            <td>Communications and control network protection: Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389</td>
            <td>Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. </td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup should not have InboundRules with [ IPRanges with [ IP eq 0.0.0.0/0 ] and ( FromPort lte 3389 and ToPort gte 3389 ) and Protocol in ("-1", "udp", "tcp") ] </td>
          </tr>
          
          <tr num="789">
            <!-- <td>789</td> -->
            <td>Ensure the default security group of every VPC restricts all traffic</td>
            <td>A VPC comes with a default security group whose initial settings deny all inbound traffic, allow all outbound traffic, and allow all traffic between instances assigned to the security group. If you don't specify a security group when you launch an instance, the instance is automatically assigned to this default security group. Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that the default security group restrict all traffic. The default VPC in every region should have it's default security group updated to comply. Any newly created VPCs will automatically contain a default security group that will need remediation to comply with this recommendation.</td>
            <td>
            
              EC2<br>
            
            </td>
            <td class="code">SecurityGroup where Name eq "default" should have InboundRules len ( ) eq 0 and OutboundRules len ( ) eq 0 </td>
          </tr>
          
          <tr num="790">
            <!-- <td>790</td> -->
            <td>Personnel know response roles/operations: Ensure a support role has been created to manage incidents with AWS Support</td>
            <td>AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. Create an IAM Role to allow authorized users to manage incidents with AWS Support.</td>
            <td>
            
              IAM<br>
            
            </td>
            <td class="code">IAMPolicy where id eq "arn:aws:iam::aws:policy/AWSSupportAccess" should have ( AttachedEntities . Groups len ( ) > 0 or AttachedEntities . Roles len ( ) > 0 or AttachedEntities . Users len ( ) > 0 ) </td>
          </tr>
          
        </table>
      
      &nbsp;
      <br><br>
      <br><br>
      <br><br>
      &nbsp;
    </div>
  </div>
  <script>

  // Sort
  const getCellValue = (tr, idx) => (idx === 0 ) ? tr.getAttribute("num") : ( tr.children[idx].innerText || tr.children[idx].textContent);
  const comparer = (idx, asc) => (a, b) => ((v1, v2) =>
      v1 !== '' && v2 !== '' && !isNaN(v1) && !isNaN(v2) ? v1 - v2 : v1.toString().localeCompare(v2)
      )(getCellValue(asc ? a : b, idx), getCellValue(asc ? b : a, idx));
  document.querySelectorAll('th').forEach(th => th.addEventListener('click', (() => {
      this.asc = !this.asc;
      const table = th.closest('table');
      Array.from(table.querySelectorAll('tr:nth-child(n+2)'))
          .sort(comparer(Array.from(th.parentNode.children).indexOf(th), this.asc))
          .forEach(tr => table.appendChild(tr) );
      $('th').removeClass('headerSortDown').removeClass('headerSortUp')
      if (this.asc) {
        $(th).addClass('headerSortUp')
      } else {
        $(th).addClass('headerSortDown')
      }
  })));

  // Search
  var $rows = $('table.rule_table tr[num]');
  $('#search').keyup(debounce(function() {

    var val = '^(?=.*\\b' + $.trim($(this).val()).split(/\s+/).join('\\b)(?=.*\\b') + ').*$',
      reg = RegExp(val, 'i'),
      text;

    $rows.show().filter(function() {
      text = $(this).text().replace(/\s+/g, ' ');
      return !reg.test(text);
    }).hide();
  }, 300));

  function debounce(func, wait, immediate) {
    var timeout;
    return function() {
      var context = this,
        args = arguments;
      var later = function() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  }

  // Nav Menu Show/Hide
  function hideRuleTables() {
    $('.rule_table').hide()
    $('.rule_key').removeClass('active')
  }

  function showRuleTable(name) {
    // c) show this table
    if (name === 'ALL') {
        $('.rule_table').show()
    } else {
        $('.rule_table[data-profile-name="'+name+'"]').show()
    }
  }

  function activateRule(profile_name) {
    // a) hide all the tables with the class 'rule_table'
    hideRuleTables()
    // b) find the table in '.rule_table' with the same 'profile-name' data attribute
    showRuleTable(profile_name)
    if (name === "ALL") {
        $('.rule_key').addClass('active')
    } else {
        $('.rule_key[data-profile-name="'+profile_name+'"]').addClass('active')
    }
  }

  function initListeners(){
    // 1. iterate over each Rule list item
    $('.rule_key').each(function(i, obj) {
      var ruleKey = $(obj)
      var ruleName = ruleKey.data('profile-name')
      console.log('adding click listener to ' + ruleName);
      // 2. add a click listener
      ruleKey.click(function(event){
        console.log('received click event for ' + ruleName)
        activateRule(ruleName)
      })
    })
  }
  (function(){
    hideRuleTables()
    var firstRule = $($('.rule_key')[0]).data('profile-name')
    console.log('activating first rule: ', firstRule)
    activateRule(firstRule)
    initListeners()
  })()
  </script>
</body>
</html>