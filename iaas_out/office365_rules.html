<html>
<head>
<meta charset="UTF-8">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<!--
<script src="jquery-3.3.1.min.js"></script>
<link rel="stylesheet" type="text/css" href="rules_styles.css">
-->
<style>
/* http://meyerweb.com/eric/tools/css/reset/
   v2.0 | 20110126
   License: none (public domain)
*/
html, body, div, span, applet, object, iframe,
h1, h2, h3, h4, h5, h6, p, blockquote, pre,
a, abbr, acronym, address, big, cite, code,
del, dfn, em, img, ins, kbd, q, s, samp,
small, strike, strong, sub, sup, tt, var,
b, u, i, center,
dl, dt, dd, ol, ul, li,
fieldset, form, label, legend,
table, caption, tbody, tfoot, thead, tr, th, td,
article, aside, canvas, details, embed,
figure, figcaption, footer, header, hgroup,
menu, nav, output, ruby, section, summary,
time, mark, audio, video {
	margin: 0;
	padding: 0;
	border: 0;
	font: inherit;
	vertical-align: baseline;
}
/* HTML5 display-role reset for older browsers */
article, aside, details, figcaption, figure,
footer, header, hgroup, menu, nav, section {
	display: block;
}
body {
	line-height: 1;
}
ol, ul {
	list-style: none;
}
blockquote, q {
	quotes: none;
}
blockquote:before, blockquote:after,
q:before, q:after {
	content: none;
}
table {
	border-collapse: collapse;
	border-spacing: 0;
}

/* Start Netskope styles */

h1 {font-size: 1.8em; font-family: Arial,sans-serif; margin: 1.2rem}
h2 {font-size: 1.6em; font-family: Arial,sans-serif; margin: 1.2rem}
body {font-family: Arial,sans-serif;}

table.rule_table {font-size: 90%}
td.code {font-family: monospace}
th {font-weight: bold; cursor: pointer; }
input { margin-left: 2px; margin-bottom: 5px; padding: 2px 3px; width: 300; }
.headerSortDown:after,
.headerSortUp:after{
    content: ' ';
    position: relative;
    left: 10px;
    border: 7px solid transparent;
}
.headerSortDown:after{
    top: 10px;
    border-top-color: silver;
}
.headerSortUp:after{
    bottom: 15px;
    border-bottom-color: silver;
}
.headerSortDown,
.headerSortUp{
    padding-left: 20px;
}

img[alt="Netskope"] {display:block; margin:1.2rem;}
.container {display: flex; flex-direction: row; padding: 1.5rem; position: fixed; top: 110;}
._TAB{ display: inline-block; width: 0.4rem; height: 0.1rem; border-top: 0.5rem solid transparent; border-bottom: 0.5rem solid transparent; border-left: 0.5rem solid rgba(125,125,125,0.40); margin-left: 1.4rem; margin-right: 0.1rem;}
.rule_keys {display:inline-block; margin:0.7rem; margin-top:0; padding-right:2.0rem}
.rule_keys>.rule_category:first-child{margin-top:0;}
.rule_keys ul {list-style: none;}
.rule_keys li {cursor: pointer;}
.rule_keys li:hover {background-color: rgba(255,131,0,0.39); }

img {position: fixed; top: 0}
h1 {position: fixed; top: 75}

.rule_tables {flex:3 1 0px;display:inline-block; height: calc(100vh - 110px - 1.5rem); overflow: scroll;}
.rule_tables table, .rule_tables th, .rule_tables td { border: 1px solid rgba(150,150,100,0.5);  }
.rule_tables table {table-layout: fixed; width:100%;}
.rule_tables th {background-color: rgba(180,180,180,0.2); padding:0.2rem;}
.rule_tables td {padding: 0.2rem;}

/* rule styles */
.rule_category, .rule_name {display:inline-block;float:none; padding-right:0.2rem;}
.rule_category {font-size:1.3em;width: 100%;background-color: rgba(180,180,180,0.2); margin:0.5rem 0 0.2rem 0;padding:0;}
.rule_category:before, .rule_category:after {display:inline-block; content:''; width:0.4rem;}
.rule_key {padding:0.3rem;padding-left: 1.5rem;}
.rule_key.active {background-color: #ff8300; color:#ffffff;}
.rule_name {width:100%; text-align: left;}
</style>

<title>Office 365 Predefined Rules</title>
</head>
<body>
  <img src="logo.png" alt="Netskope"/>
  <h1>Office 365 Predefined Rules</h1>
  <div class="container">
    <div class="rule_keys">
        <ul>
            
            <li class="rule_key" data-profile-name="AICPA-SOC-TSC-2017">
              <span class="rule_name">AICPA SOC TSC 2017 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="CIS-OFFICE_1.2.0">
              <span class="rule_name">CIS Microsoft 365 Foundations Benchmark v1.2.0</span>
            </li>
            
            <li class="rule_key" data-profile-name="CSA-CCM-4.0">
              <span class="rule_name">CSA-CCM v4.0 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="GDPR-2016-679">
              <span class="rule_name">GDPR 2016/679 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="HIPAA-1996">
              <span class="rule_name">HIPAA 1996 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="ISO-27002-2013">
              <span class="rule_name">ISO 27002 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST-800-53-4">
              <span class="rule_name">NIST 800-53 r4 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="NIST-CSF-1.1">
              <span class="rule_name">NIST-CSF v1.1 (Microsoft 365)</span>
            </li>
            
            <li class="rule_key" data-profile-name="PCI-DSS-3.0">
              <span class="rule_name">PCI-DSS v3.0 (Microsoft 365)</span>
            </li>
            
            <!--
            <li class="rule_key" data-profile-name="ALL">
              <span class="rule_name">All Rules</span>
            </li>
            -->
        </ul>
        <br><br>
        <!--
        -->
        &#x1F50D;<input type="text" id="search" placeholder="Type to search">
    </div>
    <div class="rule_tables">
      
        <table id="table" class="rule_table" data-profile-name="AICPA-SOC-TSC-2017">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="1">
            <!-- <td>1</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="2">
            <!-- <td>2</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="3">
            <!-- <td>3</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="4">
            <!-- <td>4</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="5">
            <!-- <td>5</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="6">
            <!-- <td>6</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="7">
            <!-- <td>7</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="8">
            <!-- <td>8</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="9">
            <!-- <td>9</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="10">
            <!-- <td>10</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="11">
            <!-- <td>11</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="12">
            <!-- <td>12</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="13">
            <!-- <td>13</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="14">
            <!-- <td>14</td> -->
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have DkimSigningConfig len() gt 0</td>
          </tr>
          
          <tr num="15">
            <!-- <td>15</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="16">
            <!-- <td>16</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="17">
            <!-- <td>17</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="18">
            <!-- <td>18</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="19">
            <!-- <td>19</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="20">
            <!-- <td>20</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="21">
            <!-- <td>21</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="22">
            <!-- <td>22</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="23">
            <!-- <td>23</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="24">
            <!-- <td>24</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="25">
            <!-- <td>25</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="26">
            <!-- <td>26</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="27">
            <!-- <td>27</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="28">
            <!-- <td>28</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="29">
            <!-- <td>29</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="30">
            <!-- <td>30</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="31">
            <!-- <td>31</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="32">
            <!-- <td>32</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="33">
            <!-- <td>33</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="34">
            <!-- <td>34</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="35">
            <!-- <td>35</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="36">
            <!-- <td>36</td> -->
            <td>Ensure mobile device management policies are required for email profiles</td>
            <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and managedEmailProfileRequired eq true ]</td>
          </tr>
          
          <tr num="37">
            <!-- <td>37</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="38">
            <!-- <td>38</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="39">
            <!-- <td>39</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="40">
            <!-- <td>40</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="41">
            <!-- <td>41</td> -->
            <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
            <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeSignInFailureCountBeforeWipe lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ]</td>
          </tr>
          
          <tr num="42">
            <!-- <td>42</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="43">
            <!-- <td>43</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="44">
            <!-- <td>44</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="45">
            <!-- <td>45</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="46">
            <!-- <td>46</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="47">
            <!-- <td>47</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="48">
            <!-- <td>48</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="49">
            <!-- <td>49</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="50">
            <!-- <td>50</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="51">
            <!-- <td>51</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="52">
            <!-- <td>52</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="53">
            <!-- <td>53</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="54">
            <!-- <td>54</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CIS-OFFICE_1.2.0">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="55">
            <!-- <td>55</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="56">
            <!-- <td>56</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="57">
            <!-- <td>57</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="58">
            <!-- <td>58</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="59">
            <!-- <td>59</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="60">
            <!-- <td>60</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="61">
            <!-- <td>61</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="62">
            <!-- <td>62</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="63">
            <!-- <td>63</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="64">
            <!-- <td>64</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="65">
            <!-- <td>65</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="66">
            <!-- <td>66</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="67">
            <!-- <td>67</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="68">
            <!-- <td>68</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="69">
            <!-- <td>69</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="70">
            <!-- <td>70</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="71">
            <!-- <td>71</td> -->
            <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
            <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">HostedOutboundSpamFilterPolicy should have NotifyOutboundSpam eq true and BccSuspiciousOutboundMail eq true and Enabled eq true </td>
          </tr>
          
          <tr num="72">
            <!-- <td>72</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="73">
            <!-- <td>73</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="74">
            <!-- <td>74</td> -->
            <td>Ensure that Facebook contact synchronization is disabled</td>
            <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have FacebookEnabled eq false </td>
          </tr>
          
          <tr num="75">
            <!-- <td>75</td> -->
            <td>Ensure that LinkedIn contact synchronization is disabled</td>
            <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have LinkedInEnabled eq false </td>
          </tr>
          
          <tr num="76">
            <!-- <td>76</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="77">
            <!-- <td>77</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="78">
            <!-- <td>78</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="79">
            <!-- <td>79</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="80">
            <!-- <td>80</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="81">
            <!-- <td>81</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="82">
            <!-- <td>82</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="83">
            <!-- <td>83</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="84">
            <!-- <td>84</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="85">
            <!-- <td>85</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="86">
            <!-- <td>86</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="87">
            <!-- <td>87</td> -->
            <td>Ensure mobile device management policies are required for email profiles</td>
            <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and managedEmailProfileRequired eq true ]</td>
          </tr>
          
          <tr num="88">
            <!-- <td>88</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="89">
            <!-- <td>89</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="90">
            <!-- <td>90</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="91">
            <!-- <td>91</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="92">
            <!-- <td>92</td> -->
            <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
            <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeSignInFailureCountBeforeWipe lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ]</td>
          </tr>
          
          <tr num="93">
            <!-- <td>93</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="94">
            <!-- <td>94</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="95">
            <!-- <td>95</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="96">
            <!-- <td>96</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="97">
            <!-- <td>97</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="98">
            <!-- <td>98</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="99">
            <!-- <td>99</td> -->
            <td>Ensure the Advanced Threat Protection Safe Attachments policy is enabled</td>
            <td>Enabling the Advanced Threat Protection Safe Attachments policy extends malware protections to include routing all messages and attachments without a known malware signature to a special hypervisor environment. In that environment, a behavior analysis is performed using a variety of machine learning and analysis techniques to detect malicious intent.</td>
            <td>
            
            </td>
            <td class="code">SafeAttachmentPolicy should have Enable eq true</td>
          </tr>
          
          <tr num="100">
            <!-- <td>100</td> -->
            <td>Ensure self-service password reset is enabled</td>
            <td>Ensure self-service password reset is enabled.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "SelfServicePasswordReset" and scoreInPercentage eq 100] </td>
          </tr>
          
          <tr num="101">
            <!-- <td>101</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="102">
            <!-- <td>102</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="103">
            <!-- <td>103</td> -->
            <td>Ensure that between two and four global admins are designated</td>
            <td>Ensure that between two and four global admins are designated.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have globalAdminUserCount >= 2 and globalAdminUserCount <= 4 </td>
          </tr>
          
          <tr num="104">
            <!-- <td>104</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="CSA-CCM-4.0">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="105">
            <!-- <td>105</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="106">
            <!-- <td>106</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="107">
            <!-- <td>107</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="108">
            <!-- <td>108</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="109">
            <!-- <td>109</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="110">
            <!-- <td>110</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="111">
            <!-- <td>111</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="112">
            <!-- <td>112</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="113">
            <!-- <td>113</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="114">
            <!-- <td>114</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="115">
            <!-- <td>115</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="116">
            <!-- <td>116</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="117">
            <!-- <td>117</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="118">
            <!-- <td>118</td> -->
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have DkimSigningConfig len() gt 0</td>
          </tr>
          
          <tr num="119">
            <!-- <td>119</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="120">
            <!-- <td>120</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="121">
            <!-- <td>121</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="122">
            <!-- <td>122</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="123">
            <!-- <td>123</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="124">
            <!-- <td>124</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="125">
            <!-- <td>125</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="126">
            <!-- <td>126</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="127">
            <!-- <td>127</td> -->
            <td>Ensure that Facebook contact synchronization is disabled</td>
            <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have FacebookEnabled eq false </td>
          </tr>
          
          <tr num="128">
            <!-- <td>128</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="129">
            <!-- <td>129</td> -->
            <td>Ensure that LinkedIn contact synchronization is disabled</td>
            <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have LinkedInEnabled eq false </td>
          </tr>
          
          <tr num="130">
            <!-- <td>130</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="131">
            <!-- <td>131</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="132">
            <!-- <td>132</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="133">
            <!-- <td>133</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="134">
            <!-- <td>134</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="135">
            <!-- <td>135</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="136">
            <!-- <td>136</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="137">
            <!-- <td>137</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="138">
            <!-- <td>138</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="139">
            <!-- <td>139</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="140">
            <!-- <td>140</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="141">
            <!-- <td>141</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="142">
            <!-- <td>142</td> -->
            <td>Ensure mobile device management policies are required for email profiles</td>
            <td>Configure your mobile device management policies to require the policy to manage the email profile of the user. If you do not require this, users will be able to setup and configure email accounts without the protections of the mobile device management policy, leading to potential breaches of accounts and data.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and managedEmailProfileRequired eq true ]</td>
          </tr>
          
          <tr num="143">
            <!-- <td>143</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="144">
            <!-- <td>144</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="145">
            <!-- <td>145</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="146">
            <!-- <td>146</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="147">
            <!-- <td>147</td> -->
            <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
            <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeSignInFailureCountBeforeWipe lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ]</td>
          </tr>
          
          <tr num="148">
            <!-- <td>148</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="149">
            <!-- <td>149</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="150">
            <!-- <td>150</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="151">
            <!-- <td>151</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="152">
            <!-- <td>152</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="153">
            <!-- <td>153</td> -->
            <td>Ensure an Outlook on the web mailbox policy exists</td>
            <td>Ensure an Outlook on the web mailbox policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have OwaMailboxPolicies len() gt 0</td>
          </tr>
          
          <tr num="154">
            <!-- <td>154</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="155">
            <!-- <td>155</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="156">
            <!-- <td>156</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="157">
            <!-- <td>157</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="158">
            <!-- <td>158</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="159">
            <!-- <td>159</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="160">
            <!-- <td>160</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="161">
            <!-- <td>161</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="GDPR-2016-679">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="162">
            <!-- <td>162</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="163">
            <!-- <td>163</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="164">
            <!-- <td>164</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="165">
            <!-- <td>165</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="166">
            <!-- <td>166</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="167">
            <!-- <td>167</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="168">
            <!-- <td>168</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="169">
            <!-- <td>169</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="170">
            <!-- <td>170</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="171">
            <!-- <td>171</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="172">
            <!-- <td>172</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="173">
            <!-- <td>173</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="174">
            <!-- <td>174</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="175">
            <!-- <td>175</td> -->
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have DkimSigningConfig len() gt 0</td>
          </tr>
          
          <tr num="176">
            <!-- <td>176</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="177">
            <!-- <td>177</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="178">
            <!-- <td>178</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="179">
            <!-- <td>179</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="180">
            <!-- <td>180</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="181">
            <!-- <td>181</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="182">
            <!-- <td>182</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="183">
            <!-- <td>183</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="184">
            <!-- <td>184</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="185">
            <!-- <td>185</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="186">
            <!-- <td>186</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="187">
            <!-- <td>187</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="188">
            <!-- <td>188</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="189">
            <!-- <td>189</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="190">
            <!-- <td>190</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="191">
            <!-- <td>191</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="192">
            <!-- <td>192</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="193">
            <!-- <td>193</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="194">
            <!-- <td>194</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="195">
            <!-- <td>195</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="196">
            <!-- <td>196</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="197">
            <!-- <td>197</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="198">
            <!-- <td>198</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="199">
            <!-- <td>199</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="200">
            <!-- <td>200</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="201">
            <!-- <td>201</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="202">
            <!-- <td>202</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="203">
            <!-- <td>203</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="204">
            <!-- <td>204</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="205">
            <!-- <td>205</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="206">
            <!-- <td>206</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="207">
            <!-- <td>207</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="208">
            <!-- <td>208</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="209">
            <!-- <td>209</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="210">
            <!-- <td>210</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="211">
            <!-- <td>211</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="212">
            <!-- <td>212</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="213">
            <!-- <td>213</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="HIPAA-1996">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="214">
            <!-- <td>214</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="215">
            <!-- <td>215</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="216">
            <!-- <td>216</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="217">
            <!-- <td>217</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="218">
            <!-- <td>218</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="219">
            <!-- <td>219</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="220">
            <!-- <td>220</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="221">
            <!-- <td>221</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="222">
            <!-- <td>222</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="223">
            <!-- <td>223</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="224">
            <!-- <td>224</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="225">
            <!-- <td>225</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="226">
            <!-- <td>226</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="227">
            <!-- <td>227</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="228">
            <!-- <td>228</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="229">
            <!-- <td>229</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="230">
            <!-- <td>230</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="231">
            <!-- <td>231</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="232">
            <!-- <td>232</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="233">
            <!-- <td>233</td> -->
            <td>Ensure that Facebook contact synchronization is disabled</td>
            <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have FacebookEnabled eq false </td>
          </tr>
          
          <tr num="234">
            <!-- <td>234</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="235">
            <!-- <td>235</td> -->
            <td>Ensure that LinkedIn contact synchronization is disabled</td>
            <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have LinkedInEnabled eq false </td>
          </tr>
          
          <tr num="236">
            <!-- <td>236</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="237">
            <!-- <td>237</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="238">
            <!-- <td>238</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="239">
            <!-- <td>239</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="240">
            <!-- <td>240</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="241">
            <!-- <td>241</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="242">
            <!-- <td>242</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="243">
            <!-- <td>243</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="244">
            <!-- <td>244</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="245">
            <!-- <td>245</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="246">
            <!-- <td>246</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="247">
            <!-- <td>247</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="248">
            <!-- <td>248</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="249">
            <!-- <td>249</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="250">
            <!-- <td>250</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="251">
            <!-- <td>251</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="252">
            <!-- <td>252</td> -->
            <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
            <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeSignInFailureCountBeforeWipe lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ]</td>
          </tr>
          
          <tr num="253">
            <!-- <td>253</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="254">
            <!-- <td>254</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="255">
            <!-- <td>255</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="256">
            <!-- <td>256</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="257">
            <!-- <td>257</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="258">
            <!-- <td>258</td> -->
            <td>Ensure an Outlook on the web mailbox policy exists</td>
            <td>Ensure an Outlook on the web mailbox policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have OwaMailboxPolicies len() gt 0</td>
          </tr>
          
          <tr num="259">
            <!-- <td>259</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="260">
            <!-- <td>260</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="261">
            <!-- <td>261</td> -->
            <td>Ensure self-service password reset is enabled</td>
            <td>Ensure self-service password reset is enabled.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "SelfServicePasswordReset" and scoreInPercentage eq 100] </td>
          </tr>
          
          <tr num="262">
            <!-- <td>262</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="263">
            <!-- <td>263</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="264">
            <!-- <td>264</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="265">
            <!-- <td>265</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="266">
            <!-- <td>266</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="ISO-27002-2013">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="267">
            <!-- <td>267</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="268">
            <!-- <td>268</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="269">
            <!-- <td>269</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="270">
            <!-- <td>270</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="271">
            <!-- <td>271</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="272">
            <!-- <td>272</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="273">
            <!-- <td>273</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="274">
            <!-- <td>274</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="275">
            <!-- <td>275</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="276">
            <!-- <td>276</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="277">
            <!-- <td>277</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="278">
            <!-- <td>278</td> -->
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have DkimSigningConfig len() gt 0</td>
          </tr>
          
          <tr num="279">
            <!-- <td>279</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="280">
            <!-- <td>280</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="281">
            <!-- <td>281</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="282">
            <!-- <td>282</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="283">
            <!-- <td>283</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="284">
            <!-- <td>284</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="285">
            <!-- <td>285</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="286">
            <!-- <td>286</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="287">
            <!-- <td>287</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="288">
            <!-- <td>288</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="289">
            <!-- <td>289</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="290">
            <!-- <td>290</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="291">
            <!-- <td>291</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="292">
            <!-- <td>292</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="293">
            <!-- <td>293</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="294">
            <!-- <td>294</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="295">
            <!-- <td>295</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="296">
            <!-- <td>296</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="297">
            <!-- <td>297</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="298">
            <!-- <td>298</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="299">
            <!-- <td>299</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="300">
            <!-- <td>300</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="301">
            <!-- <td>301</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="302">
            <!-- <td>302</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="303">
            <!-- <td>303</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="304">
            <!-- <td>304</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="305">
            <!-- <td>305</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="306">
            <!-- <td>306</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="307">
            <!-- <td>307</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="308">
            <!-- <td>308</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="309">
            <!-- <td>309</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="310">
            <!-- <td>310</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="311">
            <!-- <td>311</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="312">
            <!-- <td>312</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="313">
            <!-- <td>313</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST-800-53-4">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="314">
            <!-- <td>314</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="315">
            <!-- <td>315</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="316">
            <!-- <td>316</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="317">
            <!-- <td>317</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="318">
            <!-- <td>318</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="319">
            <!-- <td>319</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="320">
            <!-- <td>320</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="321">
            <!-- <td>321</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="322">
            <!-- <td>322</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="323">
            <!-- <td>323</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="324">
            <!-- <td>324</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="325">
            <!-- <td>325</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="326">
            <!-- <td>326</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="327">
            <!-- <td>327</td> -->
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have DkimSigningConfig len() gt 0</td>
          </tr>
          
          <tr num="328">
            <!-- <td>328</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="329">
            <!-- <td>329</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="330">
            <!-- <td>330</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="331">
            <!-- <td>331</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="332">
            <!-- <td>332</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="333">
            <!-- <td>333</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="334">
            <!-- <td>334</td> -->
            <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
            <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">HostedOutboundSpamFilterPolicy should have NotifyOutboundSpam eq true and BccSuspiciousOutboundMail eq true and Enabled eq true </td>
          </tr>
          
          <tr num="335">
            <!-- <td>335</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="336">
            <!-- <td>336</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="337">
            <!-- <td>337</td> -->
            <td>Ensure that Facebook contact synchronization is disabled</td>
            <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have FacebookEnabled eq false </td>
          </tr>
          
          <tr num="338">
            <!-- <td>338</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="339">
            <!-- <td>339</td> -->
            <td>Ensure that LinkedIn contact synchronization is disabled</td>
            <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have LinkedInEnabled eq false </td>
          </tr>
          
          <tr num="340">
            <!-- <td>340</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="341">
            <!-- <td>341</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="342">
            <!-- <td>342</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="343">
            <!-- <td>343</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="344">
            <!-- <td>344</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="345">
            <!-- <td>345</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="346">
            <!-- <td>346</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="347">
            <!-- <td>347</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="348">
            <!-- <td>348</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="349">
            <!-- <td>349</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="350">
            <!-- <td>350</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="351">
            <!-- <td>351</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="352">
            <!-- <td>352</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="353">
            <!-- <td>353</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="354">
            <!-- <td>354</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="355">
            <!-- <td>355</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="356">
            <!-- <td>356</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="357">
            <!-- <td>357</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="358">
            <!-- <td>358</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="359">
            <!-- <td>359</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="360">
            <!-- <td>360</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="361">
            <!-- <td>361</td> -->
            <td>Ensure an Outlook on the web mailbox policy exists</td>
            <td>Ensure an Outlook on the web mailbox policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have OwaMailboxPolicies len() gt 0</td>
          </tr>
          
          <tr num="362">
            <!-- <td>362</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="363">
            <!-- <td>363</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="364">
            <!-- <td>364</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="365">
            <!-- <td>365</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="366">
            <!-- <td>366</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="367">
            <!-- <td>367</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="368">
            <!-- <td>368</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="369">
            <!-- <td>369</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="NIST-CSF-1.1">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="370">
            <!-- <td>370</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="371">
            <!-- <td>371</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="372">
            <!-- <td>372</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="373">
            <!-- <td>373</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="374">
            <!-- <td>374</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="375">
            <!-- <td>375</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="376">
            <!-- <td>376</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="377">
            <!-- <td>377</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="378">
            <!-- <td>378</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="379">
            <!-- <td>379</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="380">
            <!-- <td>380</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="381">
            <!-- <td>381</td> -->
            <td>Ensure that client-side rules that automatically forward email to external domains are blocked</td>
            <td>Block client-side rules that automatically forward email to external domains. The use of client-side forwarding rules to exfiltrate data to external recipients is an increasingly used vector for data exfiltration by bad actors.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one TransportRules with [ State eq "Enabled" and Priority eq 0 and SentToScope eq "NotInOrganization" and FromScope eq "InOrganization" and MessageTypeMatches eq "AutoForward" and RejectMessageEnhancedStatusCode eq "5.7.1" ]</td>
          </tr>
          
          <tr num="382">
            <!-- <td>382</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="383">
            <!-- <td>383</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="384">
            <!-- <td>384</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="385">
            <!-- <td>385</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="386">
            <!-- <td>386</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="387">
            <!-- <td>387</td> -->
            <td>Ensure expiration time for external sharing links is set</td>
            <td>Restrict the length of time that anonymous access links are valid.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SharepointTenant should have requireAnonymousLinksExpireInDays > 0 </td>
          </tr>
          
          <tr num="388">
            <!-- <td>388</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="389">
            <!-- <td>389</td> -->
            <td>Ensure that Facebook contact synchronization is disabled</td>
            <td>Disable integration with Facebook as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have FacebookEnabled eq false </td>
          </tr>
          
          <tr num="390">
            <!-- <td>390</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="391">
            <!-- <td>391</td> -->
            <td>Ensure that LinkedIn contact synchronization is disabled</td>
            <td>Disable integration with LinkedIn as a measure to help prevent phishing scams.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have LinkedInEnabled eq false </td>
          </tr>
          
          <tr num="392">
            <!-- <td>392</td> -->
            <td>Ensure mail transport rules do not forward email to external domains</td>
            <td>Ensure mail transport rules do not forward email to external domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should not have AnyMailTransportRuleRedirectMessageToExternalDomain eq True </td>
          </tr>
          
          <tr num="393">
            <!-- <td>393</td> -->
            <td>Ensure mail transport rules do not whitelist specific domains</td>
            <td>Ensure mail transport rules do not whitelist specific domains.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">TransportRule should not have SetScl = -1 and SenderDomainIs len() > 0 </td>
          </tr>
          
          <tr num="394">
            <!-- <td>394</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="395">
            <!-- <td>395</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="396">
            <!-- <td>396</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="397">
            <!-- <td>397</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="398">
            <!-- <td>398</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="399">
            <!-- <td>399</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="400">
            <!-- <td>400</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="401">
            <!-- <td>401</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="402">
            <!-- <td>402</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="403">
            <!-- <td>403</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="404">
            <!-- <td>404</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="405">
            <!-- <td>405</td> -->
            <td>Ensure that mobile device passwords never expire</td>
            <td>Ensure that user passwords on mobile devices never expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passcodeExpirationDays eq -1 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordExpirationDays eq -1 ]</td>
          </tr>
          
          <tr num="406">
            <!-- <td>406</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="407">
            <!-- <td>407</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="408">
            <!-- <td>408</td> -->
            <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
            <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeSignInFailureCountBeforeWipe lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ]</td>
          </tr>
          
          <tr num="409">
            <!-- <td>409</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="410">
            <!-- <td>410</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="411">
            <!-- <td>411</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="412">
            <!-- <td>412</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="413">
            <!-- <td>413</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="414">
            <!-- <td>414</td> -->
            <td>Ensure an Outlook on the web mailbox policy exists</td>
            <td>Ensure an Outlook on the web mailbox policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have OwaMailboxPolicies len() gt 0</td>
          </tr>
          
          <tr num="415">
            <!-- <td>415</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="416">
            <!-- <td>416</td> -->
            <td>Ensure that Office 365 passwords are not set to expire</td>
            <td>Ensure that Office 365 passwords are not set to expire.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PWAgePolicyNew" and scoreInPercentage eq 100 and IsApplicable eq true ] </td>
          </tr>
          
          <tr num="417">
            <!-- <td>417</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="418">
            <!-- <td>418</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="419">
            <!-- <td>419</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="420">
            <!-- <td>420</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="421">
            <!-- <td>421</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
        <table id="table" class="rule_table" data-profile-name="PCI-DSS-3.0">
          <tr>
            <!-- <th width="2%"></th> -->
            <th width="19%" class="headerSortUp" asc="true">Name</th>
            <th width="30%">Description</th>
            <th width="10%">Service</th>
            <th width="39%">Rule</th>
          </tr>
          
          <tr num="422">
            <!-- <td>422</td> -->
            <td>All users should be registered and signed up for MFA</td>
            <td>Multi-factor authentication (MFA) helps protect devices and data that are accessible to these users. Adding more authentication methods, such as the Microsoft Authenticator app or a phone number, increases the level of protection if one factor is compromised.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "MFARegistrationV2" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="423">
            <!-- <td>423</td> -->
            <td>Ensure at least one anti-phishing policy exists</td>
            <td>Ensure that at least one anti-phishing policy exists.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have AntiPhishPolicies len() gt 0 </td>
          </tr>
          
          <tr num="424">
            <!-- <td>424</td> -->
            <td>Ensure an authentication policy exists</td>
            <td>Ensure an authentication policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have AuthenticationPolicies len() gt 0</td>
          </tr>
          
          <tr num="425">
            <!-- <td>425</td> -->
            <td>Ensure automatic forwarding options are disabled</td>
            <td>Disable automatic forwarding to prevent users from auto-forwarding mail through Outlook and Outlook on the Web. In the event that an attacker gains control of an end-user account they could create rules to exfiltrate data from your environment.</td>
            <td>
            
            </td>
            <td class="code">RemoteDomain should have AutoForwardEnabled eq false </td>
          </tr>
          
          <tr num="426">
            <!-- <td>426</td> -->
            <td>Ensure the Azure AD 'Risky sign-ins' report is reviewed at least weekly</td>
            <td>This report contains records of accounts that have had activity that could indicate they are compromised, such as accounts that have successfully signed in after multiple failures, which is an indication that the accounts have cracked passwords, account that have signed in to your tenancy from a client IP address that has been recognized by Microsoft as an anonymous proxy IP address (such as a TOR network), and successful sign-ins from users where two sign-ins appeared to originate from different regions and the time between sign-ins makes it impossible for the user to have traveled between those regions.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365Tenant should have unreviewedRiskEventsExist eq false </td>
          </tr>
          
          <tr num="427">
            <!-- <td>427</td> -->
            <td>Enable Azure AD Identity Protection sign-in risk policies</td>
            <td>Azure Active Directory Identity Protection sign-in risk detects risks in real-time and offline. A risky sign-in is an indicator for a sign-in attempt that might not have been performed by the legitimate owner of a user account.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "SigninRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="428">
            <!-- <td>428</td> -->
            <td>Enable Azure AD Identity Protection user risk policies</td>
            <td>Azure Active Directory Identity Protection user risk policies detect the probability that a user account has been compromised.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "UserRiskPolicy" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="429">
            <!-- <td>429</td> -->
            <td>Ensure basic authentication for Exchange Online is disabled</td>
            <td>Ensure basic authentication for Exchange Online is disabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AuthenticationPolicy should have AllowBasicAuthActiveSync eq false and AllowBasicAuthAutodiscover eq false and AllowBasicAuthImap eq false and AllowBasicAuthMapi eq false and AllowBasicAuthOfflineAddressBook eq false and AllowBasicAuthOutlookService eq false and AllowBasicAuthPop eq false and AllowBasicAuthPowershell eq false and AllowBasicAuthReportingWebServices eq false and AllowBasicAuthRest eq false and AllowBasicAuthRpc eq false and AllowBasicAuthSmtp eq false and AllowBasicAuthWebServices eq false</td>
          </tr>
          
          <tr num="430">
            <!-- <td>430</td> -->
            <td>Enable Conditional Access policies to block legacy authentication</td>
            <td>Enable Conditional Access policies to block legacy authentication.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have any ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.users.excludeUsers len() >= 1 and conditions.clientAppTypes has ("exchangeActiveSync") and conditions.clientAppTypes has ("other") and grantControls.builtInControls has ("block") and grantControls.builtInControls len() = 1 and state eq "enabled"] </td>
          </tr>
          
          <tr num="431">
            <!-- <td>431</td> -->
            <td>Block OneDrive for Business sync from unmanaged devices</td>
            <td>Prevent company data from OneDrive for Business from being synchronized to non-corporate managed devices. Unmanaged devices pose a risk, since their security cannot be verified. Allowing users to sync data to these devices, takes that data out of the control of the organization. This increases the risk of the data either being intentionally or accidentally leaked.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have isUnmanagedSyncClientForTenantRestricted eq true </td>
          </tr>
          
          <tr num="432">
            <!-- <td>432</td> -->
            <td>Ensure that sharing full calendar details with external users is disabled</td>
            <td>Do not allow your users to share the full details of their calendars with external users. Attackers often spend time learning about your organization before launching an attack. Publicly available calendars can help attackers understand organizational relationships and determine when specific users may be more vulnerable to an attack, such as when they are traveling.</td>
            <td>
            
            </td>
            <td class="code">SharingPolicy should have sharingEnabled eq false or every domains with [ sharingAllowedDetails eq "ContactsSharing" ] </td>
          </tr>
          
          <tr num="433">
            <!-- <td>433</td> -->
            <td>Ensure DKIM is enabled for all Exchange Online Domains</td>
            <td>DKIM lets you add a digital signature to outbound email messages in the message header. This signature is used to verify that the messages are really coming from you and not coming from someone spoofing your domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">DkimSigningConfig should have Enabled eq true </td>
          </tr>
          
          <tr num="434">
            <!-- <td>434</td> -->
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists</td>
            <td>Ensure a DomainKeys Identified Mail (DKIM) signing policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have DkimSigningConfig len() gt 0</td>
          </tr>
          
          <tr num="435">
            <!-- <td>435</td> -->
            <td>Ensure DMARC Records for all Exchange Online domains are published</td>
            <td>Domain-based Message Authentication, Reporting, and Conformance (DMARC) works with Sender Policy Framework (SPF) and DomainKeys Identified Mail (DKIM) to authenticate mail senders and ensure that destination email systems trust messages sent from your domain. When you use DMARC, the receiving server performs a check against the From address.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have DMARCRecordPublished eq true </td>
          </tr>
          
          <tr num="436">
            <!-- <td>436</td> -->
            <td>Do not allow users to grant consent to unmanaged applications</td>
            <td>Tighten the security of your services by regulating the access of third-party integrated apps. Only allow access to necessary apps that support robust security controls. Third-party applications are not created by Microsoft, so there is a possibility they could be used for malicious purposes like exfiltrating data from your tenancy. Attackers can maintain persistent access to your services through these integrated apps, without relying on compromised accounts.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "IntegratedApps" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="437">
            <!-- <td>437</td> -->
            <td>Ensure document sharing is controlled by domains with sharing restrictions configured</td>
            <td>Control sharing of documents to external domains by either blocking domains or only allowing sharing with specific named domains. Attackers will often attempt to expose sensitive information to external entities through sharing, and restricting the domains that your users can share documents with will reduce that surface area.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have sharingDomainRestrictionMode neq 0 </td>
          </tr>
          
          <tr num="438">
            <!-- <td>438</td> -->
            <td>Ensure audit log search is enabled</td>
            <td>Enabling Microsoft 365 audit log search helps Office 365 back office teams to investigate activities for regular security operational or forensic purposes.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AdminAuditLogConfig should have AdminAuditLogEnabled eq true and UnifiedAuditLogIngestionEnabled eq true </td>
          </tr>
          
          <tr num="439">
            <!-- <td>439</td> -->
            <td>Ensure the Common Attachment Types Filter is enabled</td>
            <td>Ensure the Common Attachment Types Filter is enabled.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableFileFilter eq true </td>
          </tr>
          
          <tr num="440">
            <!-- <td>440</td> -->
            <td>Ensure mailbox auditing for all users is enabled</td>
            <td>By turning on mailbox auditing, Microsoft 365 back office teams can track logons to a mailbox as well as what actions are taken while the user is logged on. After you turn on mailbox audit logging for a mailbox, you can search the audit log for mailbox activity. Additionally, when mailbox audit logging is turned on, some actions performed by administrators, delegates, and owners are logged by default.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">OrganizationConfig should have userMailboxAuditEnabled eq true and nonUserMailboxAuditEnabled eq true </td>
          </tr>
          
          <tr num="441">
            <!-- <td>441</td> -->
            <td>Ensure Exchange Online outbound spam filter policies are properly configured</td>
            <td>Ensure the Exchange Online outbound spam filter policy is properly configured. Set your Exchange Online Spam Policies to copy emails and notify someone when a sender in your tenant has been blocked for sending spam emails.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">HostedOutboundSpamFilterPolicy should have NotifyOutboundSpam eq true and BccSuspiciousOutboundMail eq true and Enabled eq true </td>
          </tr>
          
          <tr num="442">
            <!-- <td>442</td> -->
            <td>Ensure that external users cannot share files, folders, and sites they do not own</td>
            <td>SharePoint gives users the ability to share files, folder, and site collections. Internal users can share with external collaborators, who with the right permissions, could share those to another external party. Sharing and collaboration are key; however, file, folder, or site collection owners should have the authority over what external users get shared with to prevent unauthorized disclosures of information.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have preventExternalUsersFromResharing eq true </td>
          </tr>
          
          <tr num="443">
            <!-- <td>443</td> -->
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>Ensure a hosted outbound spam filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have HostedOutboundSpamFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="444">
            <!-- <td>444</td> -->
            <td>Ensure MailTips are enabled for end users</td>
            <td>MailTips assist end users with identifying strange patterns to emails they send. Setting up MailTips gives a visual aid to users when they send emails to large groups of recipients or send emails to recipients not within the tenant.</td>
            <td>
            
            </td>
            <td class="code">OrganizationConfig should have MailTipsAllTipsEnabled eq true and MailTipsExternalRecipientsTipsEnabled eq true and MailTipsGroupMetricsEnabled eq true and MailTipsLargeAudienceThreshold gt 0 </td>
          </tr>
          
          <tr num="445">
            <!-- <td>445</td> -->
            <td>Ensure a malware filter policy exists</td>
            <td>Ensure a malware filter policy exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have MalwareFilterPolicies len() gt 0</td>
          </tr>
          
          <tr num="446">
            <!-- <td>446</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in administrative roles</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeRoles has ("b0f54661-2d74-4c50-afa3-1ec803f12efe","b1be1c3e-b65d-4f19-8427-f6fa0d97feb9","29232cdf-9323-42fd-ade2-1d097af3e4de","62e90394-69f5-4237-9190-012177145e10","729827e3-9c14-49f7-bb1b-9608f156bbb8","194ae4cb-b126-40b2-bd5b-6091b380977d","f28a1f50-f6e7-4571-818b-6a12f2af6b6c","fe930be7-5e62-47db-91af-98c3a49a38b1") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="447">
            <!-- <td>447</td> -->
            <td>Ensure multi-factor authentication is enabled for all users in all roles</td>
            <td>Ensure multi-factor authentication is enabled for all users in all roles.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one ConditionalAccessPolicies with [ conditions.users.includeUsers has ("All") and conditions.clientAppTypes has ("all") and grantControls.builtInControls has ("mfa") and state eq "enabled"] </td>
          </tr>
          
          <tr num="448">
            <!-- <td>448</td> -->
            <td>Mobile devices passwords should be at least 6 characters</td>
            <td>Require your users to use a complex password with a minimum password length of at least six characters to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordMinimumLength eq 6 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinimumLength eq 6 and passcodeBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinimumLength eq 6 and passwordBlockSimple eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinimumLength eq 6 ] </td>
          </tr>
          
          <tr num="449">
            <!-- <td>449</td> -->
            <td>Ensure that mobile devices require complex passwords (Type = Alphanumeric)</td>
            <td>Require your users to use a complex password with a at least two character sets (letters and numbers, for example) to unlock their mobile devices</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric"] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordRequiredType eq "atLeastAlphanumeric" ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordRequiredType eq "alphanumeric" ]</td>
          </tr>
          
          <tr num="450">
            <!-- <td>450</td> -->
            <td>Ensure that mobile device encryption is enabled</td>
            <td>Require your users to use encryption on their mobile devices to prevent unauthorized access to mobile data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and storageRequireDeviceEncryption eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and storageRequireDeviceEncryption eq true]</td>
          </tr>
          
          <tr num="451">
            <!-- <td>451</td> -->
            <td>Ensure that users cannot connect from jailbroken or rooted devices</td>
            <td>Do not allow your users to use to connect with mobile devices that have been jailbroken or rooted. These devices have had basic protections disabled to run software that is often malicious and could very easily lead to an account or data breach.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.iosCompliancePolicy" and securityBlockJailbrokenDevices eq true ] and atleast one DeviceCompliancePolicies with [ odatatype eq "#microsoft.graph.androidCompliancePolicy" and securityBlockJailbrokenDevices eq true ] </td>
          </tr>
          
          <tr num="452">
            <!-- <td>452</td> -->
            <td>Lock mobile devices after a period of inactivity</td>
            <td>Users should be required to configure their mobile devices to lock after a period of inactivity to prevent unauthorized access.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordRequireWhenResumeFromIdleState eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeMinutesOfInactivityBeforeScreenTimeout eq 5 and passcodeMinutesOfInactivityBeforeLock eq 0 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordMinutesOfInactivityBeforeScreenTimeout eq 5 and passwordMinutesOfInactivityBeforeLock eq 0 ] </td>
          </tr>
          
          <tr num="453">
            <!-- <td>453</td> -->
            <td>Ensure device management polices are set to require advanced security configurations</td>
            <td>Configure your device management policies to require advanced security configurations. If you do not require this, users will be able to connect from devices that are vulnerable to basic internet attacks, leading to potential breaches of accounts and data.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have DeviceConfigurations len() gt 0</td>
          </tr>
          
          <tr num="454">
            <!-- <td>454</td> -->
            <td>Ensure that mobile devices require complex passwords (Simple Passwords = Blocked)</td>
            <td>Require your users to use a complex password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeBlockSimple eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordBlockSimple eq true]</td>
          </tr>
          
          <tr num="455">
            <!-- <td>455</td> -->
            <td>Ensure mobile devices require the use of a password</td>
            <td>Require your users to use a password to unlock their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeRequired eq true ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordRequired eq true] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordRequired eq true]</td>
          </tr>
          
          <tr num="456">
            <!-- <td>456</td> -->
            <td>Ensure that mobile device password reuse is prohibited</td>
            <td>Do not allow your users to reuse the same password on their mobile devices.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">O365 should have O365Tenant len() gt 0 and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordPreviousPasswordCountToBlock eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodePreviousPasscodeBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.macOSGeneralDeviceConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordPreviousPasswordBlockCount eq 5 ]</td>
          </tr>
          
          <tr num="457">
            <!-- <td>457</td> -->
            <td>Ensure mobile devices are set to wipe on multiple sign-in failures</td>
            <td>Require mobile devices to wipe on multiple sign-in failures to prevent brute force compromise. Devices without this protection are vulnerable to being accessed physically by attackers who can then steal account credentials, data, or install malware on the device.</td>
            <td>
            
            </td>
            <td class="code">O365 should have atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.iosGeneralDeviceConfiguration" and passcodeSignInFailureCountBeforeWipe lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidDeviceOwnerGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows10GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.windows81GeneralConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.androidWorkProfileGeneralDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ] and atleast one DeviceConfigurations with [ odatatype eq "#microsoft.graph.aospDeviceOwnerDeviceConfiguration" and passwordSignInFailureCountBeforeFactoryReset lte 10 ]</td>
          </tr>
          
          <tr num="458">
            <!-- <td>458</td> -->
            <td>Ensure modern authentication for Exchange Online is enabled</td>
            <td>Ensure modern authentication for Exchange Online is enabled.</td>
            <td>
            
              Exchange<br>
            
            </td>
            <td class="code">OrganizationConfig should have OAuth2ClientProfileEnabled eq true </td>
          </tr>
          
          <tr num="459">
            <!-- <td>459</td> -->
            <td>Notify the administrator when internal users send malware</td>
            <td>Set a malware filter policy that notifies an administrator when malware is detected in message from an internal user.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">MalwareFilterPolicy should have EnableInternalSenderAdminNotifications eq true </td>
          </tr>
          
          <tr num="460">
            <!-- <td>460</td> -->
            <td>Ensure that OAuth 2.0 permission grants to third-party apps do not give permission to modify app role assignments.</td>
            <td>OAuth 2.0 permission grants enable a third-party connected app to access data based on the permissions granted.  Do not grant third-party apps the ability to modify app role assignments.  This would enable the third-party app to give users or apps access to resources that they should not have access to.</td>
            <td>
            
            </td>
            <td class="code">OAuth2PermissionGrant should not have scope like "AppRoleAssignment.ReadWrite.All"</td>
          </tr>
          
          <tr num="461">
            <!-- <td>461</td> -->
            <td>Ensure that Office 365 SharePoint infected files cannot be downloaded</td>
            <td>Office 365 Advanced Threat Protection (ATP) for SharePoint, OneDrive, and Microsoft Teams protects your organization from inadvertently sharing malicious files. When an infected file is detected, that file is blocked so that no one can open, copy, move, or share it until further actions are taken by the organization's security team.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have disallowInfectedFileDownload eq true </td>
          </tr>
          
          <tr num="462">
            <!-- <td>462</td> -->
            <td>Ensure external storage providers available in Outlook on the Web are restricted</td>
            <td>Restrict storage providers that are integrated with Outlook on the Web. By default additional storage providers are allowed in Outlook on the Web (such as Box,
Dropbox, Facebook, Google Drive, OneDrive Personal, etc.). This could lead to information leakage and additional risk of infection from organizational non-trusted storage providers. Restricting this will inherently reduce risk as it will narrow opportunities for infection and data leakage.</td>
            <td>
            
            </td>
            <td class="code">OwaMailboxPolicy should have AdditionalStorageProvidersAvailable eq false </td>
          </tr>
          
          <tr num="463">
            <!-- <td>463</td> -->
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection</td>
            <td>Ensure that password hash sync is enabled for resiliency and leaked credential detection.</td>
            <td>
            
              Microsoft 365 security<br>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [ controlName eq "PasswordHashSync" and on eq true ] </td>
          </tr>
          
          <tr num="464">
            <!-- <td>464</td> -->
            <td>Ensure modern authentication for SharePoint applications is required</td>
            <td>Strong authentication controls, such as the use of multi-factor authentication, may be circumvented if basic authentication is used by SharePoint applications. Requiring modern authentication for SharePoint applications ensures strong authentication mechanisms are used when establishing sessions between these applications, SharePoint, and connecting users.</td>
            <td>
            
            </td>
            <td class="code">SharepointTenant should have legacyAuthProtocolsEnabled eq false </td>
          </tr>
          
          <tr num="465">
            <!-- <td>465</td> -->
            <td>Ensure SPF records are published for all Exchange domains</td>
            <td>Ensure that Sender Policy Framework (SPF) records are published for all Exchange domains. Using SPF helps to validate outbound email sent from your custom domain by determining whether or not a sender is permitted to send on behalf of a domain.</td>
            <td>
            
              Azure Active Directory<br>
            
            </td>
            <td class="code">AcceptedDomain should have spfRecordPublished eq true </td>
          </tr>
          
          <tr num="466">
            <!-- <td>466</td> -->
            <td>Ensure a transport rule exists</td>
            <td>Ensure a transport rule exists.</td>
            <td>
            
            </td>
            <td class="code">O365 should have TransportRules len() gt 0</td>
          </tr>
          
          <tr num="467">
            <!-- <td>467</td> -->
            <td>Use limited administrative roles</td>
            <td>Limited administrators are users who have more privileges than standard users, but not as many privileges as global admins. Leveraging limited administrator roles to perform required administrative work reduces the number of high value, high impact global admin role holders you have. Assigning users roles like Password Administrator or Exchange Online Administrator, instead of Global Administrator, reduces the likelihood of a global administrative privileged account being breached.</td>
            <td>
            
            </td>
            <td class="code">SecureScore should have atleast one controlScores with [controlName eq "RoleOverlap" and scoreInPercentage eq 100 ] </td>
          </tr>
          
          <tr num="468">
            <!-- <td>468</td> -->
            <td>Ensure that users do not have the default strong password policy disabled.</td>
            <td>In Azure, users by default have a strong password policy enabled.  However, admin users are able to disable the default strong password policy for individual users. This functionality should not be used and all individual users' password policies should require a strong password.</td>
            <td>
            
            </td>
            <td class="code">User should not have passwordPolicies like "DisableStrongPassword"</td>
          </tr>
          
          <tr num="469">
            <!-- <td>469</td> -->
            <td>Ensure that users cannot install Outlook add-ins</td>
            <td>Attackers commonly use vulnerable and custom-built add-ins to access data in user applications. While allowing users to install add-ins by themselves does allow them to easily acquire useful add-ins that integrate with Microsoft applications, it can represent a risk if not used and monitored carefully. Disabling future users' ability to install add-ins in Microsoft Outlook helps reduce your threat-surface and mitigate this risk.</td>
            <td>
            
            </td>
            <td class="code">O365 should not have any RoleAssignmentPolicies with [ AssignedRoles has ( "My Custom Apps" ) or AssignedRoles has ( "My Marketplace Apps" ) or AssignedRoles has ( "My ReadWriteMailbox Apps" ) ]</td>
          </tr>
          
        </table>
      
      &nbsp;
      <br><br>
      <br><br>
      <br><br>
      &nbsp;
    </div>
  </div>
  <script>

  // Sort
  const getCellValue = (tr, idx) => (idx === 0 ) ? tr.getAttribute("num") : ( tr.children[idx].innerText || tr.children[idx].textContent);
  const comparer = (idx, asc) => (a, b) => ((v1, v2) =>
      v1 !== '' && v2 !== '' && !isNaN(v1) && !isNaN(v2) ? v1 - v2 : v1.toString().localeCompare(v2)
      )(getCellValue(asc ? a : b, idx), getCellValue(asc ? b : a, idx));
  document.querySelectorAll('th').forEach(th => th.addEventListener('click', (() => {
      this.asc = !this.asc;
      const table = th.closest('table');
      Array.from(table.querySelectorAll('tr:nth-child(n+2)'))
          .sort(comparer(Array.from(th.parentNode.children).indexOf(th), this.asc))
          .forEach(tr => table.appendChild(tr) );
      $('th').removeClass('headerSortDown').removeClass('headerSortUp')
      if (this.asc) {
        $(th).addClass('headerSortUp')
      } else {
        $(th).addClass('headerSortDown')
      }
  })));

  // Search
  var $rows = $('table.rule_table tr[num]');
  $('#search').keyup(debounce(function() {

    var val = '^(?=.*\\b' + $.trim($(this).val()).split(/\s+/).join('\\b)(?=.*\\b') + ').*$',
      reg = RegExp(val, 'i'),
      text;

    $rows.show().filter(function() {
      text = $(this).text().replace(/\s+/g, ' ');
      return !reg.test(text);
    }).hide();
  }, 300));

  function debounce(func, wait, immediate) {
    var timeout;
    return function() {
      var context = this,
        args = arguments;
      var later = function() {
        timeout = null;
        if (!immediate) func.apply(context, args);
      };
      var callNow = immediate && !timeout;
      clearTimeout(timeout);
      timeout = setTimeout(later, wait);
      if (callNow) func.apply(context, args);
    };
  }

  // Nav Menu Show/Hide
  function hideRuleTables() {
    $('.rule_table').hide()
    $('.rule_key').removeClass('active')
  }

  function showRuleTable(name) {
    // c) show this table
    if (name === 'ALL') {
        $('.rule_table').show()
    } else {
        $('.rule_table[data-profile-name="'+name+'"]').show()
    }
  }

  function activateRule(profile_name) {
    // a) hide all the tables with the class 'rule_table'
    hideRuleTables()
    // b) find the table in '.rule_table' with the same 'profile-name' data attribute
    showRuleTable(profile_name)
    if (name === "ALL") {
        $('.rule_key').addClass('active')
    } else {
        $('.rule_key[data-profile-name="'+profile_name+'"]').addClass('active')
    }
  }

  function initListeners(){
    // 1. iterate over each Rule list item
    $('.rule_key').each(function(i, obj) {
      var ruleKey = $(obj)
      var ruleName = ruleKey.data('profile-name')
      console.log('adding click listener to ' + ruleName);
      // 2. add a click listener
      ruleKey.click(function(event){
        console.log('received click event for ' + ruleName)
        activateRule(ruleName)
      })
    })
  }
  (function(){
    hideRuleTables()
    var firstRule = $($('.rule_key')[0]).data('profile-name')
    console.log('activating first rule: ', firstRule)
    activateRule(firstRule)
    initListeners()
  })()
  </script>
</body>
</html>